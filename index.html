<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GTİ-Muratbey-Ahmet Dölen</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: Arial, sans-serif;
        }
        html, body {
            height: 100%;
        }
        body {
            background-color: #f5f5f5;
            color: #333;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }
        .header {
            background-color: #1e2738;
            padding: 15px 50px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 2px 10px rgba(0,0,0,0.2);
            position: relative;
            z-index: 100;
        }
        .logo-container {
            display: flex;
            align-items: center;
        }
        .logo {
            height: 60px;
            width: auto;
            object-fit: contain;
            max-height: 100%;
            max-width: 200px;
            display: block;
        }
        .logo-text {
            color: white;
            margin-left: 15px;
            font-size: 16px;
            line-height: 1.3;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }
        .logo-text h1 {
            font-family: 'Poppins', sans-serif;
            font-weight: 600;
            font-size: 16px;
            letter-spacing: 0.5px;
            color: #ffffff;
            margin: 0;
            line-height: 1.2;
            text-transform: uppercase;
        }
        .nav-menu {
            display: flex;
            margin-left: auto;
        }
        .nav-item {
            color: white;
            padding: 10px 15px;
            font-size: 15px;
            cursor: pointer;
            text-decoration: none;
            transition: color 0.3s;
        }
        .nav-item:hover {
            color: #d42f2f;
        }
        .login-button {
            background-color: #d42f2f;
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            transition: background-color 0.3s;
        }
        .login-button:hover {
            background-color: #b91c1c;
        }
        .hero {
            height: calc(100vh - 75px);
            background-image: url('background.jpg');
            background-size: cover;
            background-position: center;
            position: relative;
            display: flex;
            align-items: center;
            color: white;
        }
        .hero-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(30, 39, 56, 0.6);
        }
        .hero-content {
            position: relative;
            z-index: 10;
            max-width: 600px;
            margin-left: 100px;
            padding: 30px;
            background-color: rgba(212, 47, 47, 0.85);
            border-radius: 5px;
        }
        .hero-content h1 {
            font-size: 36px;
            margin-bottom: 20px;
        }
        .hero-content p {
            font-size: 18px;
            margin-bottom: 25px;
            line-height: 1.6;
        }
        .hero-button {
            display: inline-block;
            background-color: white;
            color: #d42f2f;
            padding: 12px 24px;
            border: none;
            border-radius: 4px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: background-color 0.3s;
            text-decoration: none;
        }
        .hero-button:hover {
            background-color: #f0f0f0;
        }
        .login-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }
        .login-form {
            background-color: white;
            padding: 30px;
            border-radius: 5px;
            width: 400px;
            box-shadow: 0 0 20px rgba(0,0,0,0.2);
        }
        .login-header {
            display: flex;
            align-items: center;
            margin-bottom: 20px;
        }
        .login-header img {
            height: 40px;
            margin-right: 15px;
        }
        .login-header h2 {
            color: #1e2738;
            font-size: 22px;
        }
        .form-group {
            margin-bottom: 20px;
        }
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
            color: #333;
        }
        input[type="text"],
        input[type="password"],
        input[type="number"] {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 16px;
            transition: border 0.3s;
        }
        input:focus {
            border-color: #d42f2f;
            outline: none;
        }
        input[readonly] {
            background-color: #f5f5f5;
            color: #666;
        }
        .form-actions {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .error-message {
            color: #d42f2f;
            margin-top: 5px;
            font-size: 14px;
        }
        .close-button {
            background: none;
            border: none;
            color: #666;
            font-size: 14px;
            cursor: pointer;
            text-decoration: underline;
        }
        /* Uygulama Ekranı Stilleri */
        #appScreen {
            display: none;
        }
        .content {
            max-width: 1200px;
            margin: 30px auto;
            padding: 0 20px;
        }
        .main-container {
            display: flex;
            background-color: white;
            box-shadow: 0 0 20px rgba(0,0,0,0.1);
            border-radius: 5px;
            overflow: hidden;
        }
        .sidebar {
            width: 300px;
            background-color: #f2f2f2;
            padding: 20px;
            max-height: 700px;
            overflow-y: auto;
        }
        .sidebar h3 {
            color: #333;
            margin-bottom: 15px;
            font-size: 18px;
            border-bottom: 2px solid #d42f2f;
            padding-bottom: 10px;
        }
        .office-item {
            padding: 10px 15px;
            margin-bottom: 5px;
            background-color: #e9e9e9;
            border-radius: 4px;
            cursor: pointer;
            transition: all 0.2s;
            font-size: 14px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        .office-item:hover {
            background-color: #d9d9d9;
        }
        .office-item.active {
            background-color: #d42f2f;
            color: white;
        }
        .main-content {
            flex-grow: 1;
            padding: 25px;
        }
        .page-title {
            margin-bottom: 25px;
            color: #1e2738;
            font-size: 24px;
            border-bottom: 1px solid #eee;
            padding-bottom: 15px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .date-display {
            font-size: 14px;
            color: #666;
            font-weight: normal;
        }
        .notification {
            padding: 12px;
            background-color: #eaf7ea;
            color: #2e7d32;
            border-radius: 4px;
            margin-bottom: 20px;
            display: none;
            border-left: 4px solid #2e7d32;
        }
        .history {
            margin-top: 40px;
        }
        .history h3 {
            margin-bottom: 15px;
            font-size: 18px;
            color: #1e2738;
            padding-bottom: 10px;
            border-bottom: 2px solid #d42f2f;
        }
        table {
            width: 100%;
            border-collapse: collapse;
        }
        th, td {
            padding: 12px 15px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }
        th {
            background-color: #f2f2f2;
            color: #333;
            font-weight: bold;
        }
        tr:hover {
            background-color: #f9f9f9;
        }
        .user-info {
            display: flex;
            justify-content: flex-end;
            margin-bottom: 20px;
            align-items: center;
        }
        .user-name {
            margin-right: 15px;
            color: #666;
        }
        .logout-button {
            background-color: transparent;
            color: #666;
            border: 1px solid #ddd;
            padding: 8px 15px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
        }
        .logout-button:hover {
            background-color: #f2f2f2;
        }
        .footer {
            background-color: #1e2738;
            color: rgba(255,255,255,0.7);
            padding: 20px 0;
            text-align: center;
            font-size: 14px;
            margin-top: 40px;
        }
        /* Mobil uyumluluk */
        @media (max-width: 768px) {
            .header {
                padding: 15px 20px;
                flex-wrap: wrap;
            }
            .nav-menu {
                margin-left: 0;
                margin-top: 15px;
                flex-wrap: wrap;
                order: 3;
                width: 100%;
            }
            .hero-content {
                margin-left: 20px;
                margin-right: 20px;
                padding: 20px;
            }
            .main-container {
                flex-direction: column;
            }
            .sidebar {
                width: 100%;
            }
        }
        /* Sayaç düzenleme modalı stileri */
        #editMeterModal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }
        .search-box {
            width: 100%;
            padding: 10px 15px;
            margin-bottom: 15px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 14px;
        }
        .form-input {
            width: 100%;
            padding: 10px 15px;
            margin-bottom: 15px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 14px;
        }
        
        /* Hakkımızda Sayfa Stili */
        .hero-container {
            width: 100%;
            height: calc(100vh - 90px);
            flex: 1 0 auto;
        }
        .about-content-inline {
            background-color: rgba(255, 255, 255, 0.95);
            border-radius: 5px;
            width: 80%;
            max-width: 800px;
            margin: 0 auto;
            padding: 30px;
            position: relative;
            z-index: 10;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            color: #333;
            max-height: 80vh;
            overflow-y: auto;
        }
        .about-header-inline {
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid #d42f2f;
            position: relative;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .about-header-inline h1 {
            color: #1e2738;
            font-size: 24px;
            margin: 0;
        }
        .about-text-inline p {
            margin-bottom: 15px;
            line-height: 1.6;
            color: #333;
            text-align: justify;
        }
        .back-button {
            background-color: #1e2738;
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            transition: background-color 0.3s;
        }
        .back-button:hover {
            background-color: #15192a;
        }
        
        /* İletişim Sayfası Stilleri */
        .contact-container {
            display: flex;
            flex-wrap: wrap;
            gap: 30px;
            margin-top: 20px;
        }
        .action-buttons {
            display: flex;
            gap: 10px;
            margin-top: 15px;
        }
        .contact-info {
            flex: 1;
            min-width: 300px;
        }
        .map-container {
            flex: 1;
            min-width: 300px;
        }
        .contact-item {
            margin-bottom: 25px;
            display: flex;
            align-items: flex-start;
        }
        .contact-icon {
            background-color: #1e2738;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 15px;
            color: white;
            flex-shrink: 0;
        }
        .contact-details h3 {
            color: #1e2738;
            margin: 0 0 8px 0;
            font-size: 18px;
        }
        .contact-details p {
            margin: 0 0 5px 0;
            color: #555;
        }
        .contact-details a {
            color: #d42f2f;
            text-decoration: none;
        }
        .contact-details a:hover {
            text-decoration: underline;
        }
        .map-container h3 {
            color: #1e2738;
            margin-bottom: 15px;
            font-size: 18px;
        }
        .map-embed {
            border-radius: 5px;
            overflow: hidden;
            margin-bottom: 15px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        .map-link {
            display: inline-block;
            background-color: #1e2738;
            color: white;
            padding: 8px 15px;
            border-radius: 4px;
            text-decoration: none;
            transition: background-color 0.3s;
        }
        .map-link:hover {
            background-color: #15192a;
        }
        .location-icon::before { content: "\1F4CD"; }
        .phone-icon::before { content: "\260E"; }
        .email-icon::before { content: "\2709"; }
        .arrow-icon::before { content: "\2192"; }
        
        /* Footer Stili */
        .site-footer {
            background-color: #1e2738;
            color: rgba(255, 255, 255, 0.7);
            padding: 15px 50px;
            position: relative;
            width: 100%;
            flex-shrink: 0;
        }
        .footer-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            max-width: 1200px;
            margin: 0 auto;
        }
        .copyright {
            font-size: 14px;
        }
        .developer {
            font-size: 14px;
            font-style: italic;
        }
        @media (max-width: 768px) {
            .site-footer {
                padding: 15px 20px;
            }
            .footer-content {
                flex-direction: column;
                text-align: center;
            }
            .copyright {
                margin-bottom: 5px;
            }
        }
        
        /* Hakkımızda Modal Stili */
        .about-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }
        .about-content {
            background-color: white;
            border-radius: 5px;
            width: 80%;
            max-width: 800px;
            max-height: 90vh;
            overflow-y: auto;
            padding: 30px;
            position: relative;
        }
        .about-header {
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid #d42f2f;
            position: relative;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .about-header h2 {
            color: #1e2738;
            font-size: 22px;
            margin: 0;
        }
        .about-stats {
            display: flex;
            justify-content: space-between;
            flex-wrap: wrap;
            margin-bottom: 30px;
        }
        .stat-box {
            background-color: #f5f5f5;
            border-radius: 5px;
            padding: 20px;
            text-align: center;
            width: 22%;
            margin-bottom: 15px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        .stat-number {
            font-size: 24px;
            font-weight: bold;
            color: #d42f2f;
            margin-bottom: 10px;
        }
        .stat-label {
            font-size: 14px;
            color: #666;
        }
        .about-text p {
            margin-bottom: 15px;
            line-height: 1.6;
            color: #333;
            text-align: justify;
        }
        .close-about {
            background: none;
            border: none;
            font-size: 24px;
            cursor: pointer;
            color: #666;
            position: absolute;
            top: 10px;
            right: 10px;
        }
        
        /* Ofis durum tablosu stilleri */
        .status-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 15px;
        }
        .status-table th, .status-table td {
            padding: 12px 15px;
            border-bottom: 1px solid #ddd;
            text-align: left;
        }
        .status-table th {
            background-color: #f8f8f8;
            font-weight: 600;
            color: #333;
        }
        .status-success {
            background-color: rgba(76, 175, 80, 0.1);
        }
        .status-error {
            background-color: rgba(244, 67, 54, 0.1);
        }
        .status-indicator {
            display: inline-block;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            margin-right: 8px;
            vertical-align: middle;
        }
        .status-indicator.success {
            background-color: #4CAF50;
        }
        .status-indicator.error {
            background-color: #F44336;
        }
    </style>
</head>
<body>
    <!-- Ana Sayfa -->
    <div id="homePage">
        <!-- Üst Menü -->
        <header class="header">
            <div class="logo-container">
                <img src="gti-logo.svg" alt="GTİ Logo" class="logo">
                <div class="logo-text">
                    <h1>Ofis Sayaç-Depo Envanter Takip Sistemi</h1>
                </div>
            </div>
            <nav class="nav-menu">
                <a href="#" class="nav-item" id="homeLink">Ana Sayfa</a>
                <a href="#" class="nav-item" id="aboutLink">Hakkımızda</a>
                <a href="#" class="nav-item" id="contactLink">İletişim</a>
            </nav>
        </header>

        <!-- Ana İçerik Alanı -->
        <div class="hero-container">
            <!-- Hero Bölümü -->
            <div id="heroSection" class="hero">
                <div class="hero-overlay"></div>
                <div class="hero-content">
                    <h1>Ofis Sayaç-Depo Envanter Takip Sistemi</h1>
                    <p>GTİ'nin geliştirdiği bu platform, ofislerdeki elektrik, su ve doğalgaz sayaçlarının yanı sıra depo envanterlerinin de takibini kolaylaştırır. Tüm verilerinizi doğru ve güvenilir bir şekilde kayıt altına almanızı sağlayan entegre bir yönetim sistemidir.</p>
                    <button id="heroLoginBtn" class="hero-button">Sisteme Giriş Yap</button>
                </div>
            </div>
            
            <!-- Hakkımızda Bölümü -->
            <div id="aboutSection" class="hero" style="display: none;">
                <div class="hero-overlay"></div>
                <div class="about-content-inline">
                    <div class="about-header-inline">
                        <h1>Muratbey Gümrük Müdürlüğü Hakkında</h1>
                        <button id="backToHomeBtn" class="back-button">Ana Sayfa'ya Dön</button>
                    </div>
                    <div class="about-stats">
                        <div class="stat-box">
                            <div class="stat-number">220.000 m²</div>
                            <div class="stat-label">Toplam Alan</div>
                        </div>
                        <div class="stat-box">
                            <div class="stat-number">56.472 m²</div>
                            <div class="stat-label">Kapalı Alan</div>
                        </div>
                        <div class="stat-box">
                            <div class="stat-number">0</div>
                            <div class="stat-label">Yolcu Kapasitesi</div>
                        </div>
                        <div class="stat-box">
                            <div class="stat-number">0</div>
                            <div class="stat-label">Taşıt Kapasitesi</div>
                        </div>
                    </div>
                    <div class="about-text-inline">
                        <p>Türkiye'nin dış ticaretinde önemli bir yere sahip olan, şehir içinde kaldığı için trafik akışını olumsuz etkileyen, fiziki koşullarının yetersizliği nedeniyle ihtiyaca cevap veremeyen, eski adıyla Halkalı Gümrük Müdürlüğü modernize edilerek İstanbul'un Çatalca bölgesine taşınmış ve Muratbey Gümrük Müdürlüğü olarak hizmete sunulmuştur.</p>
                        <p>Şehir trafiğine girmeden kolaylıkla erişilebilen Muratbey Gümrük Müdürlüğü, yeni yapılanmasıyla birlikte 220.000 m2 alan üzerine kurulmuş olup, 35.000 m² depo alanı, 4.150 m² ofis alanı ve 3.000 m²'lik sosyal hizmet alanı ile modern bir teknik altyapıya sahiptir.</p>
                        <p>GTİ tarafından son teknolojiyle donatılmış bu tesiste Gümrük Müdürlüğü'ne ait birimlerin yanı sıra, başta gümrük müşavirliği ve lojistik firmaları olmak üzere dış ticaret ile ilişkili kurum, kuruluş, meslek odaları ve sivil toplum temsilciliklerinin kullanımına sunulmuş 200'e yakın ofis bulunmaktadır.</p>
                        <p>Gümrük işlemleri ve lojistik hizmetler için giriş/çıkış yapan TIR şoförlerinin ihtiyaçları düşünülerek planlanlanan Muratbey Gümrük Müdürlüğü; kafe, restoran ve market gibi sosyal alanlarla birlikte ATM, berber, duş ve cami dahil olmak üzere her türlü hizmeti tek çatı altında toplayarak, modern ve teknolojik bir tesis olarak faaliyet göstermektedir.</p>
                    </div>
                </div>
            </div>
            
            <!-- İletişim Bölümü -->
            <div id="contactSection" class="hero" style="display: none;">
                <div class="hero-overlay"></div>
                <div class="about-content-inline">
                    <div class="about-header-inline">
                        <h1>İletişim Bilgileri</h1>
                        <button id="backFromContactBtn" class="back-button">Ana Sayfa'ya Dön</button>
                    </div>
                    <div class="contact-container">
                        <div class="contact-info">
                            <div class="contact-item">
                                <div class="contact-icon"><i class="location-icon"></i></div>
                                <div class="contact-details">
                                    <h3>MURATBEY / İSTANBUL</h3>
                                    <p>Muratbey Gümrük Müdürlüğü Tesisleri, Muratbey – Çatalca / İstanbul</p>
                                </div>
                            </div>
                            <div class="contact-item">
                                <div class="contact-icon"><i class="phone-icon"></i></div>
                                <div class="contact-details">
                                    <h3>Telefon</h3>
                                    <p>0212 867 94 00</p>
                                    <p>0212 867 94 04</p>
                                    <p>+90 539 632 65 47</p>
                                </div>
                            </div>
                            <div class="contact-item">
                                <div class="contact-icon"><i class="email-icon"></i></div>
                                <div class="contact-details">
                                    <h3>E-posta</h3>
                                    <p><a href="mailto:halkali@gtias.com.tr">halkali@gtias.com.tr</a></p>
                                    <p><a href="mailto:adolen@gtias.com.tr">adolen@gtias.com.tr</a></p>
                                </div>
                            </div>
                        </div>
                        <div class="map-container">
                            <h3>Konum</h3>
                            <div class="map-embed">
                                <iframe src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3008.3940702935957!2d28.504767376303288!3d41.07955137932056!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x14caa418ffffffff%3A0x8537eb98b2380b34!2sMuratbey%20G%C3%BCmr%C3%BCk%20M%C3%BCd%C3%BCrl%C3%BC%C4%9F%C3%BC!5e0!3m2!1str!2str!4v1653380326054!5m2!1str!2str" width="100%" height="300" style="border:0;" allowfullscreen="" loading="lazy" referrerpolicy="no-referrer-when-downgrade"></iframe>
                            </div>
                            <p><a href="https://www.google.com.tr/maps/place/Muratbey+G%C3%BCmr%C3%BCk+M%C3%BCd%C3%BCrl%C3%BC%C4%9F%C3%BC/@41.0795514,28.5069621,17z/data=!3m1!4b1!4m6!3m5!1s0x14caa418ffffffff:0x8537eb98b2380b34!8m2!3d41.0795514!4d28.5069621!16s%2Fg%2F11bz_0w12h?hl=tr&entry=ttu&g_ep=EgoyMDI1MDUxNS4wIKXMDSoASAFQAw%3D%3D" target="_blank" class="map-link">Yol Tarifi Al <i class="arrow-icon"></i></a></p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Hakkımızda Modal -->
    <div id="aboutModal" class="about-modal">
        <div class="about-content">
            <div class="about-header">
                <h2>Muratbey Gümrük Müdürlüğü Hakkında</h2>
                <button class="close-about" id="closeAboutBtn">&times;</button>
            </div>
            <div class="about-stats">
                <div class="stat-box">
                    <div class="stat-number">220.000 m²</div>
                    <div class="stat-label">Toplam Alan</div>
                </div>
                <div class="stat-box">
                    <div class="stat-number">56.472 m²</div>
                    <div class="stat-label">Kapalı Alan</div>
                </div>
                <div class="stat-box">
                    <div class="stat-number">0</div>
                    <div class="stat-label">Yolcu Kapasitesi</div>
                </div>
                <div class="stat-box">
                    <div class="stat-number">0</div>
                    <div class="stat-label">Taşıt Kapasitesi</div>
                </div>
            </div>
            <div class="about-text">
                <p>Türkiye'nin dış ticaretinde önemli bir yere sahip olan, şehir içinde kaldığı için trafik akışını olumsuz etkileyen, fiziki koşullarının yetersizliği nedeniyle ihtiyaca cevap veremeyen, eski adıyla Halkalı Gümrük Müdürlüğü modernize edilerek İstanbul'un Çatalca bölgesine taşınmış ve Muratbey Gümrük Müdürlüğü olarak hizmete sunulmuştur.</p>
                <p>Şehir trafiğine girmeden kolaylıkla erişilebilen Muratbey Gümrük Müdürlüğü, yeni yapılanmasıyla birlikte 220.000 m2 alan üzerine kurulmuş olup, 35.000 m² depo alanı, 4.150 m² ofis alanı ve 3.000 m²'lik sosyal hizmet alanı ile modern bir teknik altyapıya sahiptir.</p>
                <p>GTİ tarafından son teknolojiyle donatılmış bu tesiste Gümrük Müdürlüğü'ne ait birimlerin yanı sıra, başta gümrük müşavirliği ve lojistik firmaları olmak üzere dış ticaret ile ilişkili kurum, kuruluş, meslek odaları ve sivil toplum temsilciliklerinin kullanımına sunulmuş 200'e yakın ofis bulunmaktadır.</p>
                <p>Gümrük işlemleri ve lojistik hizmetler için giriş/çıkış yapan TIR şoförlerinin ihtiyaçları düşünülerek planlanlanan Muratbey Gümrük Müdürlüğü; kafe, restoran ve market gibi sosyal alanlarla birlikte ATM, berber, duş ve cami dahil olmak üzere her türlü hizmeti tek çatı altında toplayarak, modern ve teknolojik bir tesis olarak faaliyet göstermektedir.</p>
            </div>
        </div>
    </div>
    
    <!-- Giriş Modal -->
    <div id="loginModal" class="login-modal">
        <div class="login-form">
            <div class="login-header">
                <img src="gti-logo.svg" alt="GTİ Logo" class="logo" style="height: 40px;">
                <h2>Yönetici Girişi</h2>
            </div>
            <div class="form-group">
                <label for="username">Kullanıcı Adı:</label>
                <input type="text" id="username" placeholder="Kullanıcı adınızı girin">
            </div>
            <div class="form-group">
                <label for="password">Şifre:</label>
                <input type="password" id="password" placeholder="Şifrenizi girin">
                <div id="loginError" class="error-message"></div>
            </div>
            <div class="form-actions">
                <button id="submitLoginBtn" class="login-button">Giriş Yap</button>
                <button id="closeLoginBtn" class="close-button">İptal</button>
            </div>
        </div>
    </div>

    <!-- Uygulama Ekranı -->
    <div id="appScreen">
        <!-- Üst Menü -->
        <header class="header">
            <div class="logo-container">
                <img src="gti-logo.svg" alt="GTİ Logo" class="logo">
                <div class="logo-text">
                    <h1>Ofis Sayaç Takip Sistemi</h1>
                </div>
            </div>
            <nav class="nav-menu">
                <a href="#" class="nav-item">Ana Sayfa</a>
                <a href="#" class="nav-item">Ofisler</a>
                <a href="#" class="nav-item">Raporlar</a>
                <a href="#" class="nav-item">Yardım</a>
            </nav>
        </header>

        <!-- Ana İçerik -->
        <div class="content">
            <div class="user-info">
                <span class="user-name">Hoş geldiniz, <span id="currentUsername">Kullanıcı</span></span>
                <button id="logoutButton" class="logout-button">Çıkış Yap</button>
            </div>

            <div class="main-container">
                <!-- Sol Menü -->
                <div class="sidebar">
                    <h3>Ofisler</h3>
                    <!-- Kullanıcı arayüzü için ofis arama kutusu -->
                    <input type="text" id="userOfficeSearch" class="search-box" placeholder="Ofis ara...">
                    <div id="officeList">
                        <!-- Ofisler burada listelenecek -->
                    </div>
                </div>

                <!-- Sağ İçerik -->
                <div class="main-content">
                    <h1 class="page-title">
                        Sayaç Takip Sistemi
                        <span class="date-display" id="currentDate"></span>
                    </h1>
                    <div class="notification" id="notification">Sayaç değerleri başarıyla kaydedildi!</div>
                    
                    <div id="officeDetail">
                        <p>Lütfen sol taraftan bir ofis seçin.</p>
                    </div>
                    
                    <div id="meterForm" style="display: none;">
                        <h2 id="officeName" style="margin-bottom: 20px; color: #1e2738;"></h2>
                        <div class="form-group">
                            <label for="electricMeter">Elektrik Sayacı:</label>
                            <div style="display: flex; margin-bottom: 5px;">
                                <input type="number" id="electricMeterNo" placeholder="Elektrik sayaç numarası" style="flex: 1; margin-right: 10px;" readonly>
                                <input type="number" id="electricMeter" placeholder="Elektrik sayaç değerini girin" style="flex: 1;">
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="waterMeter">Su Sayacı:</label>
                            <div style="display: flex; margin-bottom: 5px;">
                                <input type="number" id="waterMeterNo" placeholder="Su sayaç numarası" style="flex: 1; margin-right: 10px;" readonly>
                                <input type="number" id="waterMeter" placeholder="Su sayaç değerini girin" style="flex: 1;">
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="gasMeter">Doğalgaz Sayacı:</label>
                            <input type="number" id="gasMeter" placeholder="Doğalgaz sayaç değerini girin">
                        </div>
                        <button id="saveButton" class="login-button">Kaydet</button>
                        
                            <h3>Geçmiş Kayıtlar</h3>
                            <table id="historyTable">
                                <thead>
                                    <tr>
                                        <th>Tarih</th>
                                        <th>Elektrik (kWh)</th>
                                        <th>Su (m³)</th>
                                        <th>Doğalgaz (m³)</th>
                                    </tr>
                                </thead>
                                <tbody id="historyBody">
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Alt Bilgi -->
        <footer class="footer">
            <p>© 2025 GTİ | Tüm Hakları Saklıdır</p>
        </footer>
    </div>

    <!-- Admin Panel -->
    <div id="adminPanel" style="display: none;">
        <header class="header">
            <div class="logo-container">
                <img src="gti-logo.svg" alt="GTİ Logo" class="logo">
                <div class="logo-text">
                    <h1>Ofis Sayaç Takip Sistemi</h1>
                </div>
            </div>
            <nav class="nav-menu">
                <a href="#" class="nav-item" id="dashboardLink">Ana Sayfa</a>
                <a href="#" class="nav-item active" id="adminLink">Yönetici Paneli</a>
                <a href="#" class="nav-item">Yardım</a>
            </nav>
        </header>

        <div class="content">
            <div class="user-info">
                <span class="user-name">Hoş geldiniz, <span id="adminUsername">Yönetici</span></span>
                <button id="adminLogoutButton" class="logout-button">Çıkış Yap</button>
            </div>

            <div class="main-container">
                <div class="sidebar" style="width: 200px; max-height: 700px;">
                    <h3>İşlemler</h3>
                    <div>
                        <div class="office-item active" data-panel="userPanel">Kullanıcı Yönetimi</div>
                        <div class="office-item" data-panel="officePanel">Ofis Yönetimi</div>
                        <div class="office-item" data-panel="meterPanel">Sayaç Yönetimi</div>
                        <div class="office-item" data-panel="reportPanel">Raporlar</div>
                        <div class="office-item" data-panel="statusPanel">Ofis Veri Durumu</div>
                    </div>
                </div>

                <div class="main-content">
                    <!-- Kullanıcı Yönetimi Paneli -->
                    <div id="userPanel" class="admin-panel-content">
                        <h1 class="page-title">Kullanıcı Yönetimi</h1>
                        
                        <div style="margin-bottom: 20px;">
                            <button id="addUserBtn" class="login-button" style="margin-right: 10px;">Yeni Kullanıcı Ekle</button>
                        </div>
                        
                        <table>
                            <thead>
                                <tr>
                                    <th>Kullanıcı Adı</th>
                                    <th>Ad Soyad</th>
                                    <th>Rol</th>
                                    <th>İşlemler</th>
                                </tr>
                            </thead>
                            <tbody id="userTableBody">
                                <!-- Kullanıcılar listelenecek -->
                            </tbody>
                        </table>
                    </div>
                    
                    <!-- Ofis Yönetimi Paneli -->
                    <div id="officePanel" class="admin-panel-content" style="display: none;">
                        <h1 class="page-title">Ofis Yönetimi</h1>
                        
                        <div class="search-container" style="margin-bottom: 20px;">
                            <input type="text" id="adminOfficeSearch" placeholder="Ofis ara..." style="padding: 10px; width: 300px;">
                        </div>
                        
                        <div id="officeEditForm" style="display: none; margin-top: 20px; padding: 20px; background-color: #f9f9f9; border-radius: 5px;">
                            <h3>Ofis Bilgileri Düzenle</h3>
                            <div class="form-group">
                                <label for="editOfficeNo">Ofis No:</label>
                                <input type="text" id="editOfficeNo" readonly>
                            </div>
                            <div class="form-group">
                                <label for="editOfficeName">Firma Adı:</label>
                                <input type="text" id="editOfficeName">
                            </div>
                            <div class="form-group">
                                <label for="editElectricMeterNo">Elektrik Sayaç No:</label>
                                <input type="text" id="editElectricMeterNo">
                            </div>
                            <div class="form-group">
                                <label for="editWaterMeterNo">Su Sayaç No:</label>
                                <input type="text" id="editWaterMeterNo">
                            </div>
                            <button id="saveOfficeBtn" class="login-button">Kaydet</button>
                            <button id="cancelOfficeEditBtn" class="close-button" style="margin-left: 10px;">İptal</button>
                        </div>
                        
                        <table>
                            <thead>
                                <tr>
                                    <th>Ofis No</th>
                                    <th>Firma Adı</th>
                                    <th>Elektrik Sayaç No</th>
                                    <th>Su Sayaç No</th>
                                    <th>İşlemler</th>
                                </tr>
                            </thead>
                            <tbody id="officeTableBody">
                                <!-- Ofisler listelenecek -->
                            </tbody>
                        </table>
                    </div>
                    
                    <!-- Sayaç Yönetimi Paneli -->
                    <div id="meterPanel" class="admin-panel-content" style="display: none;">
                        <h1 class="page-title">Sayaç Yönetimi</h1>
                        
                        <div class="search-container" style="margin-bottom: 20px;">
                            <input type="text" id="adminMeterSearch" placeholder="Sayaç ara..." style="padding: 10px; width: 300px;">
                        </div>
                        
                        <table>
                            <thead>
                                <tr>
                                    <th>Ofis No</th>
                                    <th>Sayaç Tipi</th>
                                    <th>Sayaç No</th>
                                    <th>Son Değer</th>
                                    <th>İşlemler</th>
                                </tr>
                            </thead>
                            <tbody id="meterTableBody">
                                <!-- Sayaçlar listelenecek -->
                            </tbody>
                        </table>
                    </div>
                    
                    <!-- Raporlar Paneli -->
                    <div id="reportPanel" class="admin-panel-content" style="display: none;">
                        <h1 class="page-title">Raporlar</h1>
                        
                        <div style="margin-bottom: 20px;">
                            <button id="exportAllToExcel" class="login-button">Tüm Ofis Kayıtlarını Excel'e Aktar</button>
                        </div>
                        
                        <div id="reportResult" class="result-container">
                            <p>Raporlarınız burada görüntülenecektir.</p>
                        </div>
                    </div>
                    
                    <!-- Ofis Veri Durumu Paneli -->
                    <div id="statusPanel" class="admin-panel-content" style="display: none;">
                        <h1 class="page-title">Ofis Veri Durumu</h1>
                        
                        <div class="search-container" style="margin-bottom: 20px;">
                            <input type="text" id="statusOfficeSearch" placeholder="Ofis ara..." style="padding: 10px; width: 300px;">
                        </div>
                        
                        <table class="status-table">
                            <thead>
                                <tr>
                                    <th>Blok</th>
                                    <th>Ofis No</th>
                                    <th>Firma Adı</th>
                                    <th>Elektrik Sayaç</th>
                                    <th>Su Sayaç</th>
                                    <th>Veri Giren</th>
                                    <th>Tarih</th>
                                    <th>Durum</th>
                                </tr>
                            </thead>
                            <tbody id="statusTableBody">
                                <!-- Ofis veri durumları listelenecek -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Yeni Kullanıcı Ekleme Modal -->
    <div id="addUserModal" class="login-modal">
        <div class="login-form">
            <div class="login-header">
                <h2>Yeni Kullanıcı Ekle</h2>
            </div>
            <div class="form-group">
                <label for="newUsername">Kullanıcı Adı:</label>
                <input type="text" id="newUsername" placeholder="Kullanıcı adı girin">
            </div>
            <div class="form-group">
                <label for="newFullName">Ad Soyad:</label>
                <input type="text" id="newFullName" placeholder="Ad Soyad girin">
            </div>
            <div class="form-group">
                <label for="newPassword">Şifre:</label>
                <input type="password" id="newPassword" placeholder="Şifre girin">
            </div>
            <div class="form-group">
                <label for="newRole">Rol:</label>
                <select id="newRole" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 4px;">
                    <option value="user">Kullanıcı</option>
                    <option value="admin">Yönetici</option>
                </select>
            </div>
            <div class="form-actions">
                <button id="saveUserBtn" class="login-button">Kaydet</button>
                <button id="cancelUserBtn" class="close-button">İptal</button>
            </div>
        </div>
    </div>

    <!-- Sayaç Düzenleme Modal -->
    <div id="editMeterModal" class="login-modal">
        <div class="login-form">
            <div class="login-header">
                <h2>Sayaç Düzenle</h2>
            </div>
            <div class="form-group">
                <label for="editMeterOffice">Ofis:</label>
                <input type="text" id="editMeterOffice" readonly>
            </div>
            <div class="form-group">
                <label for="editMeterType">Sayaç Tipi:</label>
                <input type="text" id="editMeterType" readonly>
            </div>
            <div class="form-group">
                <label for="editMeterNo">Sayaç No:</label>
                <input type="text" id="editMeterNo">
            </div>
            <div class="form-group">
                <label for="editMeterReading">Son Değer:</label>
                <input type="number" id="editMeterReading">
            </div>
            <div class="form-actions">
                <button id="saveMeterBtn" class="login-button">Kaydet</button>
                <button id="cancelMeterBtn" class="close-button">İptal</button>
            </div>
        </div>
    </div>

    <!-- Excel Yükleme Formu -->
    <input type="file" id="excelFileInput" accept=".xlsx,.xls" style="display: none;">

    <!-- Ana JavaScript kodu -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script>
        // Kullanıcı bilgileri - gerçek bir uygulamada veritabanında saklanmalı
        const users = [
            { username: "admin", password: "admin123", name: "Yönetici", role: "admin" },
            { username: "teknik", password: "teknik123", name: "Teknik Personel", role: "user" }
        ];
        
        // Kullanıcı oturumu
        let currentUser = null;
        
        // Ofis verileri
        let offices = [
            // 1B Blok
            { id: "1", office_no: "1B-21", name: "Halit Demirkan", 
              electric: { meter_no: "39296823", last_reading: 0 },
              water: { meter_no: "5185306", last_reading: 0 }
            },
            { id: "2", office_no: "1B-20", name: "His Gümrük Müşavirliği LTD.ŞTİ.", 
              electric: { meter_no: "39297205", last_reading: 0 },
              water: { meter_no: "5185291", last_reading: 0 }
            },
            { id: "3", office_no: "1B-19", name: "", 
              electric: { meter_no: "", last_reading: 0 },
              water: { meter_no: "5185285", last_reading: 0 }
            },
            { id: "4", office_no: "1B-18", name: "Narin Gümrük Müşavirliği", 
              electric: { meter_no: "39296915", last_reading: 0 },
              water: { meter_no: "5185331", last_reading: 0 }
            },
            { id: "5", office_no: "1B-17", name: "OMN Gümrük Müşavirliği LTD.ŞTİ.", 
              electric: { meter_no: "39296908", last_reading: 0 },
              water: { meter_no: "", last_reading: 0 }
            },
            { id: "6", office_no: "1B-16", name: "Arion Gümrükleme LTD.ŞTİ.", 
              electric: { meter_no: "39296836", last_reading: 0 },
              water: { meter_no: "5185369", last_reading: 0 }
            },
            { id: "7", office_no: "1B-15", name: "DDP Gümrük Müşavirliği", 
              electric: { meter_no: "39296267", last_reading: 0 },
              water: { meter_no: "5185349", last_reading: 0 }
            },
            { id: "8", office_no: "1B-14", name: "Erben Gümrük Müşavirliği Ltd.Şti.", 
              electric: { meter_no: "39297028", last_reading: 0 },
              water: { meter_no: "5185342", last_reading: 0 }
            },
            { id: "9", office_no: "1B-13", name: "Anka Dia Gümrük Müşavirliği A.ş", 
              electric: { meter_no: "39296753", last_reading: 0 },
              water: { meter_no: "5185367", last_reading: 0 }
            },
            { id: "10", office_no: "1B-12", name: "İmer Gümrük Müşavirliği LTD.ŞTİ.", 
              electric: { meter_no: "39297212", last_reading: 0 },
              water: { meter_no: "5185280", last_reading: 0 }
            },
            { id: "11", office_no: "1B-11", name: "", 
              electric: { meter_no: "39297070", last_reading: 0 },
              water: { meter_no: "5185329", last_reading: 0 }
            },
            { id: "12", office_no: "1B-10", name: "İGT Gümrük Müş.LTD.ŞTİ.", 
              electric: { meter_no: "39297011", last_reading: 0 },
              water: { meter_no: "5185259", last_reading: 0 }
            },
            { id: "13", office_no: "1B-09", name: "Seçkin Gümrük Müşavirliği LTD.ŞTİ.", 
              electric: { meter_no: "39297109", last_reading: 0 },
              water: { meter_no: "5185366", last_reading: 0 }
            },
            { id: "14", office_no: "1B-08", name: "Peyiç Transport Dış Tic. LTD.ŞTİ. (TAH)", 
              electric: { meter_no: "39296844", last_reading: 0 },
              water: { meter_no: "5185252", last_reading: 0 }
            },
            { id: "15", office_no: "1B-07", name: "Hüseyin Bayram", 
              electric: { meter_no: "39297168", last_reading: 0 },
              water: { meter_no: "5185299", last_reading: 0 }
            },
            { id: "16", office_no: "1B-06", name: "Hizmet Gümrük Müşavirliği LTD.ŞTİ.", 
              electric: { meter_no: "39297104", last_reading: 0 },
              water: { meter_no: "5185394", last_reading: 0 }
            },
            { id: "17", office_no: "1B-05", name: "Tan Group Lojistik LTD.ŞTİ.", 
              electric: { meter_no: "39297034", last_reading: 0 },
              water: { meter_no: "16323436", last_reading: 0 }
            },
            { id: "18", office_no: "1B-04", name: "Barsan Global Lojistik A.Ş.", 
              electric: { meter_no: "39296811", last_reading: 0 },
              water: { meter_no: "16328443", last_reading: 0 }
            },
            { id: "19", office_no: "1B-03", name: "Evolog Nakliyat Loj.Hiz.Tic.Ltd.Şti.", 
              electric: { meter_no: "39297172", last_reading: 0 },
              water: { meter_no: "5185386", last_reading: 0 }
            },
            { id: "20", office_no: "1B-02", name: "Ünsped Gümrük Müşavirliği ve Loj. Hiz. A.Ş.", 
              electric: { meter_no: "39297118", last_reading: 0 },
              water: { meter_no: "1815964", last_reading: 0 }
            },
            { id: "21", office_no: "1B-01", name: "", 
              electric: { meter_no: "39296999", last_reading: 0 },
              water: { meter_no: "5185362", last_reading: 0 }
            },
            
            // 2B Blok
            { id: "22", office_no: "2B-24", name: "Sertrans Uluslararası Nakliyat Tic. A.Ş.", 
              electric: { meter_no: "39296878", last_reading: 0 },
              water: { meter_no: "5185271", last_reading: 0 }
            },
            { id: "23", office_no: "2B-23", name: "Güzel Lojistik/Ömer Güzel", 
              electric: { meter_no: "39297020", last_reading: 0 },
              water: { meter_no: "5185384", last_reading: 0 }
            },
            { id: "24", office_no: "2B-22", name: "", 
              electric: { meter_no: "", last_reading: 0 },
              water: { meter_no: "5185380", last_reading: 0 }
            },
            { id: "25", office_no: "2B-21", name: "Devnak Nakliyat Tur. İç ve Dış Tic. A.Ş.", 
              electric: { meter_no: "39297181", last_reading: 0 },
              water: { meter_no: "5185397", last_reading: 0 }
            },
            { id: "26", office_no: "2B-20", name: "Gelişim Ulus.Loj.Dış Tic.LTD.ŞTİ.", 
              electric: { meter_no: "39297078", last_reading: 0 },
              water: { meter_no: "5185368", last_reading: 0 }
            },
            { id: "27", office_no: "2B-19", name: "Ulus Gümrük Müşavirliği Ltd. Şti.", 
              electric: { meter_no: "39297015", last_reading: 0 },
              water: { meter_no: "5185260", last_reading: 0 }
            },
            { id: "28", office_no: "2B-18", name: "Ekol Gümrük Müşavirliği A.Ş.", 
              electric: { meter_no: "39297052", last_reading: 0 },
              water: { meter_no: "5185279", last_reading: 0 }
            },
            { id: "29", office_no: "2B-17", name: "", 
              electric: { meter_no: "39297157", last_reading: 0 },
              water: { meter_no: "5185437", last_reading: 0 }
            },
            { id: "30", office_no: "2B-16", name: "", 
              electric: { meter_no: "39297152", last_reading: 0 },
              water: { meter_no: "5185450", last_reading: 0 }
            },
            { id: "31", office_no: "2B-15", name: "Oğuz Gümrük Müşavirliği LTD.ŞTİ.", 
              electric: { meter_no: "39296750", last_reading: 0 },
              water: { meter_no: "5185287", last_reading: 0 }
            },
            { id: "32", office_no: "2B-14", name: "", 
              electric: { meter_no: "", last_reading: 0 },
              water: { meter_no: "5185387", last_reading: 0 }
            },
            { id: "33", office_no: "2B-13", name: "", 
              electric: { meter_no: "39296802", last_reading: 0 },
              water: { meter_no: "5185292", last_reading: 0 }
            },
            { id: "34", office_no: "2B-12", name: "", 
              electric: { meter_no: "39297175", last_reading: 0 },
              water: { meter_no: "5185390", last_reading: 0 }
            },
            { id: "35", office_no: "2B-11", name: "", 
              electric: { meter_no: "", last_reading: 0 },
              water: { meter_no: "5185284", last_reading: 0 }
            },
            { id: "36", office_no: "2B-10", name: "Magna Gümrük Müşavirliği Dış Tic.LTD.ŞTİ.", 
              electric: { meter_no: "39297059", last_reading: 0 },
              water: { meter_no: "5185393", last_reading: 0 }
            },
            { id: "37", office_no: "2B-09", name: "Mekar Gümrük Müşavirliği LTD.ŞTİ.", 
              electric: { meter_no: "39297153", last_reading: 0 },
              water: { meter_no: "5185413", last_reading: 0 }
            },
            { id: "38", office_no: "2B-08", name: "DCS Dijital Gümrük Hizmetleri A.Ş.", 
              electric: { meter_no: "39296783", last_reading: 0 },
              water: { meter_no: "8846564", last_reading: 0 }
            },
            { id: "39", office_no: "2B-07", name: "İstanbul Ticaret Odası", 
              electric: { meter_no: "52636359", last_reading: 0 },
              water: { meter_no: "5185268", last_reading: 0 }
            },
            
            // 3B Blok
            { id: "40", office_no: "3B-15", name: "TÜRK STANDARDLARI ENSTİTÜSÜ", 
              electric: { meter_no: "39296840", last_reading: 0 },
              water: { meter_no: "5185307", last_reading: 0 }
            },
            { id: "41", office_no: "3B-14", name: "TÜRK STANDARDLARI ENSTİTÜSÜ", 
              electric: { meter_no: "39297169", last_reading: 0 },
              water: { meter_no: "5185277", last_reading: 0 }
            },
            { id: "42", office_no: "3B-13", name: "TÜRK STANDARDLARI ENSTİTÜSÜ", 
              electric: { meter_no: "39296792", last_reading: 0 },
              water: { meter_no: "5185278", last_reading: 0 }
            },
            { id: "43", office_no: "3B-12", name: "TÜRK STANDARDLARI ENSTİTÜSÜ", 
              electric: { meter_no: "39296831", last_reading: 0 },
              water: { meter_no: "5185258", last_reading: 0 }
            },
            { id: "44", office_no: "3B-11", name: "TÜRK STANDARDLARI ENSTİTÜSÜ", 
              electric: { meter_no: "39296998", last_reading: 0 },
              water: { meter_no: "5185403", last_reading: 0 }
            },
            { id: "45", office_no: "3B-10", name: "TÜRK STANDARDLARI ENSTİTÜSÜ", 
              electric: { meter_no: "39296856", last_reading: 0 },
              water: { meter_no: "5185440", last_reading: 0 }
            },
            { id: "46", office_no: "3B-09", name: "TÜRK STANDARDLARI ENSTİTÜSÜ", 
              electric: { meter_no: "39267079", last_reading: 0 },
              water: { meter_no: "5185407", last_reading: 0 }
            },
            { id: "47", office_no: "3B-08", name: "TÜRK STANDARDLARI ENSTİTÜSÜ", 
              electric: { meter_no: "39297062", last_reading: 0 },
              water: { meter_no: "5185319", last_reading: 0 }
            },
            { id: "48", office_no: "3B-07", name: "TÜRK STANDARDLARI ENSTİTÜSÜ", 
              electric: { meter_no: "39297102", last_reading: 0 },
              water: { meter_no: "5185385", last_reading: 0 }
            },
            { id: "49", office_no: "3B-06", name: "TÜRK STANDARDLARI ENSTİTÜSÜ", 
              electric: { meter_no: "39297185", last_reading: 0 },
              water: { meter_no: "5185345", last_reading: 0 }
            },
            { id: "50", office_no: "3B-05", name: "TÜRK STANDARDLARI ENSTİTÜSÜ", 
              electric: { meter_no: "39297149", last_reading: 0 },
              water: { meter_no: "5185320", last_reading: 0 }
            },
            { id: "51", office_no: "3B-04", name: "TÜRK STANDARDLARI ENSTİTÜSÜ", 
              electric: { meter_no: "39297204", last_reading: 0 },
              water: { meter_no: "8846455", last_reading: 0 }
            },
            { id: "52", office_no: "3B-02", name: "DMS Marketçilik A.Ş.", 
              electric: { meter_no: "73262830", last_reading: 0 },
              water: { meter_no: "1815963", last_reading: 0 }
            },
            { id: "53", office_no: "3B-01", name: "Tülay TAŞ/Yemekhane", 
              electric: { meter_no: "73261635", last_reading: 0 },
              water: { meter_no: "2365633", last_reading: 0 }
            },
            
            // Z Blok
            { id: "54", office_no: "Z-63", name: "Nova Grup Müşavirlik LTD.ŞTİ.", 
              electric: { meter_no: "39297154", last_reading: 0 },
              water: { meter_no: "5185406", last_reading: 0 }
            },
            { id: "55", office_no: "Z-62", name: "Star Nakliyat/Aydın Aktimur", 
              electric: { meter_no: "39297190", last_reading: 0 },
              water: { meter_no: "5185334", last_reading: 0 }
            },
            { id: "56", office_no: "Z-61", name: "Çağberk Loj. Paz. İç ve Dış Tic. A.ş.", 
              electric: { meter_no: "39296873", last_reading: 0 },
              water: { meter_no: "5185317", last_reading: 0 }
            },
            { id: "57", office_no: "Z-60", name: "Emir Gümrük Müşavirliği LTD.ŞTİ.", 
              electric: { meter_no: "39297055", last_reading: 0 },
              water: { meter_no: "5185327", last_reading: 0 }
            },
            { id: "58", office_no: "Z-59", name: "HGL Gümrük Müş. LTD.ŞTİ.", 
              electric: { meter_no: "39297206", last_reading: 0 },
              water: { meter_no: "5185439", last_reading: 0 }
            },
            { id: "59", office_no: "Z-58", name: "", 
              electric: { meter_no: "", last_reading: 0 },
              water: { meter_no: "5185293", last_reading: 0 }
            },
            { id: "60", office_no: "Z-57", name: "Asav Loj. Hizmt. A.Ş.", 
              electric: { meter_no: "39296997", last_reading: 0 },
              water: { meter_no: "5185296", last_reading: 0 }
            },
            { id: "61", office_no: "Z-56", name: "Nehir Gümrükleme İç Dış Tic.LTD.ŞTİ.", 
              electric: { meter_no: "39297008", last_reading: 0 },
              water: { meter_no: "5185324", last_reading: 0 }
            },
            { id: "62", office_no: "Z-55", name: "Volkan Gümrükleme/Ayla Altuncu Baştımar", 
              electric: { meter_no: "39296777", last_reading: 0 },
              water: { meter_no: "5185305", last_reading: 0 }
            },
            { id: "63", office_no: "Z-54", name: "Tunaset Gümrük Müşavirliği", 
              electric: { meter_no: "39296884", last_reading: 0 },
              water: { meter_no: "5185310", last_reading: 0 }
            },
            { id: "64", office_no: "Z-53", name: "", 
              electric: { meter_no: "", last_reading: 0 },
              water: { meter_no: "5185373", last_reading: 0 }
            },
            { id: "65", office_no: "Z-52", name: "Erkal Ulus.Nak.Tic.LTD.ŞTİ.", 
              electric: { meter_no: "39297103", last_reading: 0 },
              water: { meter_no: "5185363", last_reading: 0 }
            },
            { id: "66", office_no: "Z-51", name: "Karem Gümrük Müşavirliği LTD.ŞTİ.", 
              electric: { meter_no: "39297126", last_reading: 0 },
              water: { meter_no: "5185404", last_reading: 0 }
            },
            { id: "67", office_no: "Z-50", name: "", 
              electric: { meter_no: "", last_reading: 0 },
              water: { meter_no: "5185370", last_reading: 0 }
            },
            { id: "68", office_no: "Z-49", name: "Küresel Gümrük Müş. Ve Loj. Hiz. A.Ş.", 
              electric: { meter_no: "39297013", last_reading: 0 },
              water: { meter_no: "5185383", last_reading: 0 }
            },
            { id: "69", office_no: "Z-48", name: "", 
              electric: { meter_no: "39139415", last_reading: 0 },
              water: { meter_no: "5185340", last_reading: 0 }
            },
            { id: "70", office_no: "Z-47", name: "Mainland Loj.Depolama Hizmt.LTD.ŞTİ.", 
              electric: { meter_no: "39296791", last_reading: 0 },
              water: { meter_no: "5185257", last_reading: 0 }
            },
            { id: "71", office_no: "Z-46", name: "Transalkım Ulus.Nak.Tic.LTD.ŞTİ.", 
              electric: { meter_no: "3929704", last_reading: 0 },
              water: { meter_no: "5185355", last_reading: 0 }
            },
            { id: "72", office_no: "Z-45", name: "", 
              electric: { meter_no: "", last_reading: 0 },
              water: { meter_no: "5185443", last_reading: 0 }
            },
            { id: "73", office_no: "Z-44", name: "Day Gümrük Müşavirliği A.Ş.", 
              electric: { meter_no: "39297139", last_reading: 0 },
              water: { meter_no: "5185375", last_reading: 0 }
            },
            { id: "74", office_no: "Z-43", name: "Data Gümrük Müşavirliği LTD.ŞTİ.", 
              electric: { meter_no: "39297120", last_reading: 0 },
              water: { meter_no: "5185417", last_reading: 0 }
            },
            { id: "75", office_no: "Z-42", name: "", 
              electric: { meter_no: "", last_reading: 0 },
              water: { meter_no: "", last_reading: 0 }
            },
            { id: "76", office_no: "Z-41", name: "Subaşı Gümrük Müşavirliği LTD.ŞTİ.", 
              electric: { meter_no: "39296778", last_reading: 0 },
              water: { meter_no: "5185311", last_reading: 0 }
            },
            { id: "77", office_no: "Z-40", name: "DMR Gümrük Müşavirliği LTD.ŞTİ.", 
              electric: { meter_no: "39296958", last_reading: 0 },
              water: { meter_no: "5185358", last_reading: 0 }
            },
            { id: "78", office_no: "Z-39", name: "Ömtur Loj.Dış Tic.", 
              electric: { meter_no: "39297009", last_reading: 0 },
              water: { meter_no: "5185313", last_reading: 0 }
            },
            { id: "79", office_no: "Z-38", name: "G.S.G. Gümrük Müşavirliği LTD.ŞTİ.", 
              electric: { meter_no: "39297142", last_reading: 0 },
              water: { meter_no: "5185270", last_reading: 0 }
            },
            { id: "80", office_no: "Z-37", name: "Haldun Karakoyun", 
              electric: { meter_no: "39297171", last_reading: 0 },
              water: { meter_no: "5185326", last_reading: 0 }
            },
            { id: "81", office_no: "Z-36", name: "Emirler Loj.Güm.Acent.Hiz.Tic.LTD.ŞTİ.", 
              electric: { meter_no: "39296912", last_reading: 0 },
              water: { meter_no: "", last_reading: 0 }
            },
            { id: "82", office_no: "Z-35", name: "Netist Dış Tic. A.Ş.", 
              electric: { meter_no: "39296808", last_reading: 0 },
              water: { meter_no: "5185298", last_reading: 0 }
            },
            { id: "83", office_no: "Z-34", name: "Solmaz Küresel Gümrük Müşavirliği A.Ş.", 
              electric: { meter_no: "39297032", last_reading: 0 },
              water: { meter_no: "5185427", last_reading: 0 }
            },
            { id: "84", office_no: "Z-33", name: "Solmaz Küresel Gümrük Müşavirliği A.Ş.", 
              electric: { meter_no: "39297148", last_reading: 0 },
              water: { meter_no: "5185303", last_reading: 0 }
            },
            { id: "85", office_no: "Z-32", name: "Trasant Ulus.Nak.Dış Tic.LTD.ŞTİ.", 
              electric: { meter_no: "39296830", last_reading: 0 },
              water: { meter_no: "5185275", last_reading: 0 }
            },
            { id: "86", office_no: "Z-31", name: "", 
              electric: { meter_no: "39297106", last_reading: 0 },
              water: { meter_no: "8846528", last_reading: 0 }
            },
            { id: "87", office_no: "Z-30", name: "", 
              electric: { meter_no: "", last_reading: 0 },
              water: { meter_no: "", last_reading: 0 }
            },
            { id: "88", office_no: "Z-29", name: "Öykü Gümrük Müşavirliği LTD.ŞTİ.", 
              electric: { meter_no: "39297081", last_reading: 0 },
              water: { meter_no: "5185318", last_reading: 0 }
            },
            { id: "89", office_no: "Z-28", name: "Link Denizcilik ve Taş.LTD.ŞTİ.", 
              electric: { meter_no: "39297203", last_reading: 0 },
              water: { meter_no: "5185304", last_reading: 0 }
            },
            { id: "90", office_no: "Z-27", name: "Güçlü Uluslararası Nak. Turz.San.Dış Tic.LTD.ŞTİ.", 
              electric: { meter_no: "39296901", last_reading: 0 },
              water: { meter_no: "5185304", last_reading: 0 }
            },
            { id: "91", office_no: "Z-26", name: "Ateşer Lojistik LTD.ŞTİ.", 
              electric: { meter_no: "39297030", last_reading: 0 },
              water: { meter_no: "5185441", last_reading: 0 }
            },
            { id: "92", office_no: "Z-25", name: "Duray Gümrükleme Ulus. Nak. Tic.LTD.ŞTİ.", 
              electric: { meter_no: "39296940", last_reading: 0 },
              water: { meter_no: "5185336", last_reading: 0 }
            },
            { id: "93", office_no: "Z-24", name: "Bultrans Ulus.Loj. Tic.LTD.ŞTİ.", 
              electric: { meter_no: "39297053", last_reading: 0 },
              water: { meter_no: "5185325", last_reading: 0 }
            },
            { id: "94", office_no: "Z-23", name: "Pozitif Gümrük Müşavirlik Hizmetleri LTD.ŞTİ.", 
              electric: { meter_no: "39296935", last_reading: 0 },
              water: { meter_no: "5185272", last_reading: 0 }
            },
            { id: "95", office_no: "Z-22", name: "Boykan Gümrük Müş.Loj. A.Ş.", 
              electric: { meter_no: "39297119", last_reading: 0 },
              water: { meter_no: "5185425", last_reading: 0 }
            },
            { id: "96", office_no: "Z-21", name: "Palamutlar Group Lojistik Dış Tic.LTD.ŞTİ.", 
              electric: { meter_no: "39297201", last_reading: 0 },
              water: { meter_no: "5185283", last_reading: 0 }
            },
            { id: "97", office_no: "Z-20", name: "Güçlü Uluslararası Nak. Turz.San.Dış Tic.LTD.ŞTİ.", 
              electric: { meter_no: "39297187", last_reading: 0 },
              water: { meter_no: "5155344", last_reading: 0 }
            },
            { id: "98", office_no: "Z-19", name: "Asy Gümrük Müşavirliği A.Ş.", 
              electric: { meter_no: "39297015", last_reading: 0 },
              water: { meter_no: "5185260", last_reading: 0 }
            },
            { id: "99", office_no: "Z-18", name: "Transmetro Gümrük Müşavirliği Tic.LTD.ŞTİ.", 
              electric: { meter_no: "39297092", last_reading: 0 },
              water: { meter_no: "5185323", last_reading: 0 }
            },
            { id: "100", office_no: "Z-17", name: "Tuaz Lojistik Gümrükleme LTD.ŞTİ.", 
              electric: { meter_no: "39297115", last_reading: 0 },
              water: { meter_no: "5185290", last_reading: 0 }
            },
            { id: "101", office_no: "Z-16", name: "Egemen Nakliyat San.Tic.LTD.ŞTİ.", 
              electric: { meter_no: "39296824", last_reading: 0 },
              water: { meter_no: "5185354", last_reading: 0 }
            },
            { id: "102", office_no: "Z-15", name: "Mentor Gümrük Müşavirliği LTD.ŞTİ.", 
              electric: { meter_no: "39296849", last_reading: 0 },
              water: { meter_no: "5185269", last_reading: 0 }
            },
            { id: "103", office_no: "Z-14", name: "İmex Taşımacılık San.Dış.Tic.LTD.ŞTİ.", 
              electric: { meter_no: "39296959", last_reading: 0 },
              water: { meter_no: "5185387", last_reading: 0 }
            },
            { id: "104", office_no: "Z-13", name: "Cem Trans/Murat AKÇA", 
              electric: { meter_no: "39296757", last_reading: 0 },
              water: { meter_no: "5185416", last_reading: 0 }
            },
            { id: "105", office_no: "Z-12", name: "E-Batı Gümrük Müşavirlik Hizmetleri LTD.ŞTİ.", 
              electric: { meter_no: "39296867", last_reading: 0 },
              water: { meter_no: "5185448", last_reading: 0 }
            },
            { id: "106", office_no: "Z-11", name: "Peyiç Transport Dış Tic.LTD.ŞTİ.", 
              electric: { meter_no: "39296761", last_reading: 0 },
              water: { meter_no: "5185389", last_reading: 0 }
            },
            { id: "107", office_no: "Z-10", name: "Bizz Trans Ulus.Nak./Aşkın Muammer Tekin", 
              electric: { meter_no: "39297068", last_reading: 0 },
              water: { meter_no: "5185409", last_reading: 0 }
            },
            { id: "108", office_no: "Z-09", name: "Turnak Gümrük Müşavirliği LTD.ŞTİ.", 
              electric: { meter_no: "39296764", last_reading: 0 },
              water: { meter_no: "5185337", last_reading: 0 }
            },
            { id: "109", office_no: "Z-08", name: "Sır Gümrük Müşavirli LTD.ŞTİ.", 
              electric: { meter_no: "39297176", last_reading: 0 },
              water: { meter_no: "5185321", last_reading: 0 }
            },
            { id: "110", office_no: "Z-07", name: "Oskar Gümrük Müşavirliği LTD.ŞTİ.", 
              electric: { meter_no: "39296784", last_reading: 0 },
              water: { meter_no: "5185261", last_reading: 0 }
            },
            { id: "111", office_no: "Z-06", name: "Boğaziçi Gümrük Müşavirliği A.Ş.", 
              electric: { meter_no: "39297202", last_reading: 0 },
              water: { meter_no: "5185408", last_reading: 0 }
            },
            { id: "112", office_no: "Z-05", name: "Tepe Gümrük Müşavirliği", 
              electric: { meter_no: "39297150", last_reading: 0 },
              water: { meter_no: "5185266", last_reading: 0 }
            },
            { id: "113", office_no: "Z-04", name: "Datalog Ulus.Taş İth.İhr.Dış Tic.LTD.ŞTİ.", 
              electric: { meter_no: "39297122", last_reading: 0 },
              water: { meter_no: "5185386", last_reading: 0 }
            },
            { id: "114", office_no: "Z-03", name: "Sienzi Loj. Antrepo Dış Tic.LTD.ŞTİ.", 
              electric: { meter_no: "39297129", last_reading: 0 },
              water: { meter_no: "5185365", last_reading: 0 }
            },
            { id: "115", office_no: "Z-02", name: "Doğruer Gümrük Müşavirliği LTD.ŞTİ.", 
              electric: { meter_no: "39297022", last_reading: 0 },
              water: { meter_no: "5185426", last_reading: 0 }
            },
            { id: "116", office_no: "Z-01", name: "Deks Tekstil İth.İhr.Turz.LTD.ŞTİ.", 
              electric: { meter_no: "39296962", last_reading: 0 },
              water: { meter_no: "5185446", last_reading: 0 }
            },
            
            // Numaralı ofisler (100+ serisi)
            { id: "117", office_no: "101", name: "Hüner Ulus.Taş.LTD.ŞTİ.", 
              electric: { meter_no: "39297099", last_reading: 0 },
              water: { meter_no: "5185267", last_reading: 0 }
            },
            { id: "118", office_no: "102", name: "Kızılkaya Gümrük Müşavirliği LTD.ŞTİ.", 
              electric: { meter_no: "39297010", last_reading: 0 },
              water: { meter_no: "5185335", last_reading: 0 }
            },
            { id: "119", office_no: "103", name: "Tezer Gümrük Müşavirliği", 
              electric: { meter_no: "39297097", last_reading: 0 },
              water: { meter_no: "5185374", last_reading: 0 }
            },
            { id: "120", office_no: "104", name: "Mettrans Taşımacılık ve Tic.LTD.ŞTİ.", 
              electric: { meter_no: "39296766", last_reading: 0 },
              water: { meter_no: "5185442", last_reading: 0 }
            },
            { id: "121", office_no: "105", name: "Ulustrans Ulus. Nak.Tic. A.Ş.", 
              electric: { meter_no: "39297165", last_reading: 0 },
              water: { meter_no: "5185392", last_reading: 0 }
            },
            { id: "122", office_no: "106", name: "Elt Global Loj. Ve Dış Ticaret A.Ş.", 
              electric: { meter_no: "39297088", last_reading: 0 },
              water: { meter_no: "5185378", last_reading: 0 }
            },
            { id: "123", office_no: "107", name: "Okuyan Gümrük Müşavirliği LTD.ŞTİ.", 
              electric: { meter_no: "39297107", last_reading: 0 },
              water: { meter_no: "5185410", last_reading: 0 }
            },
            { id: "124", office_no: "108", name: "Sentez Gümrük Müşavirliği LTD.ŞTİ.", 
              electric: { meter_no: "39297057", last_reading: 0 },
              water: { meter_no: "5185420", last_reading: 0 }
            },
            { id: "125", office_no: "109", name: "Bunasta Gümrük Transit Hiz.İth.İhr.Tic.A.Ş.", 
              electric: { meter_no: "39297208", last_reading: 0 },
              water: { meter_no: "5185364", last_reading: 0 }
            },
            { id: "126", office_no: "110", name: "İST Global Gümrük Müşavirliği", 
              electric: { meter_no: "39297039", last_reading: 0 },
              water: { meter_no: "5185276", last_reading: 0 }
            },
            { id: "127", office_no: "111", name: "Borusan Tedarik Zinciri. Çöz.ve Tek. A.Ş.", 
              electric: { meter_no: "39297089", last_reading: 0 },
              water: { meter_no: "5185339", last_reading: 0 }
            },
            { id: "128", office_no: "112", name: "Asset Gümrük Müşavirliği LTD.ŞTİ.", 
              electric: { meter_no: "39296817", last_reading: 0 },
              water: { meter_no: "5185309", last_reading: 0 }
            },
            { id: "129", office_no: "113", name: "BD Global Loj.Turz.San.Dış Tic.LTD.ŞTİ.", 
              electric: { meter_no: "39297188", last_reading: 0 },
              water: { meter_no: "5185289", last_reading: 0 }
            },
            { id: "130", office_no: "114", name: "Oben Gümrük Müşavirliği LTD.ŞTİ.", 
              electric: { meter_no: "39297128", last_reading: 0 },
              water: { meter_no: "5185429", last_reading: 0 }
            },
            { id: "131", office_no: "115", name: "Yıldız Gümrük Acent.Danışmanlık Hiz.LTD.ŞTİ.", 
              electric: { meter_no: "39297193", last_reading: 0 },
              water: { meter_no: "5185398", last_reading: 0 }
            },
            { id: "132", office_no: "116", name: "", 
              electric: { meter_no: "39297074", last_reading: 0 },
              water: { meter_no: "5185302", last_reading: 0 }
            },
            { id: "133", office_no: "117", name: "Boğa Ulus.Taş.Dış Tic.LTD.ŞTİ.", 
              electric: { meter_no: "39297182", last_reading: 0 },
              water: { meter_no: "5185405", last_reading: 0 }
            },
            { id: "134", office_no: "118", name: "HB Nakliyat Gümrükleme Sinan Atay", 
              electric: { meter_no: "39297125", last_reading: 0 },
              water: { meter_no: "5185343", last_reading: 0 }
            },
            { id: "135", office_no: "119", name: "Karaca Gümrük Müşavirliği A.Ş.", 
              electric: { meter_no: "39296790", last_reading: 0 },
              water: { meter_no: "5185379", last_reading: 0 }
            },
            { id: "136", office_no: "120", name: "Bor Gümrük Müşavirliği A.Ş.", 
              electric: { meter_no: "39296991", last_reading: 0 },
              water: { meter_no: "4975390", last_reading: 0 }
            },
            { id: "137", office_no: "121", name: "Güler Gümrük Müşavirliği A.Ş.", 
              electric: { meter_no: "39296805", last_reading: 0 },
              water: { meter_no: "5185308", last_reading: 0 }
            },
            { id: "138", office_no: "122", name: "Aslan Global Gümrük Müşavirliği A.Ş.", 
              electric: { meter_no: "39297058", last_reading: 0 },
              water: { meter_no: "5185428", last_reading: 0 }
            },
            { id: "139", office_no: "123", name: "Hitit Gümrük Müşavirliği LTD.ŞTİ.", 
              electric: { meter_no: "39297095", last_reading: 0 },
              water: { meter_no: "5185346", last_reading: 0 }
            },
            { id: "140", office_no: "124", name: "Duygu Gümrük Müşavirliği LTD.ŞTİ.", 
              electric: { meter_no: "39296829", last_reading: 0 },
              water: { meter_no: "5185332", last_reading: 0 }
            },
            { id: "141", office_no: "125", name: "Obdan Sistem Gümrük Müşavirliği LTD.ŞTİ.", 
              electric: { meter_no: "39296794", last_reading: 0 },
              water: { meter_no: "5185361", last_reading: 0 }
            },
            { id: "142", office_no: "126", name: "TGS Transport Ulus.Taş.Acen.LTD.ŞTİ.", 
              electric: { meter_no: "39297178", last_reading: 0 },
              water: { meter_no: "5185253", last_reading: 0 }
            },
            { id: "143", office_no: "127", name: "Erdal Büyükşahin", 
              electric: { meter_no: "39297209", last_reading: 0 },
              water: { meter_no: "5185411", last_reading: 0 }
            },
            { id: "144", office_no: "128", name: "Karınca Lojistik A.Ş.", 
              electric: { meter_no: "39296925", last_reading: 0 },
              water: { meter_no: "5185340", last_reading: 0 }
            },
            { id: "145", office_no: "129", name: "Armatrans Ulus.Taş. Acen.İth.İhr.Tic.LTD.ŞTİ.", 
              electric: { meter_no: "39297029", last_reading: 0 },
              water: { meter_no: "4675455", last_reading: 0 }
            },
            { id: "146", office_no: "130", name: "Tüm Global Lojistik Hiz.A.Ş.", 
              electric: { meter_no: "39297045", last_reading: 0 },
              water: { meter_no: "8846594", last_reading: 0 }
            },
            { id: "147", office_no: "131", name: "DMS Lojistik Taşımacılık LTD.ŞTİ.", 
              electric: { meter_no: "39297177", last_reading: 0 },
              water: { meter_no: "5185281", last_reading: 0 }
            },
            { id: "148", office_no: "132", name: "Sağlık Transport Nak. Tic. LTD.ŞTİ.", 
              electric: { meter_no: "39297087", last_reading: 0 },
              water: { meter_no: "5185444", last_reading: 0 }
            },
            { id: "149", office_no: "133", name: "", 
              electric: { meter_no: "", last_reading: 0 },
              water: { meter_no: "5185274", last_reading: 0 }
            },
            { id: "150", office_no: "134", name: "", 
              electric: { meter_no: "", last_reading: 0 },
              water: { meter_no: "5185274", last_reading: 0 }
            },
            { id: "151", office_no: "135", name: "TGL Gümrük Müşavirliği LTD.ŞTİ.", 
              electric: { meter_no: "39297127", last_reading: 0 },
              water: { meter_no: "5185264", last_reading: 0 }
            },
            { id: "152", office_no: "136", name: "", 
              electric: { meter_no: "", last_reading: 0 },
              water: { meter_no: "5185391", last_reading: 0 }
            },
            { id: "153", office_no: "137", name: "", 
              electric: { meter_no: "", last_reading: 0 },
              water: { meter_no: "", last_reading: 0 }
            },
            { id: "154", office_no: "138", name: "Orhan Yayla", 
              electric: { meter_no: "39297164", last_reading: 0 },
              water: { meter_no: "5185449", last_reading: 0 }
            },
            { id: "155", office_no: "139", name: "Asos Global Lojistik LTD.ŞTİ.", 
              electric: { meter_no: "39297156", last_reading: 0 },
              water: { meter_no: "5185438", last_reading: 0 }
            },
            { id: "156", office_no: "140", name: "MKR Gümrük Müşavirliği LTD.ŞTİ.", 
              electric: { meter_no: "39297207", last_reading: 0 },
              water: { meter_no: "5185312", last_reading: 0 }
            },
            { id: "157", office_no: "141", name: "Atabay Loj. Ve Gümrükleme Tic. LTD.ŞTİ.", 
              electric: { meter_no: "39297017", last_reading: 0 },
              water: { meter_no: "5185350", last_reading: 0 }
            },
            { id: "158", office_no: "142", name: "", 
              electric: { meter_no: "", last_reading: 0 },
              water: { meter_no: "", last_reading: 0 }
            },
            { id: "159", office_no: "143", name: "Yılmaz Uluslararası Taş. LTD.ŞTİ.", 
              electric: { meter_no: "39296853", last_reading: 0 },
              water: { meter_no: "5185436", last_reading: 0 }
            },
            { id: "160", office_no: "144", name: "BS Lojistik Dış Ticaret LTD.ŞTİ.", 
              electric: { meter_no: "39296910", last_reading: 0 },
              water: { meter_no: "5185431", last_reading: 0 }
            },
            { id: "161", office_no: "145", name: "", 
              electric: { meter_no: "", last_reading: 0 },
              water: { meter_no: "5185353", last_reading: 0 }
            },
            { id: "162", office_no: "146", name: "HG Gümrük Müşavirliği LTD.ŞTİ.", 
              electric: { meter_no: "39297136", last_reading: 0 },
              water: { meter_no: "5185263", last_reading: 0 }
            },
            { id: "163", office_no: "147", name: "KRE Kare Gümrük Müşavirliği", 
              electric: { meter_no: "39296987", last_reading: 0 },
              water: { meter_no: "5185388", last_reading: 0 }
            },
            { id: "164", office_no: "148", name: "", 
              electric: { meter_no: "39296755", last_reading: 0 },
              water: { meter_no: "5185416", last_reading: 0 }
            },
            { id: "165", office_no: "149", name: "Güneş Gümrük ve Lojistik Hiz. LTD.ŞTİ", 
              electric: { meter_no: "39297147", last_reading: 0 },
              water: { meter_no: "5185322", last_reading: 0 }
            },
            { id: "166", office_no: "150", name: "", 
              electric: { meter_no: "", last_reading: 0 },
              water: { meter_no: "5185282", last_reading: 0 }
            },
            { id: "167", office_no: "151", name: "Point Lojistik LTD.ŞTİ.", 
              electric: { meter_no: "39296819", last_reading: 0 },
              water: { meter_no: "5185402", last_reading: 0 }
            },
            { id: "168", office_no: "152", name: "Global Express Dış Tic.A.Ş.", 
              electric: { meter_no: "39296897", last_reading: 0 },
              water: { meter_no: "5185381", last_reading: 0 }
            },
            { id: "169", office_no: "153", name: "", 
              electric: { meter_no: "", last_reading: 0 },
              water: { meter_no: "5185264", last_reading: 0 }
            },
            { id: "170", office_no: "154", name: "On-El Gümrük Müşavirliği LTD.ŞTİ.", 
              electric: { meter_no: "39297083", last_reading: 0 },
              water: { meter_no: "5185400", last_reading: 0 }
            },
            { id: "171", office_no: "155", name: "Dörtel Gümrük Müşavirliği A.Ş.", 
              electric: { meter_no: "39297074", last_reading: 0 },
              water: { meter_no: "5185423", last_reading: 0 }
            },
            { id: "172", office_no: "156", name: "Teknik Gümrük Müşavirliği LTD.ŞTİ.", 
              electric: { meter_no: "39297108", last_reading: 0 },
              water: { meter_no: "5185255", last_reading: 0 }
            },
            { id: "173", office_no: "157", name: "Kuzey Gümrük Müşavirliği Hiz. LTD.ŞTİ.", 
              electric: { meter_no: "39297286", last_reading: 0 },
              water: { meter_no: "5185314", last_reading: 0 }
            },
            { id: "174", office_no: "158", name: "", 
              electric: { meter_no: "", last_reading: 0 },
              water: { meter_no: "5185372", last_reading: 0 }
            },
            { id: "175", office_no: "159", name: "Keskin Güngör Gümrük Müşavirliği LTD.ŞTİ.", 
              electric: { meter_no: "39297211", last_reading: 0 },
              water: { meter_no: "5185434", last_reading: 0 }
            },
            { id: "176", office_no: "160", name: "Teksim Gümrük Müş. LTD.ŞTİ.", 
              electric: { meter_no: "39297138", last_reading: 0 },
              water: { meter_no: "5185333", last_reading: 0 }
            },
            { id: "177", office_no: "161", name: "", 
              electric: { meter_no: "", last_reading: 0 },
              water: { meter_no: "5185347", last_reading: 0 }
            },
            { id: "178", office_no: "162", name: "Seray Ulus.Taş.İnş.Tic.LTD.ŞTİ.", 
              electric: { meter_no: "39297180", last_reading: 0 },
              water: { meter_no: "5185301", last_reading: 0 }
            },
            { id: "179", office_no: "163", name: "Derin Gümrük Müşavirliği LTD.ŞTİ.", 
              electric: { meter_no: "39297037", last_reading: 0 },
              water: { meter_no: "5185328", last_reading: 0 }
            },
            
            // ATM ve Banka
            { id: "180", office_no: "ATM01", name: "Türkiye Vakıflar Bankası T.A.O", 
              electric: { meter_no: "72950388", last_reading: 0 },
              water: { meter_no: "", last_reading: 0 }
            },
            { id: "181", office_no: "ATM02", name: "Ziraat Bankası A.Ş.", 
              electric: { meter_no: "21181800", last_reading: 0 },
              water: { meter_no: "", last_reading: 0 }
            },
            { id: "182", office_no: "ATM03", name: "Denizbank A.Ş.", 
              electric: { meter_no: "73941721", last_reading: 0 },
              water: { meter_no: "", last_reading: 0 }
            },
            { id: "183", office_no: "ATM04", name: "Garanti Bankası A.Ş.", 
              electric: { meter_no: "260019266", last_reading: 0 },
              water: { meter_no: "", last_reading: 0 }
            },
            { id: "184", office_no: "ATM05", name: "Türkiye İş Bankası A.Ş.", 
              electric: { meter_no: "260003752", last_reading: 0 },
              water: { meter_no: "", last_reading: 0 }
            },
            { id: "185", office_no: "ATM06", name: "Yapı Kredi Bankası A.Ş.", 
              electric: { meter_no: "52301997", last_reading: 0 },
              water: { meter_no: "", last_reading: 0 }
            },
            
            // Telekomünikasyon
            { id: "186", office_no: "Telekom-1", name: "Turkcell İletişim Hizmetleri A.Ş.", 
              electric: { meter_no: "39587154", last_reading: 0 },
              water: { meter_no: "", last_reading: 0 }
            },
            { id: "187", office_no: "Telekom-2", name: "Vodafone Telekomünikasyon A.Ş.", 
              electric: { meter_no: "40839162", last_reading: 0 },
              water: { meter_no: "", last_reading: 0 }
            },
            { id: "188", office_no: "Telekom-3", name: "TT MOBİL İLETİŞİM HİZMETLERİ A.Ş.", 
              electric: { meter_no: "41038534", last_reading: 0 },
              water: { meter_no: "", last_reading: 0 }
            },
            
            // Özel Bölgeler
            { id: "189", office_no: "20A", name: "Hamit CENGİZ/İthalat Giriş", 
              electric: { meter_no: "40172802", last_reading: 0 },
              water: { meter_no: "2365436", last_reading: 0 }
            },
            { id: "190", office_no: "20-2", name: "Hamit CENGİZ/Nakliye Giriş", 
              electric: { meter_no: "40172476", last_reading: 0 },
              water: { meter_no: "2365382", last_reading: 0 }
            },
            { id: "191", office_no: "2B01", name: "Hamit CENGİZ/Bina Cafe", 
              electric: { meter_no: "73262760", last_reading: 0 },
              water: { meter_no: "900723640", last_reading: 0 }
            },
            { id: "192", office_no: "20-6R", name: "ABY Gıda LTD.ŞTİ. / İhracat 2 Cafe", 
              electric: { meter_no: "73261729", last_reading: 0 },
              water: { meter_no: "5832341", last_reading: 0 }
            },
            { id: "193", office_no: "20-6S", name: "ABY Gıda LTD.ŞTİ. / İhracat 3 Cafe", 
              electric: { meter_no: "62536647", last_reading: 0 },
              water: { meter_no: "6231862", last_reading: 0 }
            },
            { id: "194", office_no: "20-6V", name: "ABY Gıda LTD.ŞTİ. / İhracat 4 Tır Shop", 
              electric: { meter_no: "73261730", last_reading: 0 },
              water: { meter_no: "16328438", last_reading: 0 }
            },
            { id: "195", office_no: "Z-61", name: "Pilav Arabası /Z62", 
              electric: { meter_no: "39296873", last_reading: 0 },
              water: { meter_no: "6231784", last_reading: 0 }
            },
            { id: "196", office_no: "20-6H", name: "ABY Gıda LTD.ŞTİ. / İthalat 2 Cafe/Ofis", 
              electric: { meter_no: "73261779", last_reading: 0 },
              water: { meter_no: "398530", last_reading: 0 }
            },
            
            // Yük Dağıtım (YD) ve Sunucu Dağıtım (SD) Alanları
            
            // Fedex Express Türkiye - Tüm sayaçlar
            { id: "197", office_no: "YD1-1", name: "Fedex Express Türkiye Taş.TİC.LTD.ŞTİ.", 
              electric: { meter_no: "73136044", last_reading: 0 },
              water: { meter_no: "5173255", last_reading: 0 }
            },
            { id: "204", office_no: "YD1-2", name: "Fedex Express Türkiye Taş.TİC.LTD.ŞTİ.", 
              electric: { meter_no: "73135649", last_reading: 0 },
              water: { meter_no: "", last_reading: 0 }
            },
            { id: "205", office_no: "YD1-3", name: "Fedex Express Türkiye Taş.TİC.LTD.ŞTİ.", 
              electric: { meter_no: "73135960", last_reading: 0 },
              water: { meter_no: "", last_reading: 0 }
            },
            { id: "206", office_no: "YD1-4", name: "Fedex Express Türkiye Taş.TİC.LTD.ŞTİ.", 
              electric: { meter_no: "80072113", last_reading: 0 },
              water: { meter_no: "", last_reading: 0 }
            },
            { id: "207", office_no: "YD1-5", name: "Fedex Express Türkiye Taş.TİC.LTD.ŞTİ.", 
              electric: { meter_no: "73135417", last_reading: 0 },
              water: { meter_no: "", last_reading: 0 }
            },
            { id: "208", office_no: "YD1-6", name: "Fedex Express Türkiye Taş.TİC.LTD.ŞTİ.", 
              electric: { meter_no: "73135481", last_reading: 0 },
              water: { meter_no: "", last_reading: 0 }
            },
            { id: "209", office_no: "YD1-7", name: "Fedex Express Türkiye Taş.TİC.LTD.ŞTİ.", 
              electric: { meter_no: "80071866", last_reading: 0 },
              water: { meter_no: "", last_reading: 0 }
            },

            
            // Güçlü Global - Tüm sayaçlar
            { id: "198", office_no: "YD2-1", name: "Güçlü Global LTD.ŞTİ.", 
              electric: { meter_no: "80071801", last_reading: 0 },
              water: { meter_no: "9782907", last_reading: 0 }
            },
            { id: "211", office_no: "YD2-2", name: "Güçlü Global LTD.ŞTİ.", 
              electric: { meter_no: "73135966", last_reading: 0 },
              water: { meter_no: "", last_reading: 0 }
            },
            { id: "212", office_no: "YD2-3", name: "Güçlü Global LTD.ŞTİ.", 
              electric: { meter_no: "80071872", last_reading: 0 },
              water: { meter_no: "", last_reading: 0 }
            },
            { id: "213", office_no: "YD2-4", name: "Güçlü Global LTD.ŞTİ.", 
              electric: { meter_no: "73136012", last_reading: 0 },
              water: { meter_no: "", last_reading: 0 }
            },
            { id: "214", office_no: "YD2-5", name: "Güçlü Global LTD.ŞTİ.", 
              electric: { meter_no: "73136050", last_reading: 0 },
              water: { meter_no: "", last_reading: 0 }
            },
            
            // Mir Global Lojistik - Tüm sayaçlar
            { id: "199", office_no: "SD1-1", name: "Mir Global Lojistik TİC.LTD.ŞTİ.", 
              electric: { meter_no: "80034332", last_reading: 0 },
              water: { meter_no: "16326241", last_reading: 0 }
            },
            { id: "215", office_no: "SD1-2", name: "Mir Global Lojistik TİC.LTD.ŞTİ.", 
              electric: { meter_no: "80034043", last_reading: 0 },
              water: { meter_no: "", last_reading: 0 }
            },
            { id: "216", office_no: "SD1-3", name: "Mir Global Lojistik TİC.LTD.ŞTİ.", 
              electric: { meter_no: "80036312", last_reading: 0 },
              water: { meter_no: "", last_reading: 0 }
            },
            { id: "217", office_no: "SD1-4", name: "Mir Global Lojistik TİC.LTD.ŞTİ.", 
              electric: { meter_no: "80036139", last_reading: 0 },
              water: { meter_no: "", last_reading: 0 }
            },
            { id: "218", office_no: "SD1-5", name: "Mir Global Lojistik TİC.LTD.ŞTİ.", 
              electric: { meter_no: "800353425", last_reading: 0 },
              water: { meter_no: "", last_reading: 0 }
            },
            { id: "219", office_no: "SD1-6", name: "Mir Global Lojistik TİC.LTD.ŞTİ.", 
              electric: { meter_no: "80047978", last_reading: 0 },
              water: { meter_no: "", last_reading: 0 }
            },
            { id: "220", office_no: "SD1-7", name: "Mir Global Lojistik TİC.LTD.ŞTİ.", 
              electric: { meter_no: "80036076", last_reading: 0 },
              water: { meter_no: "", last_reading: 0 }
            },


            
            // SD2 Mir Global Lojistik
            { id: "200", office_no: "SD2-1", name: "Mir Global Lojistik TİC.LTD.ŞTİ.", 
              electric: { meter_no: "80034408", last_reading: 0 },
              water: { meter_no: "5173349", last_reading: 0 }
            },

            { id: "224", office_no: "SD2-3", name: "Mir Global Lojistik TİC.LTD.ŞTİ.", 
              electric: { meter_no: "80036034", last_reading: 0 },
              water: { meter_no: "", last_reading: 0 }
            },
            { id: "225", office_no: "SD2-4", name: "Mir Global Lojistik TİC.LTD.ŞTİ.", 
              electric: { meter_no: "80036228", last_reading: 0 },
              water: { meter_no: "", last_reading: 0 }
            },
            { id: "226", office_no: "SD2-5", name: "Mir Global Lojistik TİC.LTD.ŞTİ.", 
              electric: { meter_no: "80034356", last_reading: 0 },
              water: { meter_no: "", last_reading: 0 }
            },
            { id: "227", office_no: "SD2-6", name: "Mir Global Lojistik TİC.LTD.ŞTİ.", 
              electric: { meter_no: "80034397", last_reading: 0 },
              water: { meter_no: "", last_reading: 0 }
            },
            { id: "228", office_no: "SD2-7", name: "Mir Global Lojistik TİC.LTD.ŞTİ.", 
              electric: { meter_no: "80034389", last_reading: 0 },
              water: { meter_no: "", last_reading: 0 }
            },
            // MD1 Asav Lojistik
            { id: "201", office_no: "MD1-1", name: "Asav Loj. Hizmt. A.Ş.", 
              electric: { meter_no: "80032892", last_reading: 0 },
              water: { meter_no: "16326243", last_reading: 0 }
            },
            { id: "229", office_no: "MD1-2", name: "Asav Loj. Hizmt. A.Ş.", 
              electric: { meter_no: "80036025", last_reading: 0 },
              water: { meter_no: "", last_reading: 0 }
            },
            { id: "230", office_no: "MD1-3", name: "Asav Loj. Hizmt. A.Ş.", 
              electric: { meter_no: "80032830", last_reading: 0 },
              water: { meter_no: "", last_reading: 0 }
            },
            { id: "231", office_no: "MD1-4", name: "Asav Loj. Hizmt. A.Ş.", 
              electric: { meter_no: "80032844", last_reading: 0 },
              water: { meter_no: "", last_reading: 0 }
            },
            { id: "232", office_no: "MD1-5", name: "Asav Loj. Hizmt. A.Ş.", 
              electric: { meter_no: "80032396", last_reading: 0 },
              water: { meter_no: "", last_reading: 0 }
            },
            { id: "233", office_no: "MD1-6", name: "Asav Loj. Hizmt. A.Ş.", 
              electric: { meter_no: "80032907", last_reading: 0 },
              water: { meter_no: "", last_reading: 0 }
            },


            
            // MD2 Asav Lojistik
            { id: "202", office_no: "MD2-1", name: "Asav Loj. Hizmt. A.Ş.", 
              electric: { meter_no: "80031176", last_reading: 0 },
              water: { meter_no: "5173059", last_reading: 0 }
            },

            { id: "237", office_no: "MD2-3", name: "Asav Loj. Hizmt. A.Ş.", 
              electric: { meter_no: "80034074", last_reading: 0 },
              water: { meter_no: "", last_reading: 0 }
            },
            { id: "238", office_no: "MD2-4", name: "Asav Loj. Hizmt. A.Ş.", 
              electric: { meter_no: "80034075", last_reading: 0 },
              water: { meter_no: "", last_reading: 0 }
            },
            { id: "239", office_no: "MD2-5", name: "Asav Loj. Hizmt. A.Ş.", 
              electric: { meter_no: "80033844", last_reading: 0 },
              water: { meter_no: "", last_reading: 0 }
            },
            { id: "240", office_no: "MD2-6", name: "Asav Loj. Hizmt. A.Ş.", 
              electric: { meter_no: "80034072", last_reading: 0 },
              water: { meter_no: "", last_reading: 0 }
            },
            { id: "203", office_no: "ID", name: "Mir Global Lojistik TİC.LTD.ŞTİ.", 
              electric: { meter_no: "8003384", last_reading: 0 },
              water: { meter_no: "5173012", last_reading: 0 }
            }
        ];

        // Giriş modalını aç
        function openLoginModal() {
            document.getElementById('loginModal').style.display = 'flex';
        }
        
        // Giriş modalını kapat
        function closeLoginModal() {
            document.getElementById('loginModal').style.display = 'none';
            
            // Form alanlarını temizle
            const username = document.getElementById('username');
            const password = document.getElementById('password');
            const loginError = document.getElementById('loginError');
            
            if (username) username.value = '';
            if (password) password.value = '';
            if (loginError) loginError.textContent = '';
        }
        
        // Ana sayfa ve hakkımızda bölümleri arasında geçiş fonksiyonları
        function showAboutSection() {
            document.getElementById('heroSection').style.display = 'none';
            document.getElementById('aboutSection').style.display = 'flex';
        }
        
        function showHeroSection() {
            document.getElementById('aboutSection').style.display = 'none';
            document.getElementById('contactSection').style.display = 'none';
            document.getElementById('heroSection').style.display = 'flex';
        }
        
        // İletişim sayfasını göster
        function showContactSection() {
            document.getElementById('heroSection').style.display = 'none';
            document.getElementById('aboutSection').style.display = 'none';
            document.getElementById('contactSection').style.display = 'flex';
        }

        // Giriş işlemi
        function handleLogin() {
            const username = document.getElementById('username').value.trim();
            const password = document.getElementById('password').value.trim();
            const loginError = document.getElementById('loginError');
            
            if (!username || !password) {
                loginError.textContent = "Kullanıcı adı ve şifre gereklidir!";
                return;
            }
            
            const user = users.find(u => u.username === username && u.password === password);
            
            if (user) {
                // Başarılı giriş
                currentUser = user;
                
                // Kullanıcı bilgilerini ekranda göster
                document.getElementById('currentUsername').textContent = user.name;
                
                // Giriş modalını kapat
                closeLoginModal();
                
                if (user.role === 'admin') {
                    // Admin ise yönetici panelini göster
                    document.getElementById('adminUsername').textContent = user.name;
                    document.getElementById('homePage').style.display = 'none';
                    document.getElementById('appScreen').style.display = 'none';
                    document.getElementById('adminPanel').style.display = 'block';
                    
                    // Admin paneli için verileri hazırla
                    renderUserTable();
                    showAdminPanel('userPanel');
                } else {
                    // Normal kullanıcı ise ana paneli göster
                    document.getElementById('homePage').style.display = 'none';
                    document.getElementById('appScreen').style.display = 'block';
                    document.getElementById('adminPanel').style.display = 'none';
                    
                    // Ofisleri listele ve tarihi göster
                    renderOfficeList();
                    updateDate();
                    setInterval(updateDate, 60000); // Her dakika güncelle
                }
            } else {
                loginError.textContent = "Geçersiz kullanıcı adı veya şifre!";
            }
        }

        // Çıkış işlemi
        function handleLogout() {
            currentUser = null;
            
            // Ana sayfaya dön
            document.getElementById('homePage').style.display = 'block';
            document.getElementById('appScreen').style.display = 'none';
            document.getElementById('adminPanel').style.display = 'none';
        }

        // Mevcut tarihi göster
        function updateDate() {
            const currentDate = document.getElementById('currentDate');
            if (currentDate) {
                const now = new Date();
                const options = { 
                    year: 'numeric', 
                    month: 'long', 
                    day: 'numeric',
                    hour: '2-digit',
                    minute: '2-digit'
                };
                currentDate.textContent = now.toLocaleDateString('tr-TR', options);
            }
        }
        
        // Admin paneli için işlevler
        function showAdminPanel(panelId) {
            // Tüm panel içeriklerini gizle
            document.querySelectorAll('.admin-panel-content').forEach(panel => {
                panel.style.display = 'none';
            });
            
            // Tüm tab butonlarını pasif hale getir
            document.querySelectorAll('.office-item').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // Seçilen paneli göster
            document.getElementById(panelId).style.display = 'block';
            
            // Seçilen tab butonunu aktif hale getir
            document.querySelector(`.office-item[data-panel="${panelId}"]`).classList.add('active');
            
            // Panel içerikleri için verileri güncelle
            if (panelId === 'userPanel') {
                renderUserTable();
            } else if (panelId === 'officePanel') {
                renderOfficeTable();
            } else if (panelId === 'meterPanel') {
                renderMeterTable();
            } else if (panelId === 'statusPanel') {
                renderStatusTable();
            }
        }

        // Kullanıcı tablosunu oluştur
        function renderUserTable() {
            const userTableBody = document.getElementById('userTableBody');
            if (!userTableBody) return;
            
            userTableBody.innerHTML = '';
            
            users.forEach(user => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${user.username}</td>
                    <td>${user.name}</td>
                    <td>${user.role === 'admin' ? 'Yönetici' : 'Kullanıcı'}</td>
                    <td>
                        <button class="edit-btn" data-username="${user.username}">Düzenle</button>
                        <button class="delete-btn" data-username="${user.username}">Sil</button>
                    </td>
                `;
                userTableBody.appendChild(row);
            });
        }

        // Ofis tablosunu oluştur
        function renderOfficeTable() {
            const officeTableBody = document.getElementById('officeTableBody');
            if (!officeTableBody) return;
            
            officeTableBody.innerHTML = '';
            
            offices.forEach(office => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${office.office_no}</td>
                    <td>${office.name}</td>
                    <td>${office.electric ? office.electric.meter_no : '-'}</td>
                    <td>${office.water ? office.water.meter_no : '-'}</td>
                    <td>
                        <button class="edit-office-btn" data-id="${office.id}">Düzenle</button>
                    </td>
                `;
                officeTableBody.appendChild(row);
            });
        }

        // Sayaç tablosunu oluştur
        function renderMeterTable() {
            const meterTableBody = document.getElementById('meterTableBody');
            meterTableBody.innerHTML = '';
            
            let allMeters = [];
            
            offices.forEach(office => {
                // Elektrik sayaçı için
                if (office.electric && office.electric.meter_no) {
                    allMeters.push({
                        office_id: office.id,
                        office_no: office.office_no,
                        type: 'Elektrik',
                        meter_no: office.electric.meter_no,
                        value: office.electric.last_reading || 0,
                    });
                }
                
                // Su sayaçı için
                if (office.water && office.water.meter_no) {
                    allMeters.push({
                        office_id: office.id,
                        office_no: office.office_no,
                        type: 'Su',
                        meter_no: office.water.meter_no,
                        value: office.water.last_reading || 0,
                    });
                }
                
                // Doğalgaz sayaçı için
                if (office.gas && office.gas.meter_no) {
                    allMeters.push({
                        office_id: office.id,
                        office_no: office.office_no,
                        type: 'Doğalgaz',
                        meter_no: office.gas.meter_no,
                        value: office.gas.last_reading || 0,
                    });
                }
            });
            
            // Sayaçları listeleyerek tabloya ekle
            allMeters.forEach(meter => {
                const row = document.createElement('tr');
                
                row.innerHTML = `
                    <td>${meter.office_no}</td>
                    <td>${meter.type}</td>
                    <td>${meter.meter_no}</td>
                    <td>${meter.value}</td>
                    <td>
                        <button class="edit-meter-btn" data-id="${meter.office_id}" data-type="${meter.type.toLowerCase()}">Düzenle</button>
                    </td>
                `;
                
                meterTableBody.appendChild(row);
            });
        }
        
        // Ofis veri durumu tablosunu oluştur
        function renderStatusTable() {
            const statusTableBody = document.getElementById('statusTableBody');
            statusTableBody.innerHTML = '';
            
            offices.forEach(office => {
                // Sayac verisinin girilip girilmediğini kontrol et
                const hasElectricData = office.electric && office.electric.last_reading !== undefined && office.electric.last_reading > 0;
                const hasWaterData = office.water && office.water.last_reading !== undefined && office.water.last_reading > 0;
                const allDataEntered = hasElectricData && hasWaterData;
                
                // Veri giren kullanıcı bilgisi ve tarih
                const user = office.lastUpdatedBy || '-';
                const date = office.lastUpdatedDate ? new Date(office.lastUpdatedDate).toLocaleString('tr-TR') : '-';
                
                const block = office.office_no.includes('-') ? office.office_no.split('-')[0] : 'Diğer';
                
                const row = document.createElement('tr');
                row.className = allDataEntered ? 'status-success' : 'status-error';
                
                row.innerHTML = `
                    <td>${block}</td>
                    <td>${office.office_no}</td>
                    <td>${office.name}</td>
                    <td>${hasElectricData ? office.electric.last_reading : '-'}</td>
                    <td>${hasWaterData ? office.water.last_reading : '-'}</td>
                    <td>${user}</td>
                    <td>${date}</td>
                    <td>
                        <span class="status-indicator ${allDataEntered ? 'success' : 'error'}"></span>
                        ${allDataEntered ? 'Girildi' : 'Girilmedi'}
                    </td>
                `;
                
                statusTableBody.appendChild(row);
            });
        }
        
        // Ofis veri durumu arama fonksiyonu
        function searchStatusOffices(searchText) {
            const rows = document.querySelectorAll('#statusTableBody tr');
            searchText = searchText.toLowerCase();
            
            rows.forEach(row => {
                const officeNo = row.querySelector('td:nth-child(2)').textContent.toLowerCase();
                const officeName = row.querySelector('td:nth-child(3)').textContent.toLowerCase();
                const block = row.querySelector('td:nth-child(1)').textContent.toLowerCase();
                
                if (officeNo.includes(searchText) || officeName.includes(searchText) || block.includes(searchText)) {
                    row.style.display = '';
                } else {
                    row.style.display = 'none';
                }
            });
        }

        // Yeni kullanıcı modalını göster
        function showUserModal() {
            const modal = document.getElementById('addUserModal');
            if (modal) {
                modal.style.display = 'flex';
            }
        }
        
        // Yeni kullanıcı modalını gizle
        function hideUserModal() {
            const modal = document.getElementById('addUserModal');
            if (modal) {
                modal.style.display = 'none';
            }
            
            // Formu temizle
            document.getElementById('newUsername').value = '';
            document.getElementById('newFullName').value = '';
            document.getElementById('newPassword').value = '';
            document.getElementById('newRole').value = 'user';
        }
        
        // Yeni kullanıcı kaydet
        function saveNewUser() {
            const username = document.getElementById('newUsername').value.trim();
            const fullName = document.getElementById('newFullName').value.trim();
            const password = document.getElementById('newPassword').value.trim();
            const role = document.getElementById('newRole').value;
            
            if (!username || !fullName || !password) {
                alert('Tüm alanları doldurun!');
                return;
            }
            
            // Kullanıcı adı benzersiz olmalı
            if (users.some(u => u.username === username)) {
                alert('Bu kullanıcı adı zaten kullanılıyor!');
                return;
            }
            
            // Yeni kullanıcı ekle
            users.push({
                username: username,
                password: password,
                name: fullName,
                role: role
            });
            
            // Kullanıcı tablosunu güncelle
            renderUserTable();
            
            // Modalı kapat
            hideUserModal();
            
            alert('Kullanıcı başarıyla eklendi!');
        }
        
        // Kullanıcı düzenleme modalını göster
        function showEditUserModal(username) {
            const user = users.find(u => u.username === username);
            if (!user) return;
            
            // Modal elementlerini oluştur
            if (!document.getElementById('editUserModal')) {
                const modal = document.createElement('div');
                modal.id = 'editUserModal';
                modal.className = 'login-modal';
                modal.innerHTML = `
                    <div class="login-form">
                        <div class="login-header">
                            <h2>Kullanıcı Düzenle</h2>
                        </div>
                        <div class="form-group">
                            <label for="editUsername">Kullanıcı Adı:</label>
                            <input type="text" id="editUsername" readonly>
                        </div>
                        <div class="form-group">
                            <label for="editFullName">Ad Soyad:</label>
                            <input type="text" id="editFullName">
                        </div>
                        <div class="form-group">
                            <label for="editPassword">Yeni Şifre (boş bırakılırsa değişmez):</label>
                            <input type="password" id="editPassword" placeholder="Yeni şifre">
                        </div>
                        <div class="form-group">
                            <label for="editRole">Rol:</label>
                            <select id="editRole" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 4px;">
                                <option value="user">Kullanıcı</option>
                                <option value="admin">Yönetici</option>
                            </select>
                        </div>
                        <div class="form-actions">
                            <button id="updateUserBtn" class="login-button">Güncelle</button>
                            <button id="cancelEditUserBtn" class="close-button">İptal</button>
                        </div>
                    </div>
                `;
                document.body.appendChild(modal);
                
                // Butonlara event listener ekle
                document.getElementById('updateUserBtn').addEventListener('click', updateUser);
                document.getElementById('cancelEditUserBtn').addEventListener('click', hideEditUserModal);
                
                // Modal dışına tıklandığında kapat
                document.getElementById('editUserModal').addEventListener('click', function(e) {
                    if (e.target === this) {
                        hideEditUserModal();
                    }
                });
            }
            
            // Modal değerlerini doldur
            document.getElementById('editUsername').value = user.username;
            document.getElementById('editFullName').value = user.name;
            document.getElementById('editPassword').value = '';
            document.getElementById('editRole').value = user.role;
            
            // Modalı göster
            document.getElementById('editUserModal').style.display = 'flex';
        }
        
        // Kullanıcı düzenleme modalını gizle
        function hideEditUserModal() {
            document.getElementById('editUserModal').style.display = 'none';
        }
        
        // Kullanıcı bilgilerini güncelle
        function updateUser() {
            const username = document.getElementById('editUsername').value;
            const fullName = document.getElementById('editFullName').value.trim();
            const password = document.getElementById('editPassword').value.trim();
            const role = document.getElementById('editRole').value;
            
            if (!fullName) {
                alert('Ad Soyad alanı boş bırakılamaz!');
                return;
            }
            
            // Kullanıcıyı bul ve güncelle
            const user = users.find(u => u.username === username);
            if (user) {
                user.name = fullName;
                user.role = role;
                
                // Şifre girildiyse güncelle
                if (password) {
                    user.password = password;
                }
                
                // Tabloyu güncelle
                renderUserTable();
                
                // Modalı kapat
                hideEditUserModal();
                
                alert('Kullanıcı bilgileri güncellendi!');
            }
        }
        
        // Kullanıcı düzenle
        function editUser(username) {
            showEditUserModal(username);
        }
        
        // Kullanıcı sil
        function deleteUser(username) {
            // Kullanıcıyı silme işlemi
            if (confirm(`${username} kullanıcısını silmek istediğinize emin misiniz?`)) {
                const index = users.findIndex(u => u.username === username);
                if (index !== -1) {
                    users.splice(index, 1);
                    renderUserTable();
                    alert('Kullanıcı başarıyla silindi.');
                }
            }
        }
        
        // Ofis düzenle
        function editOffice(officeId) {
            // Ofis düzenleme formunu göster
            const office = offices.find(o => o.id === officeId);
            if (office) {
                document.getElementById('editOfficeNo').value = office.office_no;
                document.getElementById('editOfficeName').value = office.name;
                document.getElementById('editElectricMeterNo').value = office.electric ? office.electric.meter_no : '';
                document.getElementById('editWaterMeterNo').value = office.water ? office.water.meter_no : '';
                
                document.getElementById('officeEditForm').style.display = 'block';
                document.getElementById('saveOfficeBtn').setAttribute('data-id', officeId);
            }
        }
        
        // Ofis düzenleme formunu gizle
        function hideOfficeEditForm() {
            document.getElementById('officeEditForm').style.display = 'none';
        }
        
        // Ofis değişikliklerini kaydet
        function saveOfficeChanges(officeId) {
            const office = offices.find(o => o.id === officeId);
            if (office) {
                office.name = document.getElementById('editOfficeName').value.trim();
                
                if (office.electric) {
                    office.electric.meter_no = document.getElementById('editElectricMeterNo').value.trim();
                } else {
                    office.electric = { meter_no: document.getElementById('editElectricMeterNo').value.trim(), last_reading: 0 };
                }
                
                if (office.water) {
                    office.water.meter_no = document.getElementById('editWaterMeterNo').value.trim();
                } else {
                    office.water = { meter_no: document.getElementById('editWaterMeterNo').value.trim(), last_reading: 0 };
                }
                
                // Tabloları güncelle
                renderOfficeTable();
                renderMeterTable();
                
                // Formu gizle
                hideOfficeEditForm();
                
                alert('Ofis bilgileri güncellendi!');
            }
        }
        
        // Sayaç düzenleme modalını göster
        function showMeterEditModal(officeId, meterType) {
            const office = offices.find(o => o.id === officeId);
            if (!office) return;
            
            document.getElementById('editMeterOffice').value = `${office.office_no} - ${office.name}`;
            document.getElementById('editMeterType').value = meterType === 'electric' ? 'Elektrik' : 'Su';
            
            const meter = office[meterType];
            if (meter) {
                document.getElementById('editMeterNo').value = meter.meter_no;
                document.getElementById('editMeterReading').value = meter.last_reading;
            } else {
                document.getElementById('editMeterNo').value = '';
                document.getElementById('editMeterReading').value = '';
            }
            
            // Kaydetme butonuna ilgili verileri ekle
            const saveBtn = document.getElementById('saveMeterBtn');
            saveBtn.setAttribute('data-id', officeId);
            saveBtn.setAttribute('data-type', meterType);
            
            // Modalı göster
            document.getElementById('editMeterModal').style.display = 'flex';
        }
        
        // Sayaç düzenleme modalını gizle
        function hideMeterEditModal() {
            document.getElementById('editMeterModal').style.display = 'none';
        }
        
        // Sayaç değişikliklerini kaydet
        function saveMeterChanges(officeId, meterType) {
            const office = offices.find(o => o.id === officeId);
            if (!office) return;
            
            const meterNo = document.getElementById('editMeterNo').value.trim();
            const reading = parseInt(document.getElementById('editMeterReading').value.trim(), 10) || 0;
            
            if (!office[meterType]) {
                office[meterType] = {};
            }
            
            office[meterType].meter_no = meterNo;
            office[meterType].last_reading = reading;
            
            // Tabloları güncelle
            renderMeterTable();
            
            // Modalı kapat
            hideMeterEditModal();
            
            alert('Sayaç bilgileri güncellendi!');
        }

        // Ofisleri listele
        function renderOfficeList() {
            const officeListEl = document.getElementById('officeList');
            if (!officeListEl) return;
            
            officeListEl.innerHTML = '';
            
            // Ofisleri bölgelere göre grupla
            const officeGroups = {};
            
            offices.forEach(office => {
                const officePrefix = office.office_no.toString().split('-')[0] || 'Diğer';
                if (!officeGroups[officePrefix]) {
                    officeGroups[officePrefix] = [];
                }
                officeGroups[officePrefix].push(office);
            });
            
            // Her grup için bölüm oluştur
            Object.keys(officeGroups).sort().forEach(prefix => {
                // Grup başlığı ekle
                const groupHeader = document.createElement('div');
                groupHeader.style.fontWeight = 'bold';
                groupHeader.style.padding = '10px 5px';
                groupHeader.style.borderBottom = '1px solid #ddd';
                groupHeader.style.marginTop = '10px';
                groupHeader.textContent = prefix + (prefix.match(/[0-9]+[A-Z]+/) ? '' : ' Blok');
                groupHeader.dataset.group = prefix;
                officeListEl.appendChild(groupHeader);
                
                // Gruptaki ofisleri ekle
                officeGroups[prefix].sort((a, b) => {
                    // Ofis numaralarına göre sıralama
                    const parts1 = a.office_no.toString().split('-');
                    const parts2 = b.office_no.toString().split('-');
                    
                    if (parts1.length > 1 && parts2.length > 1) {
                        // İki ofis de X-Y formatında ise, Y'yi sayısal olarak sırala
                        const num1 = parseInt(parts1[1], 10) || 0;
                        const num2 = parseInt(parts2[1], 10) || 0;
                        return num1 - num2;
                    } else {
                        // Diğer durumlarda string olarak karşılaştır
                        return a.office_no.localeCompare(b.office_no, undefined, {numeric: true});
                    }
                }).forEach(office => {
                    const officeItem = document.createElement('div');
                    officeItem.className = 'office-item';
                    officeItem.setAttribute('data-id', office.id);
                    officeItem.setAttribute('data-name', office.name.toLowerCase());
                    officeItem.setAttribute('data-office-no', office.office_no.toString().toLowerCase());
                    officeItem.setAttribute('data-group', prefix);
                    officeItem.textContent = office.office_no + ' - ' + office.name;
                    officeItem.onclick = function() {
                        selectOffice(office);
                    };
                    officeListEl.appendChild(officeItem);
                });
            });
        }
        
        // Ofis arama fonksiyonu - Kullanıcı ara yüzündeki arama kutusu için
        function searchUserOffices(searchText) {
            const searchLower = searchText.toLowerCase();
            const officeItems = document.querySelectorAll('#officeList .office-item');
            const groupHeaders = document.querySelectorAll('#officeList [data-group]');
            
            // Önce tüm grup başlıklarını ve ofisleri gizle
            groupHeaders.forEach(header => {
                header.style.display = 'none';
            });
            
            officeItems.forEach(item => {
                item.style.display = 'none';
            });
            
            // Arama kriterine uyan ofisleri göster
            let visibleGroups = new Set();
            
            officeItems.forEach(item => {
                const officeName = item.getAttribute('data-name');
                const officeNo = item.getAttribute('data-office-no');
                const group = item.getAttribute('data-group');
                
                if (officeName.includes(searchLower) || officeNo.includes(searchLower)) {
                    item.style.display = 'block';
                    visibleGroups.add(group);
                }
            });
            
            // Görünür ofisi olan grup başlıklarını göster
            visibleGroups.forEach(group => {
                document.querySelector(`[data-group="${group}"]`).style.display = 'block';
            });
            
            // Arama metni boşsa hepsini göster
            if (!searchText) {
                groupHeaders.forEach(header => {
                    header.style.display = 'block';
                });
                
                officeItems.forEach(item => {
                    item.style.display = 'block';
                });
            }
        }
        
        // Admin arayüzündeki ofis arama
        function searchAdminOffices(searchText) {
            const searchLower = searchText.toLowerCase();
            const rows = document.querySelectorAll('#officeTableBody tr');
            
            rows.forEach(row => {
                const officeName = row.cells[1].textContent.toLowerCase();
                const officeNo = row.cells[0].textContent.toLowerCase();
                
                if (officeName.includes(searchLower) || officeNo.includes(searchLower)) {
                    row.style.display = '';
                } else {
                    row.style.display = 'none';
                }
            });
        }
        
        // Admin arayüzündeki sayaç arama
        function searchAdminMeters(searchText) {
            const searchLower = searchText.toLowerCase();
            const rows = document.querySelectorAll('#meterTableBody tr');
            
            rows.forEach(row => {
                const officeNo = row.cells[0].textContent.toLowerCase();
                const meterType = row.cells[1].textContent.toLowerCase();
                const meterNo = row.cells[2].textContent.toLowerCase();
                
                if (officeNo.includes(searchLower) || meterType.includes(searchLower) || meterNo.includes(searchLower)) {
                    row.style.display = '';
                } else {
                    row.style.display = 'none';
                }
            });
        }

        // Ofis seçimi
        function selectOffice(office) {
            // Aktif ofisi güncelle
            document.querySelectorAll('.office-item').forEach(item => item.classList.remove('active'));
            document.querySelector(`.office-item[data-id="${office.id}"]`).classList.add('active');

            // Form başlığını güncelle
            document.getElementById('officeName').textContent = office.office_no + ' - ' + office.name;
            
            // Form alanını göster
            document.getElementById('officeDetail').style.display = 'none';
            document.getElementById('meterForm').style.display = 'block';
            
            // Önceki değerleri yükle
            loadMeterValues(office.id);
            
            // Geçmiş kayıtları göster
            renderHistory(office.id);
        }

        // Sayaç değerlerini yükle
        function loadMeterValues(officeId) {
            const key = `office_${officeId}_latest`;
            const latestReading = JSON.parse(localStorage.getItem(key) || '{}');
            
            // Seçilen ofisi bul
            const selectedOffice = offices.find(office => office.id === officeId);
            
            if (selectedOffice) {
                // Sayaç numaralarını göster
                document.getElementById('electricMeterNo').value = selectedOffice.electric && selectedOffice.electric.meter_no || '';
                document.getElementById('waterMeterNo').value = selectedOffice.water && selectedOffice.water.meter_no || '';
                
                // Son kayıtlı değerleri veya ofisteki son değerleri göster
                document.getElementById('electricMeter').value = latestReading.electric || (selectedOffice.electric && selectedOffice.electric.last_reading) || '';
                document.getElementById('waterMeter').value = latestReading.water || (selectedOffice.water && selectedOffice.water.last_reading) || '';
                document.getElementById('gasMeter').value = latestReading.gas || '';
            }
        }

        // Sayaç değerlerini kaydet
        function saveMeterValues(officeId) {
            const office = offices.find(o => o.id === officeId);
            
            if (!office) return;
            
            const electricValue = parseInt(document.getElementById('electricMeter').value, 10) || 0;
            const waterValue = parseInt(document.getElementById('waterMeter').value, 10) || 0;
            const gasValue = parseInt(document.getElementById('gasMeter').value, 10) || 0;
            
            // Eski değerleri alıp geçmiş kayıtlara eklemek için
            const oldElectric = office.electric ? office.electric.last_reading : 0;
            const oldWater = office.water ? office.water.last_reading : 0;
            const oldGas = office.gas ? office.gas.last_reading : 0;
            
            // Geçmiş kaydı ekle
            if (!office.history) office.history = [];
            
            const history = {
                date: new Date(),
                user: currentUser.name,
                electric: oldElectric,
                water: oldWater,
                gas: oldGas,
                newElectric: electricValue,
                newWater: waterValue,
                newGas: gasValue
            };
            
            office.history.unshift(history);
            
            // Sayı sınırı
            if (office.history.length > 10) {
                office.history = office.history.slice(0, 10);
            }
            
            // Yeni değerleri kaydet
            if (office.electric) office.electric.last_reading = electricValue;
            if (office.water) office.water.last_reading = waterValue;
            if (!office.gas) office.gas = { meter_no: '', last_reading: 0 };
            office.gas.last_reading = gasValue;
            
            // Son güncelleme bilgilerini ekle
            office.lastUpdatedBy = currentUser.name;
            office.lastUpdatedDate = new Date();
            
            // Geçmiş tablosunu güncelle
            renderHistoryTable(office);
            
            // Ofis veri durumu güncelle
            renderStatusTable();
            
            // Bildirim göster
            const notification = document.getElementById('notification');
            notification.textContent = 'Sayaç değerleri başarıyla kaydedildi!';
            notification.style.opacity = '1';
            
            // 5 saniye sonra bildirimi kapat
            setTimeout(function() {
                notification.style.opacity = '0';
            }, 5000);
            
            // Sayaç tablosunu güncelle
            renderMeterTable();
        }
        
        // Ofis veri durumu arama fonksiyonu
        function searchStatusOffices(searchText) {
            const rows = document.querySelectorAll('#statusTableBody tr');
            searchText = searchText.toLowerCase();
            historyBodyEl.innerHTML = '';
            
            if (history.length === 0) {
                const row = document.createElement('tr');
                row.innerHTML = `<td colspan="4">Henüz kayıt bulunmamaktadır.</td>`;
                historyBodyEl.appendChild(row);
                return;
            }
            
            history.forEach(record => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${record.date} ${record.time}</td>
                    <td>${record.electric || '-'}</td>
                    <td>${record.water || '-'}</td>
                    <td>${record.gas || '-'}</td>
                `;
                historyBodyEl.appendChild(row);
            });
        }
        
        // Excel dosyasını yükle
        function importExcel() {
            document.getElementById('excelFileInput').click();
        }
        
        // Excel dosyasını işle
        function processExcelFile(file) {
            const reader = new FileReader();
            
            reader.onload = function(e) {
                const data = new Uint8Array(e.target.result);
                const workbook = XLSX.read(data, { type: 'array' });
                
                // İlk sayfa adını al
                const firstSheetName = workbook.SheetNames[0];
                const worksheet = workbook.Sheets[firstSheetName];
                
                // JSON'a dönüştür
                const jsonData = XLSX.utils.sheet_to_json(worksheet, {
                    header: 1,
                    defval: ""
                });
                
                if (jsonData && jsonData.length > 0) {
                    // Başlık satırını kontrol et ve sütun indekslerini belirle
                    const headers = jsonData[0].map(h => String(h).trim().toLowerCase());
                    
                    const officeNoIndex = headers.findIndex(h => h.includes('ofis') || h.includes('no'));
                    const nameIndex = headers.findIndex(h => h.includes('firma') || h.includes('adı'));
                    const electricNoIndex = headers.findIndex(h => h.includes('elektrik') && h.includes('no'));
                    const electricValueIndex = headers.findIndex(h => h.includes('elektrik') && h.includes('değer'));
                    const waterNoIndex = headers.findIndex(h => h.includes('su') && h.includes('no'));
                    const waterValueIndex = headers.findIndex(h => h.includes('su') && h.includes('değer'));
                    
                    // Ofis verilerini yeniden oluştur
                    const newOffices = [];
                    
                    // İlk satır başlık olduğu için 1. indeksten başla
                    for (let i = 1; i < jsonData.length; i++) {
                        const row = jsonData[i];
                        
                        // Boş satırları atla
                        if (!row[officeNoIndex] && !row[nameIndex]) continue;
                        
                        const officeNo = String(row[officeNoIndex] || "").trim();
                        const name = String(row[nameIndex] || "").trim() || "Boş";
                        
                        // Ofis numarası olmayan satırları atla
                        if (!officeNo) continue;
                        
                        // Yeni ofis objesi oluştur
                        const office = {
                            id: officeNo,
                            name: name,
                            office_no: officeNo,
                            electric: {
                                meter_no: String(row[electricNoIndex] || "").trim(),
                                last_reading: parseInt(row[electricValueIndex], 10) || 0
                            },
                            water: {
                                meter_no: String(row[waterNoIndex] || "").trim(),
                                last_reading: parseInt(row[waterValueIndex], 10) || 0
                            }
                        };
                        
                        newOffices.push(office);
                    }
                    
                    // Ofisleri temizle ve yenilerini ekle
                    offices = newOffices;
                    
                    // Tabloları güncelle
                    renderOfficeTable();
                    renderMeterTable();
                    renderOfficeList();
                    
                    alert('Excel dosyası başarıyla içe aktarıldı. ' + newOffices.length + ' adet ofis yüklendi.');
                } else {
                    alert('Excel dosyasından veri çıkarılamadı veya dosya boş.');
                }
            };
            
            reader.onerror = function() {
                alert('Dosya okuma hatası!');
            };
            
            reader.readAsArrayBuffer(file);
        }

        // Sayfa yüklendiğinde
        document.addEventListener('DOMContentLoaded', function() {
            // Ana Sayfa Giriş Butonu
            document.getElementById('heroLoginBtn').addEventListener('click', openLoginModal);
            
            // Navigasyon Butonları
            document.getElementById('homeLink').addEventListener('click', showHeroSection);
            document.getElementById('aboutLink').addEventListener('click', showAboutSection);
            document.getElementById('contactLink').addEventListener('click', showContactSection);
            document.getElementById('backToHomeBtn').addEventListener('click', showHeroSection);
            document.getElementById('backFromContactBtn').addEventListener('click', showHeroSection);
            
            // Giriş Modalı Butonları
            document.getElementById('submitLoginBtn').addEventListener('click', handleLogin);
            document.getElementById('closeLoginBtn').addEventListener('click', closeLoginModal);
            
            // Enter tuşu ile giriş
            document.getElementById('password').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    handleLogin();
                }
            });
            
            // Çıkış Butonları
            document.getElementById('logoutButton').addEventListener('click', handleLogout);
            document.getElementById('adminLogoutButton').addEventListener('click', handleLogout);
            
            // Kullanıcı arayüzü ofis arama kutusu
            document.getElementById('userOfficeSearch').addEventListener('input', function() {
                searchUserOffices(this.value.trim());
            });
            
            // Admin ofis arama kutusu
            document.getElementById('adminOfficeSearch').addEventListener('input', function() {
                searchAdminOffices(this.value.trim());
            });
            
            // Admin sayaç arama kutusu
            document.getElementById('adminMeterSearch').addEventListener('input', function() {
                searchAdminMeters(this.value.trim());
            });
            
            // Ofis veri durumu arama kutusu
            document.getElementById('statusOfficeSearch').addEventListener('input', function() {
                searchStatusOffices(this.value.trim());
            });
            
            // Admin panel sekme geçişleri için olay dinleyicileri
            document.querySelectorAll('.office-item').forEach(item => {
                item.addEventListener('click', function() {
                    const panelId = this.getAttribute('data-panel');
                    showAdminPanel(panelId);
                });
            });
            
            // Sayaç Kaydet Butonu
            document.getElementById('saveButton').addEventListener('click', function() {
                const activeOfficeItem = document.querySelector('.office-item.active');
                if (activeOfficeItem) {
                    const officeId = activeOfficeItem.getAttribute('data-id');
                    saveMeterValues(officeId);
                }
            });
            
            // Yeni Kullanıcı Ekleme İşlemleri
            document.getElementById('addUserBtn').addEventListener('click', showUserModal);
            document.getElementById('saveUserBtn').addEventListener('click', saveNewUser);
            document.getElementById('cancelUserBtn').addEventListener('click', hideUserModal);
            
            // Ofis Düzenleme Formu Butonları
            document.getElementById('cancelOfficeEditBtn').addEventListener('click', hideOfficeEditForm);
            document.getElementById('saveOfficeBtn').addEventListener('click', function() {
                const officeId = this.getAttribute('data-id');
                saveOfficeChanges(officeId);
            });
            
            // Sayaç Düzenleme Modalı Butonları
            document.getElementById('saveMeterBtn').addEventListener('click', function() {
                const officeId = this.getAttribute('data-id');
                const meterType = this.getAttribute('data-type');
                saveMeterChanges(officeId, meterType);
            });
            document.getElementById('cancelMeterBtn').addEventListener('click', hideMeterEditModal);
            
            // Excel içe aktarma butonları
            document.getElementById('importExcelBtn').addEventListener('click', importExcel);
            document.getElementById('excelFileInput').addEventListener('change', function(e) {
                if (e.target.files.length > 0) {
                    processExcelFile(e.target.files[0]);
                }
            });
            
            // Admin Paneli Tab Butonları
            document.querySelectorAll('[data-panel]').forEach(tab => {
                tab.addEventListener('click', function() {
                    const panelId = this.getAttribute('data-panel');
                    showAdminPanel(panelId);
                });
            });
            
            // Ana Sayfa ve Yönetici Paneli Linkleri
            document.getElementById('dashboardLink').addEventListener('click', function() {
                document.getElementById('appScreen').style.display = 'block';
                document.getElementById('adminPanel').style.display = 'none';
                renderOfficeList();
            });
            
            document.getElementById('adminLink').addEventListener('click', function() {
                document.getElementById('appScreen').style.display = 'none';
                document.getElementById('adminPanel').style.display = 'block';
                showAdminPanel('userPanel');
            });
            
            // Modal dışına tıklandığında kapat
            window.addEventListener('click', function(e) {
                if (e.target === document.getElementById('loginModal')) {
                    closeLoginModal();
                }
                if (e.target === document.getElementById('addUserModal')) {
                    hideUserModal();
                }
                if (e.target === document.getElementById('editMeterModal')) {
                    hideMeterEditModal();
                }
            });
            
            // Kullanıcı ve ofis ve sayaç tablodaki düzenle/sil butonları için olay dinleyicileri
            document.addEventListener('click', function(e) {
                if (e.target.classList.contains('edit-btn')) {
                    const username = e.target.getAttribute('data-username');
                    editUser(username);
                } else if (e.target.classList.contains('delete-btn')) {
                    const username = e.target.getAttribute('data-username');
                    deleteUser(username);
                } else if (e.target.classList.contains('edit-office-btn')) {
                    const officeId = e.target.getAttribute('data-id');
                    editOffice(officeId);
                } else if (e.target.classList.contains('edit-meter-btn')) {
                    const officeId = e.target.getAttribute('data-id');
                    const meterType = e.target.getAttribute('data-type');
                    showMeterEditModal(officeId, meterType);
                }
            });
        });
    </script>
    
    <!-- Footer -->
    <footer class="site-footer">
        <div class="footer-content">
            <div class="copyright">
                Copyright &copy; 2025 Gümrük ve Turizm İşletmeleri Ticaret A.Ş.
            </div>
            <div class="developer">
                Crafted by ADTech
            </div>
        </div>
    </footer>
    
</body>
</html>