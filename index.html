<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GTİ-Muratbey Ofis Sayaç ve Depo Takip Sistemi</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: Arial, sans-serif;
        }
        html, body {
            height: 100%;
        }
        body {
            background-color: #f5f5f5;
            color: #333;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            padding-bottom: 60px;
            position: relative;
        }
        .header {
            background-color: #1e2738;
            padding: 15px 50px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 2px 10px rgba(0,0,0,0.2);
            position: relative;
            z-index: 100;
        }
        .logo-container {
            display: flex;
            align-items: center;
        }
        .logo {
            height: 60px;
            width: auto;
            object-fit: contain;
            max-height: 100%;
            max-width: 200px;
            display: block;
        }
        .logo-text {
            color: white;
            margin-left: 15px;
            font-size: 16px;
            line-height: 1.3;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }
        .logo-text h1 {
            font-family: 'Poppins', sans-serif;
            font-weight: 600;
            font-size: 16px;
            letter-spacing: 0.5px;
            color: #ffffff;
            margin: 0;
            line-height: 1.2;
            text-transform: uppercase;
        }
        .nav-menu {
            display: flex;
            margin-left: auto;
        }
        .nav-item {
            color: white;
            padding: 10px 15px;
            font-size: 15px;
            cursor: pointer;
            text-decoration: none;
            transition: color 0.3s;
        }
        .nav-item:hover {
            color: #d42f2f;
        }
        .login-button {
            background-color: #d42f2f;
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            transition: background-color 0.3s;
        }
        .login-button:hover {
            background-color: #b91c1c;
        }
        .hero {
            height: calc(100vh - 75px);
            background-image: url('background.jpg');
            background-size: cover;
            background-position: center;
            position: relative;
            display: flex;
            align-items: center;
            color: white;
        }
        .hero-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(30, 39, 56, 0.6);
        }
        .hero-content {
            position: relative;
            z-index: 10;
            max-width: 600px;
            margin-left: 100px;
            padding: 30px;
            background-color: rgba(212, 47, 47, 0.85);
            border-radius: 5px;
        }
        .hero-content h1 {
            font-size: 36px;
            margin-bottom: 20px;
        }
        .hero-content p {
            font-size: 18px;
            margin-bottom: 25px;
            line-height: 1.6;
        }
        .hero-button {
            display: inline-block;
            background-color: white;
            color: #d42f2f;
            padding: 12px 24px;
            border: none;
            border-radius: 4px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: background-color 0.3s;
            text-decoration: none;
        }
        .hero-button:hover {
            background-color: #f0f0f0;
        }
        .login-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }
        .login-form {
            background-color: white;
            padding: 30px;
            border-radius: 5px;
            width: 400px;
            box-shadow: 0 0 20px rgba(0,0,0,0.2);
        }
        .login-header {
            display: flex;
            align-items: center;
            margin-bottom: 20px;
        }
        .login-header img {
            height: 40px;
            margin-right: 15px;
        }
        .login-header h2 {
            color: #1e2738;
            font-size: 22px;
        }
        .form-group {
            margin-bottom: 20px;
        }
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
            color: #333;
        }
        input[type="text"],
        input[type="password"],
        input[type="number"] {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 16px;
            transition: border 0.3s;
        }
        input:focus {
            border-color: #d42f2f;
            outline: none;
        }
        input[readonly] {
            background-color: #f5f5f5;
            color: #666;
        }
        .form-actions {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .error-message {
            color: #d42f2f;
            margin-top: 5px;
            font-size: 14px;
        }
        .close-button {
            background: none;
            border: none;
            color: #666;
            font-size: 14px;
            cursor: pointer;
            text-decoration: underline;
        }
        /* Uygulama Ekranı Stilleri */
        #appScreen {
            display: none;
        }
        .content {
            max-width: 1200px;
            margin: 30px auto;
            padding: 0 20px;
        }
        .main-container {
            display: flex;
            background-color: white;
            box-shadow: 0 0 20px rgba(0,0,0,0.1);
            border-radius: 5px;
            overflow: hidden;
        }
        .sidebar {
            width: 300px;
            background-color: #f2f2f2;
            padding: 20px;
            max-height: 700px;
            overflow-y: auto;
        }
        .sidebar h3 {
            color: #333;
            margin-bottom: 15px;
            font-size: 18px;
            border-bottom: 2px solid #d42f2f;
            padding-bottom: 10px;
        }
        .office-item {
            padding: 10px 15px;
            margin-bottom: 5px;
            background-color: #e9e9e9;
            border-radius: 4px;
            cursor: pointer;
            transition: all 0.2s;
            font-size: 14px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        .office-item:hover {
            background-color: #d9d9d9;
        }
        .office-item.active {
            background-color: #d42f2f;
            color: white;
        }
        .main-content {
            flex-grow: 1;
            padding: 25px;
        }
        .page-title {
            margin-bottom: 25px;
            color: #1e2738;
            font-size: 24px;
            border-bottom: 1px solid #eee;
            padding-bottom: 15px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .date-display {
            font-size: 14px;
            color: #666;
            font-weight: normal;
        }
        .notification {
            padding: 12px;
            background-color: #eaf7ea;
            color: #2e7d32;
            border-radius: 4px;
            margin-bottom: 20px;
            display: none;
            border-left: 4px solid #2e7d32;
            opacity: 0;
            transition: opacity 0.3s ease;
        }
        .history {
            margin-top: 40px;
        }
        .history h3 {
            margin-bottom: 15px;
            font-size: 18px;
            color: #1e2738;
            padding-bottom: 10px;
            border-bottom: 2px solid #d42f2f;
        }
        table {
            width: 100%;
            border-collapse: collapse;
        }
        th, td {
            padding: 12px 15px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }
        th {
            background-color: #f2f2f2;
            color: #333;
            font-weight: bold;
        }
        tr:hover {
            background-color: #f9f9f9;
        }
        .user-info {
            display: flex;
            justify-content: flex-end;
            margin-bottom: 20px;
            align-items: center;
        }
        .user-name {
            margin-right: 15px;
            color: #666;
        }
        .logout-button {
            background-color: transparent;
            color: #666;
            border: 1px solid #ddd;
            padding: 8px 15px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
        }
        .logout-button:hover {
            background-color: #f2f2f2;
        }
        .footer {
            background-color: #1e2738;
            color: rgba(255,255,255,0.7);
            padding: 20px 0;
            text-align: center;
            font-size: 14px;
            margin-top: 40px;
            position: fixed;
            bottom: 0;
            width: 100%;
            z-index: 10;
        }
        /* Mobil uyumluluk */
        @media (max-width: 768px) {
            .header {
                padding: 15px 20px;
                flex-wrap: wrap;
            }
            .nav-menu {
                margin-left: 0;
                margin-top: 15px;
                flex-wrap: wrap;
                order: 3;
                width: 100%;
            }
            .hero-content {
                margin-left: 20px;
                margin-right: 20px;
                padding: 20px;
            }
            .main-container {
                flex-direction: column;
            }
            .sidebar {
                width: 100%;
            }
        }
        /* Sayaç düzenleme modalı stilleri */
        #editMeterModal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }
        .search-box {
            width: 100%;
            padding: 10px 15px;
            margin-bottom: 15px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 14px;
        }
        .form-input {
            width: 100%;
            padding: 10px 15px;
            margin-bottom: 15px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 14px;
        }
        
        /* Hakkımızda Sayfa Stili */
        .hero-container {
            width: 100%;
            height: calc(100vh - 90px);
            flex: 1 0 auto;
        }
        .about-content-inline {
            background-color: rgba(255, 255, 255, 0.95);
            border-radius: 5px;
            width: 80%;
            max-width: 800px;
            margin: 0 auto;
            padding: 30px;
            position: relative;
            z-index: 10;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            color: #333;
            max-height: 80vh;
            overflow-y: auto;
        }
        .about-header-inline {
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid #d42f2f;
            position: relative;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .about-header-inline h1 {
            color: #1e2738;
            font-size: 24px;
            margin: 0;
        }
        .about-text-inline p {
            margin-bottom: 15px;
            line-height: 1.6;
            color: #333;
            text-align: justify;
        }
        .back-button {
            background-color: #1e2738;
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            transition: background-color 0.3s;
        }
        .back-button:hover {
            background-color: #15192a;
        }
        
        /* İletişim Sayfası Stilleri */
        .contact-container {
            display: flex;
            flex-wrap: wrap;
            gap: 30px;
            margin-top: 20px;
        }
        .action-buttons {
            display: flex;
            gap: 10px;
            margin-top: 15px;
        }
        .contact-info {
            flex: 1;
            min-width: 300px;
        }
        .map-container {
            flex: 1;
            min-width: 300px;
        }
        .contact-item {
            margin-bottom: 25px;
            display: flex;
            align-items: flex-start;
        }
        .contact-icon {
            background-color: #1e2738;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 15px;
            color: white;
            flex-shrink: 0;
        }
        .contact-details h3 {
            color: #1e2738;
            margin: 0 0 8px 0;
            font-size: 18px;
        }
        .contact-details p {
            margin: 0 0 5px 0;
            color: #555;
        }
        .contact-details a {
            color: #d42f2f;
            text-decoration: none;
        }
        .contact-details a:hover {
            text-decoration: underline;
        }
        .map-container h3 {
            color: #1e2738;
            margin-bottom: 15px;
            font-size: 18px;
        }
        .map-embed {
            border-radius: 5px;
            overflow: hidden;
            margin-bottom: 15px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        .map-link {
            display: inline-block;
            background-color: #1e2738;
            color: white;
            padding: 8px 15px;
            border-radius: 4px;
            text-decoration: none;
            transition: background-color 0.3s;
        }
        .map-link:hover {
            background-color: #15192a;
        }
        .location-icon::before { content: "\1F4CD"; }
        .phone-icon::before { content: "\260E"; }
        .email-icon::before { content: "\2709"; }
        .arrow-icon::before { content: "\2192"; }
        
        /* Footer Stili */
        .site-footer {
            background-color: #1e2738;
            color: rgba(255, 255, 255, 0.7);
            padding: 15px 50px;
            position: relative;
            width: 100%;
            flex-shrink: 0;
            bottom: 0;
        }
        .footer-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            max-width: 1200px;
            margin: 0 auto;
        }
        .copyright {
            font-size: 14px;
        }
        .developer {
            font-size: 14px;
            font-style: italic;
        }
        @media (max-width: 768px) {
            .site-footer {
                padding: 15px 20px;
            }
            .footer-content {
                flex-direction: column;
                text-align: center;
            }
            .copyright {
                margin-bottom: 5px;
            }
        }
        
        /* Hakkımızda Modal Stili */
        .about-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }
        .about-content {
            background-color: white;
            border-radius: 5px;
            width: 80%;
            max-width: 800px;
            max-height: 90vh;
            overflow-y: auto;
            padding: 30px;
            position: relative;
        }
        .about-header {
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid #d42f2f;
            position: relative;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .about-header h2 {
            color: #1e2738;
            font-size: 22px;
            margin: 0;
        }
        .about-stats {
            display: flex;
            justify-content: space-between;
            flex-wrap: wrap;
            margin-bottom: 30px;
        }
        .stat-box {
            background-color: #f5f5f5;
            border-radius: 5px;
            padding: 20px;
            text-align: center;
            width: 22%;
            margin-bottom: 15px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        .stat-number {
            font-size: 24px;
            font-weight: bold;
            color: #d42f2f;
            margin-bottom: 10px;
        }
        .stat-label {
            font-size: 14px;
            color: #666;
        }
        .about-text p {
            margin-bottom: 15px;
            line-height: 1.6;
            color: #333;
            text-align: justify;
        }
        .close-about {
            background: none;
            border: none;
            font-size: 24px;
            cursor: pointer;
            color: #666;
            position: absolute;
            top: 10px;
            right: 10px;
        }
        
        /* Ofis durum tablosu stilleri */
        .status-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 15px;
        }
        .status-table th, .status-table td {
            padding: 12px 15px;
            border-bottom: 1px solid #ddd;
            text-align: left;
        }
        .status-table th {
            background-color: #f8f8f8;
            font-weight: 600;
            color: #333;
        }
        .status-success {
            background-color: rgba(76, 175, 80, 0.1);
        }
        .status-error {
            background-color: rgba(244, 67, 54, 0.1);
        }
        .status-indicator {
            display: inline-block;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            margin-right: 8px;
            vertical-align: middle;
        }
        .status-indicator.success {
            background-color: #4CAF50;
        }
        .status-indicator.error {
            background-color: #F44336;
        }
        .edit-btn, .delete-btn, .edit-office-btn, .edit-meter-btn, .edit-product-btn, .view-movement-btn {
            background-color: #1e2738;
            color: white;
            border: none;
            padding: 5px 10px;
            border-radius: 3px;
            cursor: pointer;
            font-size: 12px;
            margin-right: 5px;
        }
        .edit-btn:hover, .delete-btn:hover, .edit-office-btn:hover, .edit-meter-btn:hover, .edit-product-btn:hover, .view-movement-btn:hover {
            background-color: #2a3447;
        }
        .delete-btn {
            background-color: #d42f2f;
        }
        .delete-btn:hover {
            background-color: #b91c1c;
        }
        
        /* Footer Stilleri */
        .footer {
            background-color: #1e2738;
            color: #fff;
            padding: 15px 0 10px;
            margin-top: 20px;
            font-size: 12px;
        }
        .footer-content {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            flex-wrap: wrap;
            justify-content: space-between;
            padding: 0 20px;
        }
        .footer-logo {
            flex: 1;
            min-width: 150px;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
        }
        .footer-logo img {
            height: 30px;
            margin-right: 10px;
        }
        .logo-text {
            display: flex;
            flex-direction: column;
            justify-content: center;
        }
        .site-title {
            margin: 0;
            font-size: 14px;
            font-weight: bold;
            color: #fff;
        }
        .site-subtitle {
            margin: 0;
            font-size: 10px;
            color: #ddd;
        }
        .footer-center {
            text-align: center;
            flex: 1;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .footer-center p {
            margin: 0;
            font-size: 12px;
            color: #ddd;
        }
        .footer-center a {
            color: #ddd;
            text-decoration: none;
            font-size: 12px;
            transition: color 0.3s;
        }
        .footer-center a:hover {
            color: #fff;
            text-decoration: underline;
        }
    </style>
</head>
<body>
    <!-- Ana Sayfa -->
    <div id="homePage">
        <!-- Üst Menü -->
        <header class="header">
            <div class="logo-container">
                <img src="gti-logo.svg" alt="GTİ Logo" class="logo">
                <div class="logo-text">
                    <h1 class="site-title">Muratbey</h1>
                    <p class="site-subtitle">Ofis Sayaç-Depo Envanter Takip Sistemi</p>
                </div>
            </div>
            <nav class="nav-menu">
                <a href="#" class="nav-item" id="homeLink" onclick="showHeroSection(event); return false;">Ana Sayfa</a>
                <a href="#" class="nav-item" id="aboutLink" onclick="showAboutSection(event); return false;">Hakkımızda</a>
                <a href="#" class="nav-item" id="contactLink" onclick="showContactSection(event); return false;">İletişim</a>
            </nav>
        </header>

        <!-- Ana İçerik Alanı -->
        <div class="hero-container">
            <!-- Hero Bölümü -->
            <div id="heroSection" class="hero">
                <div class="hero-overlay"></div>
                <div class="hero-content">
                    <h1>Ofis Sayaç-Depo Envanter Takip Sistemi</h1>
                    <p>GTİ'nin geliştirdiği bu platform, ofislerdeki elektrik, su ve doğalgaz sayaçlarının yanı sıra depo envanterlerinin de takibini kolaylaştırır. Tüm verilerinizi doğru ve güvenilir bir şekilde kayıt altına almanızı sağlayan entegre bir yönetim sistemidir.</p>
                    <button id="heroLoginBtn" class="hero-button" onclick="openLoginModal(); return false;">Sisteme Giriş Yap</button>
                </div>
            </div>
            
            <!-- Hakkımızda Bölümü -->
            <div id="aboutSection" class="hero" style="display: none;">
                <div class="hero-overlay"></div>
                <div class="about-content-inline">
                    <div class="about-header-inline">
                        <h1>Muratbey Gümrük Müdürlüğü Hakkında</h1>
                        <button id="backToHomeBtn" class="back-button" onclick="showHeroSection(event); return false;">Ana Sayfa'ya Dön</button>
                    </div>
                    <div class="about-stats">
                        <div class="stat-box">
                            <div class="stat-number">220.000 m²</div>
                            <div class="stat-label">Toplam Alan</div>
                        </div>
                        <div class="stat-box">
                            <div class="stat-number">56.472 m²</div>
                            <div class="stat-label">Kapalı Alan</div>
                        </div>
                        <div class="stat-box">
                            <div class="stat-number">0</div>
                            <div class="stat-label">Yolcu Kapasitesi</div>
                        </div>
                        <div class="stat-box">
                            <div class="stat-number">0</div>
                            <div class="stat-label">Taşıt Kapasitesi</div>
                        </div>
                    </div>
                    <div class="about-text-inline">
                        <p>Türkiye'nin dış ticaretinde önemli bir yere sahip olan, şehir içinde kaldığı için trafik akışını olumsuz etkileyen, fiziki koşullarının yetersizliği nedeniyle ihtiyaca cevap veremeyen, eski adıyla Halkalı Gümrük Müdürlüğü modernize edilerek İstanbul'un Çatalca bölgesine taşınmış ve Muratbey Gümrük Müdürlüğü olarak hizmete sunulmuştur.</p>
                        <p>Şehir trafiğine girmeden kolaylıkla erişilebilen Muratbey Gümrük Müdürlüğü, yeni yapılanmasıyla birlikte 220.000 m2 alan üzerine kurulmuş olup, 35.000 m² depo alanı, 4.150 m² ofis alanı ve 3.000 m²'lik sosyal hizmet alanı ile modern bir teknik altyapıya sahiptir.</p>
                        <p>GTİ tarafından son teknolojiyle donatılmış bu tesiste Gümrük Müdürlüğü'ne ait birimlerin yanı sıra, başta gümrük müşavirliği ve lojistik firmaları olmak üzere dış ticaret ile ilişkili kurum, kuruluş, meslek odaları ve sivil toplum temsilciliklerinin kullanımına sunulmuş 200'e yakın ofis bulunmaktadır.</p>
                        <p>Gümrük işlemleri ve lojistik hizmetler için giriş/çıkış yapan TIR şoförlerinin ihtiyaçları düşünülerek planlanlanan Muratbey Gümrük Müdürlüğü; kafe, restoran ve market gibi sosyal alanlarla birlikte ATM, berber, duş ve cami dahil olmak üzere her türlü hizmeti tek çatı altında toplayarak, modern ve teknolojik bir tesis olarak faaliyet göstermektedir.</p>
                    </div>
                </div>
            </div>
            
            <!-- İletişim Bölümü -->
            <div id="contactSection" class="hero" style="display: none;">
                <div class="hero-overlay"></div>
                <div class="about-content-inline">
                    <div class="about-header-inline">
                        <h1>İletişim Bilgileri</h1>
                        <button id="backFromContactBtn" class="back-button" onclick="showHeroSection(event); return false;">Ana Sayfa'ya Dön</button>
                    </div>
                    <div class="contact-container">
                        <div class="contact-info">
                            <div class="contact-item">
                                <div class="contact-icon"><i class="location-icon"></i></div>
                                <div class="contact-details">
                                    <h3>MURATBEY / İSTANBUL</h3>
                                    <p>Muratbey Gümrük Müdürlüğü Tesisleri, Muratbey – Çatalca / İstanbul</p>
                                </div>
                            </div>
                            <div class="contact-item">
                                <div class="contact-icon"><i class="phone-icon"></i></div>
                                <div class="contact-details">
                                    <h3>Telefon</h3>
                                    <p>0212 867 94 00</p>
                                    <p>0212 867 94 04</p>
                                    <p>+90 539 632 65 47</p>
                                </div>
                            </div>
                            <div class="contact-item">
                                <div class="contact-icon"><i class="email-icon"></i></div>
                                <div class="contact-details">
                                    <h3>E-posta</h3>
                                    <p><a href="mailto:halkali@gtias.com.tr">halkali@gtias.com.tr</a></p>
                                    <p><a href="mailto:adolen@gtias.com.tr">adolen@gtias.com.tr</a></p>
                                </div>
                            </div>
                        </div>
                        <div class="map-container">
                            <h3>Konum</h3>
                            <div class="map-embed">
                                <iframe src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3008.3940702935957!2d28.504767376303288!3d41.07955137932056!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x14caa418ffffffff%3A0x8537eb98b2380b34!2sMuratbey%20G%C3%BCmr%C3%BCk%20M%C3%BCd%C3%BCrl%C3%BC%C4%9F%C3%BC!5e0!3m2!1str!2str!4v1653380326054!5m2!1str!2str" width="100%" height="300" style="border:0;" allowfullscreen="" loading="lazy" referrerpolicy="no-referrer-when-downgrade"></iframe>
                            </div>
                            <p><a href="https://www.google.com.tr/maps/place/Muratbey+G%C3%BCmr%C3%BCk+M%C3%BCd%C3%BCrl%C3%BC%C4%9F%C3%BC/@41.0795514,28.5069621,17z/data=!3m1!4b1!4m6!3m5!1s0x14caa418ffffffff:0x8537eb98b2380b34!8m2!3d41.0795514!4d28.5069621!16s%2Fg%2F11bz_0w12h?hl=tr&entry=ttu&g_ep=EgoyMDI1MDUxNS4wIKXMDSoASAFQAw%3D%3D" target="_blank" class="map-link">Yol Tarifi Al <i class="arrow-icon"></i></a></p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Alt Bilgi (Footer) -->
        <footer class="footer">
            <div class="footer-content">
                <div class="footer-logo">
                    <img src="gti-logo.svg" alt="GTİ Logo">
                    <div class="logo-text">
                        <p class="site-title">Muratbey</p>
                        <p class="site-subtitle">Ofis Sayaç-Depo Envanter Takip Sistemi</p>
                    </div>
                </div>
                <div class="footer-center">
                    <p>&copy; 2025 GTİ - Tüm Hakları Saklıdır. | <a href="https://www.linkedin.com/in/ahmet-dolen/" target="_blank">Developed by ADTech</a></p>
                </div>
            </div>
        </footer>
    </div>

    <!-- Giriş Modal -->
    <div id="loginModal" class="login-modal">
        <div class="login-form">
            <div class="login-header">
                <img src="gti-logo.svg" alt="GTİ Logo" class="logo" style="height: 40px;">
                <h2>Yönetici Girişi</h2>
            </div>
            <div class="form-group">
                <label for="username">Kullanıcı Adı:</label>
                <input type="text" id="username" placeholder="Kullanıcı adınızı girin">
            </div>
            <div class="form-group">
                <label for="password">Şifre:</label>
                <input type="password" id="password" placeholder="Şifrenizi girin">
                <div id="loginError" class="error-message"></div>
            </div>
            <div class="form-actions">
                <button id="submitLoginBtn" class="login-button">Giriş Yap</button>
                <button id="closeLoginBtn" class="close-button">İptal</button>
            </div>
        </div>
    </div>

    <!-- Uygulama Ekranı (Teknik Personel İçin) -->
    <div id="appScreen">
        <!-- Üst Menü -->
        <header class="header">
            <div class="logo-container">
                <img src="gti-logo.svg" alt="GTİ Logo" class="logo">
                <div class="logo-text">
                    <h1>Ofis Sayaç Takip Sistemi</h1>
                </div>
            </div>
            <nav class="nav-menu">
                <a href="#" class="nav-item">Ana Sayfa</a>
                <a href="#" class="nav-item">Ofisler</a>
                <a href="#" class="nav-item">Yardım</a>
            </nav>
        </header>

        <!-- Ana İçerik -->
        <div class="content">
            <div class="user-info">
                <span class="user-name">Hoş geldiniz, <span id="currentUsername">Kullanıcı</span></span>
                <button id="logoutButton" class="logout-button">Çıkış Yap</button>
            </div>

            <div class="main-container">
                <!-- Sol Menü -->
                <div class="sidebar">
                    <h3>Ofisler</h3>
                    <input type="text" id="userOfficeSearch" class="search-box" placeholder="Ofis ara...">
                    <div id="officeList">
                        <!-- 100 NUMARALI OFİSLER (MERKEZ BİNA) -->
                    </div>
                </div>

                <!-- Sağ İçerik -->
                <div class="main-content">
                    <h1 class="page-title">
                        Sayaç Takip Sistemi
                        <span class="date-display" id="currentDate"></span>
                    </h1>
                    <div class="notification" id="notification">Sayaç değerleri başarıyla kaydedildi!</div>
                    
                    <div id="officeDetail">
                        <p>Lütfen sol taraftan bir ofis seçin.</p>
                    </div>
                    
                    <div id="meterForm" style="display: none;">
                        <h2 id="officeName" style="margin-bottom: 20px; color: #1e2738;"></h2>
                        <div class="form-group">
                            <label for="electricMeter">Elektrik Sayacı:</label>
                            <div style="display: flex; margin-bottom: 5px;">
                                <input type="number" id="electricMeterNo" placeholder="Elektrik sayaç numarası" style="flex: 1; margin-right: 10px;" readonly>
                                <input type="number" id="electricMeter" placeholder="Elektrik sayaç değerini girin" style="flex: 1;">
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="waterMeter">Su Sayacı:</label>
                            <div style="display: flex; margin-bottom: 5px;">
                                <input type="number" id="waterMeterNo" placeholder="Su sayaç numarası" style="flex: 1; margin-right: 10px;" readonly>
                                <input type="number" id="waterMeter" placeholder="Su sayaç değerini girin" style="flex: 1;">
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="gasMeter">Doğalgaz Sayacı:</label>
                            <input type="number" id="gasMeter" placeholder="Doğalgaz sayaç değerini girin">
                        </div>
                        <button id="saveButton" class="login-button">Kaydet</button>
                        
                        <div class="history">
                            <h3>Geçmiş Kayıtlar</h3>
                            <table id="historyTable">
                                <thead>
                                    <tr>
                                        <th>Tarih</th>
                                        <th>Elektrik (kWh)</th>
                                        <th>Su (m³)</th>
                                        <th>Doğalgaz (m³)</th>
                                    </tr>
                                </thead>
                                <tbody id="historyBody">
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Alt Bilgi -->
        <footer class="footer" style="position: fixed; bottom: 0; width: 100%;">
            <div class="footer-content" style="display: flex; justify-content: space-between; align-items: center; max-width: 1200px; margin: 0 auto;">
                <div class="copyright">
                    Copyright &copy; 2025 Gümrük ve Turizm İşletmeleri Ticaret A.Ş.
                </div>
                <div class="developer">
                    Crafted by ADTech
                </div>
            </div>
        </footer>
    </div>

    <!-- Admin Panel -->
    <div id="adminPanel" style="display: none;">
        <header class="header">
            <div class="logo-container">
                <img src="gti-logo.svg" alt="GTİ Logo" class="logo">
                <div class="logo-text">
                    <h1>Ofis Sayaç Takip Sistemi - Yönetim Paneli</h1>
                </div>
            </div>
            <nav class="nav-menu">
                <a href="#" class="nav-item" id="dashboardLink">Ana Sayfa</a>
                <a href="#" class="nav-item active" id="adminLink">Yönetici Paneli</a>
                <a href="#" class="nav-item">Yardım</a>
            </nav>
        </header>

        <div class="content">
            <div class="user-info">
                <span class="user-name">Hoş geldiniz, <span id="adminUsername">Yönetici</span></span>
                <button id="adminLogoutButton" class="logout-button">Çıkış Yap</button>
            </div>

            <div class="main-container">
                <div class="sidebar" style="width: 200px; max-height: 700px;">
                    <h3>İşlemler</h3>
                    <div>
                        <div class="office-item active" data-panel="userPanel">Kullanıcı Yönetimi</div>
                        <div class="office-item" data-panel="officePanel">Ofis Yönetimi</div>
                        <div class="office-item" data-panel="meterPanel">Sayaç Yönetimi</div>
                        <div class="office-item" data-panel="reportPanel">Raporlar</div>
                        <div class="office-item" data-panel="statusPanel">Ofis Veri Durumu</div>
                        <div class="office-item" data-panel="depoPanel">Depo Yönetimi</div>
                        <div class="office-item" data-panel="documentsPanel">Doküman Yönetimi</div>
                    </div>
                </div>

                <div class="main-content">
                    <!-- Kullanıcı Yönetimi Paneli -->
                    <div id="userPanel" class="admin-panel-content" style="background-color: white; position: relative; z-index: 10;">
                        <h1 class="page-title">Kullanıcı Yönetimi</h1>
                        
                        <div style="margin-bottom: 20px;">
                            <button id="addUserBtn" class="login-button" style="margin-right: 10px;">Yeni Kullanıcı Ekle</button>
                        </div>
                        
                        <table>
                            <thead>
                                <tr>
                                    <th>Kullanıcı Adı</th>
                                    <th>Ad Soyad</th>
                                    <th>Rol</th>
                                    <th>İşlemler</th>
                                </tr>
                            </thead>
                            <tbody id="userTableBody">
                                <!-- Kullanıcılar listelenecek -->
                            </tbody>
                        </table>
                    </div>
                    
                    <!-- Ofis Yönetimi Paneli -->
                    <div id="officePanel" class="admin-panel-content" style="display: none;">
                        <h1 class="page-title">Ofis Yönetimi</h1>
                        
                        <div class="search-container" style="margin-bottom: 20px;">
                            <input type="text" id="adminOfficeSearch" placeholder="Ofis ara..." style="padding: 10px; width: 300px;">
                        </div>
                        
                        <div id="officeEditForm" style="display: none; margin-top: 20px; padding: 20px; background-color: #f9f9f9; border-radius: 5px;">
                            <h3>Ofis Bilgileri Düzenle</h3>
                            <div class="form-group">
                                <label for="editOfficeNo">Ofis No:</label>
                                <input type="text" id="editOfficeNo" readonly>
                            </div>
                            <div class="form-group">
                                <label for="editOfficeName">Firma Adı:</label>
                                <input type="text" id="editOfficeName">
                            </div>
                            <div class="form-group">
                                <label for="editElectricMeterNo">Elektrik Sayaç No:</label>
                                <input type="text" id="editElectricMeterNo">
                            </div>
                            <div class="form-group">
                                <label for="editWaterMeterNo">Su Sayaç No:</label>
                                <input type="text" id="editWaterMeterNo">
                            </div>
                            <button id="saveOfficeBtn" class="login-button">Kaydet</button>
                            <button id="cancelOfficeEditBtn" class="close-button" style="margin-left: 10px;">İptal</button>
                        </div>
                        
                        <table>
                            <thead>
                                <tr>
                                    <th>Ofis No</th>
                                    <th>Firma Adı</th>
                                    <th>Elektrik Sayaç No</th>
                                    <th>Su Sayaç No</th>
                                    <th>İşlemler</th>
                                </tr>
                            </thead>
                            <tbody id="officeTableBody">
                                <!-- Ofisler listelenecek -->
                            </tbody>
                        </table>
                    </div>
                    
                    <!-- Sayaç Yönetimi Paneli -->
                    <div id="meterPanel" class="admin-panel-content" style="display: none;">
                        <h1 class="page-title">Sayaç Yönetimi</h1>
                        
                        <div class="search-container" style="margin-bottom: 20px;">
                            <input type="text" id="adminMeterSearch" placeholder="Sayaç ara..." style="padding: 10px; width: 300px;">
                        </div>
                        
                        <table>
                            <thead>
                                <tr>
                                    <th>Ofis No</th>
                                    <th>Sayaç Tipi</th>
                                    <th>Sayaç No</th>
                                    <th>Son Değer</th>
                                    <th>İşlemler</th>
                                </tr>
                            </thead>
                            <tbody id="meterTableBody">
                                <!-- Sayaçlar listelenecek -->
                            </tbody>
                        </table>
                    </div>
                    
                    <!-- Raporlar Paneli -->
                    <div id="reportPanel" class="admin-panel-content" style="display: none; background-color: white; position: relative; z-index: 10;">
                        <h1 class="page-title">Raporlar</h1>
                        
                        <div style="margin-bottom: 20px;">
                            <button id="exportAllToExcel" class="login-button">Tüm Ofis Kayıtlarını Excel'e Aktar</button>
                        </div>
                        
                        <div id="reportResult" class="result-container">
                            <p>Raporlarınız burada görüntülenecektir.</p>
                        </div>
                    </div>
                    
                    <!-- Doküman Yönetimi Paneli -->
                    <div id="documentsPanel" class="admin-panel-content" style="display: none; background-color: white; position: relative; z-index: 10;">
                        <h1 class="page-title">Doküman Yönetimi</h1>
                        
                        <div class="document-upload-section" style="margin-bottom: 30px; padding: 20px; background-color: #f9f9f9; border-radius: 5px;">
                            <h3>Yeni Doküman Yükle</h3>
                            <div style="display: flex; flex-wrap: wrap; gap: 15px; margin-top: 15px;">
                                <div style="flex: 1; min-width: 250px;">
                                    <label for="documentTitle" style="display: block; margin-bottom: 5px; font-weight: bold;">Doküman Başlığı:</label>
                                    <input type="text" id="documentTitle" placeholder="Doküman başlığını girin" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 4px;">
                                </div>
                                <div style="flex: 1; min-width: 250px;">
                                    <label for="documentCategory" style="display: block; margin-bottom: 5px; font-weight: bold;">Kategori:</label>
                                    <div style="display: flex; gap: 10px;">
                                        <select id="documentCategory" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 4px;">
                                            <option value="">Kategori Seçin</option>
                                            <option value="Talimatlar">Talimatlar</option>
                                            <option value="Faturalar">Faturalar</option>
                                            <option value="Sözleşmeler">Sözleşmeler</option>
                                            <option value="Raporlar">Raporlar</option>
                                            <option value="Diğer">Diğer</option>
                                        </select>
                                        <button id="addCategoryBtn" type="button" style="padding: 10px; background-color: #1e2738; color: white; border: none; border-radius: 4px; cursor: pointer;">
                                            <span>+</span>
                                        </button>
                                    </div>
                                </div>
                            </div>
                            <div style="margin-top: 15px;">
                                <label for="documentDescription" style="display: block; margin-bottom: 5px; font-weight: bold;">Açıklama:</label>
                                <textarea id="documentDescription" placeholder="Doküman hakkında açıklama girin" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 4px; resize: vertical;" rows="3"></textarea>
                            </div>
                            <div style="margin-top: 15px; display: flex; flex-wrap: wrap; gap: 15px;">
                                <div style="flex: 1; min-width: 250px;">
                                    <label for="documentFile" style="display: block; margin-bottom: 5px; font-weight: bold;">PDF Dosyası:</label>
                                    <input type="file" id="documentFile" accept=".pdf" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 4px;" multiple>
                                    <small style="display: block; margin-top: 5px; color: #666;">Toplu yükleme için birden fazla dosya seçebilirsiniz (CTRL tuşuna basarak)</small>
                                </div>
                                <div style="flex: 1; min-width: 250px; display: flex; align-items: flex-end;">
                                    <button id="uploadDocumentBtn" class="login-button" style="width: 100%; margin-top: 24px;">Dokümanı Yükle</button>
                                </div>
                            </div>
                        </div>

                        <div class="document-search-section" style="margin-bottom: 20px;">
                            <div style="display: flex; gap: 15px; flex-wrap: wrap;">
                                <div style="flex: 1;">
                                    <input type="text" id="documentSearch" placeholder="Doküman ara..." style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 4px;">
                                </div>
                                <div>
                                    <select id="categoryFilter" style="padding: 10px; border: 1px solid #ddd; border-radius: 4px;">
                                        <option value="">Tüm Kategoriler</option>
                                        <option value="Talimatlar">Talimatlar</option>
                                        <option value="Faturalar">Faturalar</option>
                                        <option value="Sözleşmeler">Sözleşmeler</option>
                                        <option value="Raporlar">Raporlar</option>
                                        <option value="Diğer">Diğer</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                        
                        <div class="documents-list">
                            <table style="width: 100%; border-collapse: collapse;">
                                <thead>
                                    <tr style="background-color: #1e2738; color: white;">
                                        <th style="padding: 12px; text-align: left;">Başlık</th>
                                        <th style="padding: 12px; text-align: left;">Kategori</th>
                                        <th style="padding: 12px; text-align: left;">Açıklama</th>
                                        <th style="padding: 12px; text-align: left;">Yüklenme Tarihi</th>
                                        <th style="padding: 12px; text-align: center;">İşlemler</th>
                                    </tr>
                                </thead>
                                <tbody id="documentsTableBody">
                                    <!-- Dokümanlar burada listelenecek -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                    
                    <!-- Ofis Veri Durumu Paneli -->
                    <div id="statusPanel" class="admin-panel-content" style="display: none;">
                        <h1 class="page-title">Ofis Veri Durumu</h1>
                        
                        <div class="search-container" style="margin-bottom: 20px;">
                            <input type="text" id="statusOfficeSearch" placeholder="Ofis ara..." style="padding: 10px; width: 300px;">
                        </div>
                        
                        <table class="status-table">
                            <thead>
                                <tr>
                                    <th>Blok</th>
                                    <th>Ofis No</th>
                                    <th>Firma Adı</th>
                                    <th>Elektrik Sayaç</th>
                                    <th>Su Sayaç</th>
                                    <th>Veri Giren</th>
                                    <th>Tarih</th>
                                    <th>Durum</th>
                                </tr>
                            </thead>
                            <tbody id="statusTableBody">
                                <!-- Ofis veri durumları listelenecek -->
                            </tbody>
                        </table>
                    </div>
                    
                    <!-- Depo Yönetimi Paneli -->
                    <div id="depoPanel" class="admin-panel-content" style="display: none;">
                        <h1 class="page-title">Depo Yönetimi</h1>
                        
                        <div style="margin-bottom: 20px; display: flex; justify-content: space-between;">
                            <div>
                                <button id="addProductBtn" class="login-button" style="margin-right: 10px;">Yeni Ürün Ekle</button>
                                <button id="bulkUploadBtn" class="login-button" style="margin-right: 10px; background-color: #28a745;">Toplu Ürün Yükle</button>
                                <select id="depoSelector" style="padding: 8px; border-radius: 4px; border: 1px solid #ddd;">
                                    <option value="all">Tüm Depolar</option>
                                    <option value="SARI OTOPARK 5 NOLU DEPO">SARI OTOPARK 5 NOLU DEPO</option>
                                    <option value="SARI OTOPARK PEYZAJ DEPOSU">SARI OTOPARK PEYZAJ DEPOSU</option>
                                    <option value="YEŞİL OTOPARK DEPO">YEŞİL OTOPARK DEPO</option>
                                    <option value="YAKIT DEPOSU">YAKIT DEPOSU</option>
                                    <option value="YEŞİL OTOPARK 5 NOLU DEPO">YEŞİL OTOPARK 5 NOLU DEPO</option>
                                    <option value="ZEMİN 30 OFİS">ZEMİN 30 OFİS</option>
                                    <option value="-1.KAT DEPO">-1.KAT DEPO</option>
                                    <option value="ZEMİN KAT DEPO">ZEMİN KAT DEPO</option>
                                    <option value="İŞLETME DEPO">İŞLETME DEPO</option>
                                    <option value="TEKNİK DEPO">TEKNİK DEPO</option>
                                </select>
                            </div>
                            <div>
                                <input type="text" id="productSearch" placeholder="Ürün ara..." style="padding: 8px; width: 200px; margin-right: 10px;">
                                <button id="exportInventoryBtn" class="login-button">Excel'e Aktar</button>
                            </div>
                        </div>
                        
                        <table>
                            <thead>
                                <tr>
                                    <th>Ürün Adı</th>
                                    <th>Miktar</th>
                                    <th>Birim</th>
                                    <th>Depo</th>
                                    <th>Açıklama</th>
                                    <th>Son Güncelleme</th>
                                    <th>İşlemler</th>
                                </tr>
                            </thead>
                            <tbody id="inventoryTableBody">
                                <!-- Envanter listelenecek -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Yeni Kullanıcı Ekleme Modal -->
    <div id="addUserModal" class="login-modal">
        <div class="login-form">
            <div class="login-header">
                <h2>Yeni Kullanıcı Ekle</h2>
            </div>
            <div class="form-group">
                <label for="newUsername">Kullanıcı Adı:</label>
                <input type="text" id="newUsername" placeholder="Kullanıcı adı girin">
            </div>
            <div class="form-group">
                <label for="newFullName">Ad Soyad:</label>
                <input type="text" id="newFullName" placeholder="Ad Soyad girin">
            </div>
            <div class="form-group">
                <label for="newPassword">Şifre:</label>
                <input type="password" id="newPassword" placeholder="Şifre girin">
            </div>
            <div class="form-group">
                <label for="newRole">Rol:</label>
                <select id="newRole" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 4px;">
                    <option value="teknik">Teknik Personel</option>
                    <option value="depo">Depo Personeli</option>
                    <option value="admin">Yönetici</option>
                </select>
            </div>
            <div class="form-actions">
                <button id="saveUserBtn" class="login-button">Kaydet</button>
                <button id="cancelUserBtn" class="close-button">İptal</button>
            </div>
        </div>
    </div>

    <!-- Kullanıcı Düzenleme Modal -->
    <div id="editUserModal" class="login-modal">
        <div class="login-form">
            <div class="login-header">
                <h2>Kullanıcı Düzenle</h2>
            </div>
            <div class="form-group">
                <label for="editUsername">Kullanıcı Adı:</label>
                <input type="text" id="editUsername" readonly>
            </div>
            <div class="form-group">
                <label for="editFullName">Ad Soyad:</label>
                <input type="text" id="editFullName" placeholder="Ad Soyad girin">
            </div>
            <div class="form-group">
                <label for="editPassword">Şifre:</label>
                <input type="password" id="editPassword" placeholder="Şifre girin">
                <small style="display: block; margin-top: 5px; color: #777;">Değiştirmek istemiyorsanız boş bırakın</small>
            </div>
            <div class="form-group">
                <label for="editRole">Rol:</label>
                <select id="editRole" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 4px;">
                    <option value="teknik">Teknik Personel</option>
                    <option value="depo">Depo Personeli</option>
                    <option value="admin">Yönetici</option>
                </select>
            </div>
            <div class="form-actions">
                <button id="updateUserBtn" class="login-button">Güncelle</button>
                <button id="cancelEditUserBtn" class="close-button">İptal</button>
            </div>
        </div>
    </div>

    <!-- Sayaç Düzenleme Modal -->
    <div id="editMeterModal" class="login-modal">
        <div class="login-form">
            <div class="login-header">
                <h2>Sayaç Düzenle</h2>
            </div>
            <div class="form-group">
                <label for="editMeterOffice">Ofis:</label>
                <input type="text" id="editMeterOffice" readonly>
            </div>
            <div class="form-group">
                <label for="editMeterType">Sayaç Tipi:</label>
                <input type="text" id="editMeterType" readonly>
            </div>
            <div class="form-group">
                <label for="editMeterNo">Sayaç No:</label>
                <input type="text" id="editMeterNo">
            </div>
            <div class="form-group">
                <label for="editMeterReading">Son Değer:</label>
                <input type="number" id="editMeterReading">
            </div>
            <div class="form-actions">
                <button id="saveMeterBtn" class="login-button">Kaydet</button>
                <button id="cancelMeterBtn" class="close-button">İptal</button>
            </div>
        </div>
    </div>

    <!-- Excel Yükleme Formu -->
    <input type="file" id="excelFileInput" accept=".xlsx,.xls" style="display: none;">

    <!-- Yeni Ürün Ekleme Modal -->
    <div id="addProductModal" class="login-modal">
        <div class="login-form">
            <div class="login-header">
                <h2>Yeni Ürün Ekle</h2>
            </div>
            <div class="form-group">
                <label for="newProductName">Ürün Adı:</label>
                <input type="text" id="newProductName" placeholder="Ürün adı girin">
            </div>
            <div class="form-group">
                <label for="newProductQuantity">Miktar:</label>
                <input type="number" id="newProductQuantity" min="0" placeholder="Miktar girin">
            </div>
            <div class="form-group">
                <label for="newProductUnit">Birim:</label>
                <select id="newProductUnit" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 4px;">
                    <option value="Adet">Adet</option>
                    <option value="Kg">Kg</option>
                    <option value="Litre">Litre</option>
                    <option value="Metre">Metre</option>
                    <option value="Paket">Paket</option>
                    <option value="Kutu">Kutu</option>
                </select>
            </div>
            <div class="form-group">
                <label for="newProductDepo">Depo:</label>
                <select id="newProductDepo" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 4px;">
                    <option value="SARI OTOPARK 5 NOLU DEPO">SARI OTOPARK 5 NOLU DEPO</option>
                    <option value="SARI OTOPARK PEYZAJ DEPOSU">SARI OTOPARK PEYZAJ DEPOSU</option>
                    <option value="YEŞİL OTOPARK DEPO">YEŞİL OTOPARK DEPO</option>
                    <option value="YAKIT DEPOSU">YAKIT DEPOSU</option>
                    <option value="YEŞİL OTOPARK 5 NOLU DEPO">YEŞİL OTOPARK 5 NOLU DEPO</option>
                    <option value="ZEMİN 30 OFİS">ZEMİN 30 OFİS</option>
                    <option value="-1.KAT DEPO">-1.KAT DEPO</option>
                    <option value="ZEMİN KAT DEPO">ZEMİN KAT DEPO</option>
                    <option value="İŞLETME DEPO">İŞLETME DEPO</option>
                    <option value="TEKNİK DEPO">TEKNİK DEPO</option>
                </select>
            </div>
            <div class="form-group">
                <label for="newProductDesc">Açıklama:</label>
                <textarea id="newProductDesc" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 4px; resize: vertical;" rows="3" placeholder="Açıklama girin"></textarea>
            </div>
            <div class="form-actions">
                <button id="saveProductBtn" class="login-button">Kaydet</button>
                <button id="cancelProductBtn" class="close-button">İptal</button>
            </div>
        </div>
    </div>

    <!-- Ürün Düzenleme Modal -->
    <div id="editProductModal" class="login-modal">
        <div class="login-form">
            <div class="login-header">
                <h2>Ürün Düzenle</h2>
            </div>
            <div class="form-group">
                <label for="editProductName">Ürün Adı:</label>
                <input type="text" id="editProductName">
                <input type="hidden" id="editProductId">
            </div>
            <div class="form-group">
                <label for="editProductQuantity">Miktar:</label>
                <input type="number" id="editProductQuantity" min="0">
            </div>
            <div class="form-group">
                <label for="editProductUnit">Birim:</label>
                <select id="editProductUnit" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 4px;">
                    <option value="Adet">Adet</option>
                    <option value="Kg">Kg</option>
                    <option value="Litre">Litre</option>
                    <option value="Metre">Metre</option>
                    <option value="Paket">Paket</option>
                    <option value="Kutu">Kutu</option>
                </select>
            </div>
            <div class="form-group">
                <label for="editProductDepo">Depo:</label>
                <select id="editProductDepo" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 4px;">
                    <option value="SARI OTOPARK 5 NOLU DEPO">SARI OTOPARK 5 NOLU DEPO</option>
                    <option value="SARI OTOPARK PEYZAJ DEPOSU">SARI OTOPARK PEYZAJ DEPOSU</option>
                    <option value="YEŞİL OTOPARK DEPO">YEŞİL OTOPARK DEPO</option>
                    <option value="YAKIT DEPOSU">YAKIT DEPOSU</option>
                    <option value="YEŞİL OTOPARK 5 NOLU DEPO">YEŞİL OTOPARK 5 NOLU DEPO</option>
                    <option value="ZEMİN 30 OFİS">ZEMİN 30 OFİS</option>
                    <option value="-1.KAT DEPO">-1.KAT DEPO</option>
                    <option value="ZEMİN KAT DEPO">ZEMİN KAT DEPO</option>
                    <option value="İŞLETME DEPO">İŞLETME DEPO</option>
                    <option value="TEKNİK DEPO">TEKNİK DEPO</option>
                </select>
            </div>
            <div class="form-group">
                <label for="editProductDesc">Açıklama:</label>
                <textarea id="editProductDesc" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 4px; resize: vertical;" rows="3"></textarea>
            </div>
            <div class="form-actions">
                <button id="updateProductBtn" class="login-button">Güncelle</button>
                <button id="cancelEditBtn" class="close-button">İptal</button>
            </div>
        </div>
    </div>

    <!-- Yeni Kategori Ekleme Modal -->
    <div id="newCategoryModal" class="login-modal">
        <div class="login-modal-content" style="max-width: 450px;">
            <span class="close-button" id="closeCategoryModal">&times;</span>
            <h2>Yeni Kategori Ekle</h2>
            <div class="form-group">
                <label for="newCategoryName" style="display: block; margin-bottom: 5px;">Kategori Adı:</label>
                <input type="text" id="newCategoryName" placeholder="Yeni kategori adı" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 4px;">
            </div>
            <div class="form-actions" style="margin-top: 20px;">
                <button id="saveCategoryBtn" class="login-button">Kategori Ekle</button>
                <button id="cancelCategoryBtn" class="close-button">Vazgeç</button>
            </div>
        </div>
    </div>
    
    <!-- Stok Hareketi Modal -->
    <div id="stockMovementModal" class="login-modal">
        <div class="login-form" style="width: 600px; max-width: 90%;">
            <div class="login-header">
                <h2>Stok Hareketleri</h2>
                <span id="movementProductName" style="font-weight: normal;"></span>
            </div>
            <table>
                <thead>
                    <tr>
                        <th>Tarih</th>
                        <th>Kullanıcı</th>
                        <th>İşlem</th>
                        <th>Önceki Miktar</th>
                        <th>Değişim</th>
                        <th>Yeni Miktar</th>
                    </tr>
                </thead>
                <tbody id="movementTableBody">
                    <!-- Stok hareketleri listelenecek -->
                </tbody>
            </table>
            <div class="form-actions" style="margin-top: 20px; justify-content: center;">
                <button id="closeMovementBtn" class="close-button">Kapat</button>
            </div>
        </div>
    </div>
    
    <!-- Toplu Ürün Yükleme Modal -->
    <div id="bulkUploadModal" class="login-modal">
        <div class="login-form" style="width: 600px;">
            <div class="login-header">
                <h2>Toplu Ürün Yükleme</h2>
            </div>
            <div class="form-group">
                <p style="margin-bottom: 15px; line-height: 1.5;">
                    Ürünleri toplu olarak yüklemek için Excel (.xlsx) veya CSV dosyası kullanabilirsiniz. Dosyanızın aşağıdaki sütunları içermesi gerekmektedir:
                </p>
                <div style="background-color: #f5f5f5; padding: 10px; border-radius: 4px; margin-bottom: 15px;">
                    <ul style="list-style-type: none; padding-left: 10px;">
                        <li><strong>Ürün Adı</strong> (zorunlu)</li>
                        <li><strong>Miktar</strong> (zorunlu)</li>
                        <li><strong>Birim</strong> (opsiyonel, varsayılan: Adet)</li>
                        <li><strong>Depo</strong> (opsiyonel, varsayılan: TEKNİK DEPO)</li>
                        <li><strong>Açıklama</strong> (opsiyonel)</li>
                    </ul>
                </div>
                <div style="margin-bottom: 20px;">
                    <a href="#" id="downloadTemplateBtn" style="color: #1e87f0; text-decoration: underline;">Şablon dosyasını indir</a>
                </div>
            </div>
            
            <div class="form-group">
                <label for="bulkUploadFile">Excel veya CSV Dosyası:</label>
                <input type="file" id="bulkUploadFile" accept=".xlsx,.xls,.csv" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 4px;">
            </div>
            
            <div id="uploadPreview" style="display: none; margin-top: 20px;">
                <h3>Yüklenecek Ürünler Önizlemesi</h3>
                <div style="max-height: 200px; overflow-y: auto; margin-bottom: 15px;">
                    <table style="width: 100%;">
                        <thead>
                            <tr>
                                <th>Ürün Adı</th>
                                <th>Miktar</th>
                                <th>Birim</th>
                                <th>Depo</th>
                            </tr>
                        </thead>
                        <tbody id="previewTableBody">
                            <!-- Önizleme verileri burada gösterilecek -->
                        </tbody>
                    </table>
                </div>
                <div style="font-weight: bold; margin-bottom: 10px;">
                    Toplam <span id="previewCount">0</span> ürün yüklenecek
                </div>
            </div>
            
            <div class="form-actions">
                <button id="processBulkUploadBtn" class="login-button">Yükle</button>
                <button id="cancelBulkUploadBtn" class="close-button">İptal</button>
            </div>
        </div>
    </div>

    <!-- Ana JavaScript kodu -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script>
        // Başlangıç değişkenleri
        let currentUser = null;
        let users = [];
        let offices = [];
        let inventory = [];

        // Kullanıcı verileri - localStorage'dan yüklenir veya varsayılan değerler kullanılır
        function initializeUsers() {
            // Önceden kaydedilmiş kullanıcıları localStorage'dan al
            const savedUsers = localStorage.getItem('users');
            
            if (savedUsers) {
                // Kaydedilmiş kullanıcılar varsa onları kullan
                users = JSON.parse(savedUsers);
            } else {
                // Kaydedilmiş kullanıcı yoksa varsayılan kullanıcıları oluştur
                users = [
                    { username: "admin", password: "admin123", name: "Admin Kullanıcı", role: "admin" },
                    { username: "teknik", password: "teknik123", name: "Teknik Personel", role: "teknik" },
                    { username: "depo", password: "depo123", name: "Depo Personeli", role: "depo" }
                ];
                
                // Varsayılan kullanıcıları localStorage'a kaydet
                localStorage.setItem('users', JSON.stringify(users));
            }
        }

        // Ofis verileri
        function initializeOffices() {
            offices = [
                // 1B Blok
                { id: "1", office_no: "1B-21", name: "Halit Demirkan", 
                  electric: { meter_no: "39296823", last_reading: 0 },
                  water: { meter_no: "5185306", last_reading: 0 },
                  history: []
                },
                { id: "2", office_no: "1B-20", name: "His Gümrük Müşavirliği LTD.ŞTİ.", 
                  electric: { meter_no: "39297205", last_reading: 0 },
                  water: { meter_no: "5185291", last_reading: 0 },
                  history: []
                },
                { id: "3", office_no: "1B-19", name: "", 
                  electric: { meter_no: "", last_reading: 0 },
                  water: { meter_no: "5185285", last_reading: 0 },
                  history: []
                },
                { id: "4", office_no: "1B-18", name: "Narin Gümrük Müşavirliği", 
                  electric: { meter_no: "39296915", last_reading: 0 },
                  water: { meter_no: "5185331", last_reading: 0 },
                  history: []
                },
                { id: "5", office_no: "1B-17", name: "OMN Gümrük Müşavirliği LTD.ŞTİ.", 
                  electric: { meter_no: "39296908", last_reading: 0 },
                  water: { meter_no: "", last_reading: 0 },
                  history: []
                },
                { id: "6", office_no: "1B-16", name: "Arion Gümrükleme LTD.ŞTİ.", 
                  electric: { meter_no: "39296836", last_reading: 0 },
                  water: { meter_no: "5185369", last_reading: 0 },
                  history: []
                },
                { id: "7", office_no: "1B-15", name: "DDP Gümrük Müşavirliği", 
                  electric: { meter_no: "39296267", last_reading: 0 },
                  water: { meter_no: "5185349", last_reading: 0 },
                  history: []
                },
                { id: "8", office_no: "1B-14", name: "Erben Gümrük Müşavirliği Ltd. Şti.", 
                  electric: { meter_no: "39297028", last_reading: 0 },
                  water: { meter_no: "5185342", last_reading: 0 },
                  history: []
                },
                { id: "9", office_no: "1B-13", name: "Anka Dia Gümrük Müşavirliği A.ş", 
                  electric: { meter_no: "39296753", last_reading: 0 },
                  water: { meter_no: "5185367", last_reading: 0 },
                  history: []
                },
                { id: "10", office_no: "1B-12", name: "İmer Gümrük Müşavirliği LTD.ŞTİ.", 
                  electric: { meter_no: "39297212", last_reading: 0 },
                  water: { meter_no: "5185280", last_reading: 0 },
                  history: []
                },
                { id: "11", office_no: "1B-11", name: "", 
                  electric: { meter_no: "39297070", last_reading: 0 },
                  water: { meter_no: "5185329", last_reading: 0 },
                  history: []
                },
                { id: "12", office_no: "1B-10", name: "İGT Gümrük Müş.LTD.ŞTİ.", 
                  electric: { meter_no: "39297011", last_reading: 0 },
                  water: { meter_no: "5185259", last_reading: 0 },
                  history: []
                },
                { id: "13", office_no: "1B-09", name: "Seçkin Gümrük Müşavirliği LTD.ŞTİ.", 
                  electric: { meter_no: "39297109", last_reading: 0 },
                  water: { meter_no: "5185366", last_reading: 0 },
                  history: []
                },
                { id: "14", office_no: "1B-08", name: "Peyiç Transport Dış Tic. LTD.ŞTİ. (TAH)", 
                  electric: { meter_no: "39296844", last_reading: 0 },
                  water: { meter_no: "5185252", last_reading: 0 },
                  history: []
                },
                { id: "15", office_no: "1B-07", name: "Hüseyin Bayram", 
                  electric: { meter_no: "39297168", last_reading: 0 },
                  water: { meter_no: "5185299", last_reading: 0 },
                  history: []
                },
                { id: "16", office_no: "1B-06", name: "Hizmet Gümrük Müşavirliği LTD.ŞTİ.", 
                  electric: { meter_no: "39297104", last_reading: 0 },
                  water: { meter_no: "5185394", last_reading: 0 },
                  history: []
                },
                { id: "17", office_no: "1B-05", name: "Tan Group Lojistik LTD.ŞTİ.", 
                  electric: { meter_no: "39297034", last_reading: 0 },
                  water: { meter_no: "16323436", last_reading: 0 },
                  history: []
                },
                { id: "18", office_no: "1B-04", name: "Barsan Global Lojistik A.Ş.", 
                  electric: { meter_no: "39296811", last_reading: 0 },
                  water: { meter_no: "16328443", last_reading: 0 },
                  history: []
                },
                { id: "19", office_no: "1B-03", name: "Evolog Nakliyat Loj.Hiz.Tic.Ltd.Şti.", 
                  electric: { meter_no: "39297172", last_reading: 0 },
                  water: { meter_no: "5185386", last_reading: 0 },
                  history: []
                },
                { id: "20", office_no: "1B-02", name: "Ünsped Gümrük Müşavirliği ve Loj. Hiz. A.Ş.", 
                  electric: { meter_no: "39297118", last_reading: 0 },
                  water: { meter_no: "1815964", last_reading: 0 },
                  history: []
                },
                { id: "21", office_no: "1B-01", name: "", 
                  electric: { meter_no: "39296999", last_reading: 0 },
                  water: { meter_no: "5185362", last_reading: 0 },
                  history: []
                },
                
                // 2B Blok
                { id: "22", office_no: "2B-24", name: "Sertrans Uluslararası Nakliyat Tic. A.Ş.", 
                  electric: { meter_no: "39296878", last_reading: 0 },
                  water: { meter_no: "5185271", last_reading: 0 },
                  history: []
                },
                { id: "23", office_no: "2B-23", name: "Güzel Lojistik/Ömer Güzel", 
                  electric: { meter_no: "39297020", last_reading: 0 },
                  water: { meter_no: "5185384", last_reading: 0 },
                  history: []
                },
                { id: "24", office_no: "2B-22", name: "", 
                  electric: { meter_no: "", last_reading: 0 },
                  water: { meter_no: "5185380", last_reading: 0 },
                  history: []
                },
                { id: "25", office_no: "2B-21", name: "Devnak Nakliyat Tur. İç ve Dış Tic. A.Ş.", 
                  electric: { meter_no: "39297181", last_reading: 0 },
                  water: { meter_no: "5185397", last_reading: 0 },
                  history: []
                },
                { id: "26", office_no: "2B-20", name: "Gelişim Ulus.Loj.Dış Tic.LTD.ŞTİ.", 
                  electric: { meter_no: "39297078", last_reading: 0 },
                  water: { meter_no: "5185368", last_reading: 0 },
                  history: []
                },
                { id: "27", office_no: "2B-19", name: "Ulus Gümrük Müşavirliği Ltd. Şti.", 
                  electric: { meter_no: "39297015", last_reading: 0 },
                  water: { meter_no: "5185260", last_reading: 0 },
                  history: []
                },
                { id: "28", office_no: "2B-18", name: "Ekol Gümrük Müşavirliği A.Ş.", 
                  electric: { meter_no: "39297052", last_reading: 0 },
                  water: { meter_no: "5185279", last_reading: 0 },
                  history: []
                },
                { id: "29", office_no: "2B-17", name: "", 
                  electric: { meter_no: "39297157", last_reading: 0 },
                  water: { meter_no: "5185437", last_reading: 0 },
                  history: []
                },
                { id: "30", office_no: "2B-16", name: "", 
                  electric: { meter_no: "39297152", last_reading: 0 },
                  water: { meter_no: "5185450", last_reading: 0 },
                  history: []
                },
                { id: "31", office_no: "2B-15", name: "Oğuz Gümrük Müşavirliği LTD.ŞTİ.", 
                  electric: { meter_no: "39296750", last_reading: 0 },
                  water: { meter_no: "5185287", last_reading: 0 },
                  history: []
                },
                { id: "32", office_no: "2B-14", name: "", 
                  electric: { meter_no: "", last_reading: 0 },
                  water: { meter_no: "5185387", last_reading: 0 },
                  history: []
                },
                { id: "33", office_no: "2B-13", name: "", 
                  electric: { meter_no: "39296802", last_reading: 0 },
                  water: { meter_no: "5185292", last_reading: 0 },
                  history: []
                },
                { id: "34", office_no: "2B-12", name: "", 
                  electric: { meter_no: "39297175", last_reading: 0 },
                  water: { meter_no: "5185390", last_reading: 0 },
                  history: []
                },
                { id: "35", office_no: "2B-11", name: "", 
                  electric: { meter_no: "", last_reading: 0 },
                  water: { meter_no: "5185284", last_reading: 0 },
                  history: []
                },
                { id: "36", office_no: "2B-10", name: "Magna Gümrük Müşavirliği Dış Tic.LTD.ŞTİ.", 
                  electric: { meter_no: "39297059", last_reading: 0 },
                  water: { meter_no: "5185393", last_reading: 0 },
                  history: []
                },
                { id: "37", office_no: "2B-09", name: "Mekar Gümrük Müşavirliği LTD.ŞTİ.", 
                  electric: { meter_no: "39297153", last_reading: 0 },
                  water: { meter_no: "5185413", last_reading: 0 },
                  history: []
                },
                { id: "38", office_no: "2B-08", name: "DCS Dijital Gümrük Hizmetleri A.Ş.", 
                  electric: { meter_no: "39296783", last_reading: 0 },
                  water: { meter_no: "8846564", last_reading: 0 },
                  history: []
                },
                { id: "39", office_no: "2B-07", name: "İstanbul Ticaret Odası", 
                  electric: { meter_no: "52636359", last_reading: 0 },
                  water: { meter_no: "5185268", last_reading: 0 },
                  history: []
                },
                
                // 3B Blok
                { id: "40", office_no: "3B-15", name: "TÜRK STANDARDLARI ENSTİTÜSÜ", 
                  electric: { meter_no: "39296840", last_reading: 0 },
                  water: { meter_no: "5185307", last_reading: 0 },
                  history: []
                },
                { id: "41", office_no: "3B-14", name: "TÜRK STANDARDLARI ENSTİTÜSÜ", 
                  electric: { meter_no: "39297169", last_reading: 0 },
                  water: { meter_no: "5185277", last_reading: 0 },
                  history: []
                },
                { id: "42", office_no: "3B-13", name: "TÜRK STANDARDLARI ENSTİTÜSÜ", 
                  electric: { meter_no: "39296792", last_reading: 0 },
                  water: { meter_no: "5185278", last_reading: 0 },
                  history: []
                },
                { id: "43", office_no: "3B-12", name: "TÜRK STANDARDLARI ENSTİTÜSÜ", 
                  electric: { meter_no: "39296831", last_reading: 0 },
                  water: { meter_no: "5185258", last_reading: 0 },
                  history: []
                },
                { id: "44", office_no: "3B-11", name: "TÜRK STANDARDLARI ENSTİTÜSÜ", 
                  electric: { meter_no: "39296998", last_reading: 0 },
                  water: { meter_no: "5185403", last_reading: 0 },
                  history: []
                },
                { id: "45", office_no: "3B-10", name: "TÜRK STANDARDLARI ENSTİTÜSÜ", 
                  electric: { meter_no: "39296856", last_reading: 0 },
                  water: { meter_no: "5185440", last_reading: 0 },
                  history: []
                },
                { id: "46", office_no: "3B-09", name: "TÜRK STANDARDLARI ENSTİTÜSÜ", 
                  electric: { meter_no: "39267079", last_reading: 0 },
                  water: { meter_no: "5185407", last_reading: 0 },
                  history: []
                },
                { id: "47", office_no: "3B-08", name: "TÜRK STANDARDLARI ENSTİTÜSÜ", 
                  electric: { meter_no: "39297062", last_reading: 0 },
                  water: { meter_no: "5185319", last_reading: 0 },
                  history: []
                },
                { id: "48", office_no: "3B-07", name: "TÜRK STANDARDLARI ENSTİTÜSÜ", 
                  electric: { meter_no: "39297102", last_reading: 0 },
                  water: { meter_no: "5185385", last_reading: 0 },
                  history: []
                },
                { id: "49", office_no: "3B-06", name: "TÜRK STANDARDLARI ENSTİTÜSÜ", 
                  electric: { meter_no: "39297185", last_reading: 0 },
                  water: { meter_no: "5185345", last_reading: 0 },
                  history: []
                },
                { id: "50", office_no: "3B-05", name: "TÜRK STANDARDLARI ENSTİTÜSÜ", 
                  electric: { meter_no: "39297149", last_reading: 0 },
                  water: { meter_no: "5185320", last_reading: 0 },
                  history: []
                },
                { id: "51", office_no: "3B-04", name: "TÜRK STANDARDLARI ENSTİTÜSÜ", 
                  electric: { meter_no: "39297204", last_reading: 0 },
                  water: { meter_no: "8846455", last_reading: 0 },
                  history: []
                },
                { id: "52", office_no: "3B-02", name: "DMS Marketçilik A.Ş.", 
                  electric: { meter_no: "73262830", last_reading: 0 },
                  water: { meter_no: "1815963", last_reading: 0 },
                  history: []
                },
                { id: "53", office_no: "3B-01", name: "Tülay TAŞ/Yemekhane", 
                  electric: { meter_no: "73261635", last_reading: 0 },
                  water: { meter_no: "2365633", last_reading: 0 },
                  history: []
                },
                
                // Z Blok
                { id: "54", office_no: "Z-63", name: "Nova Grup Müşavirlik LTD.ŞTİ.", 
                  electric: { meter_no: "39297154", last_reading: 0 },
                  water: { meter_no: "5185406", last_reading: 0 },
                  history: []
                },
                { id: "55", office_no: "Z-62", name: "Star Nakliyat/Aydın Aktimur", 
                  electric: { meter_no: "39297190", last_reading: 0 },
                  water: { meter_no: "5185334", last_reading: 0 },
                  history: []
                },
                { id: "56", office_no: "Z-61", name: "Çağberk Loj. Paz. İç ve Dış Tic. A.ş.", 
                  electric: { meter_no: "39296873", last_reading: 0 },
                  water: { meter_no: "5185317", last_reading: 0 },
                  history: []
                },
                { id: "57", office_no: "Z-60", name: "Emir Gümrük Müşavirliği LTD.ŞTİ.", 
                  electric: { meter_no: "39297055", last_reading: 0 },
                  water: { meter_no: "5185327", last_reading: 0 },
                  history: []
                },
                { id: "58", office_no: "Z-59", name: "HGL Gümrük Müş. LTD.ŞTİ.", 
                  electric: { meter_no: "39297206", last_reading: 0 },
                  water: { meter_no: "5185439", last_reading: 0 },
                  history: []
                },
                { id: "59", office_no: "Z-58", name: "", 
                  electric: { meter_no: "", last_reading: 0 },
                  water: { meter_no: "5185293", last_reading: 0 },
                  history: []
                },
                { id: "60", office_no: "Z-57", name: "Asav Loj. Hizmt. A.Ş.", 
                  electric: { meter_no: "39296997", last_reading: 0 },
                  water: { meter_no: "5185296", last_reading: 0 },
                  history: []
                },
                { id: "61", office_no: "Z-56", name: "Nehir Gümrükleme İç Dış Tic.LTD.ŞTİ.", 
                  electric: { meter_no: "39297008", last_reading: 0 },
                  water: { meter_no: "5185324", last_reading: 0 },
                  history: []
                },
                { id: "62", office_no: "Z-55", name: "Volkan Gümrükleme/Ayla Altuncu Baştımar", 
                  electric: { meter_no: "39296777", last_reading: 0 },
                  water: { meter_no: "5185305", last_reading: 0 },
                  history: []
                },
                { id: "63", office_no: "Z-54", name: "Tunaset Gümrük Müşavirliği", 
                  electric: { meter_no: "39296884", last_reading: 0 },
                  water: { meter_no: "5185310", last_reading: 0 },
                  history: []
                },
                { id: "64", office_no: "Z-53", name: "", 
                  electric: { meter_no: "", last_reading: 0 },
                  water: { meter_no: "5185373", last_reading: 0 },
                  history: []
                },
                { id: "65", office_no: "Z-52", name: "Erkal Ulus.Nak.Tic.LTD.ŞTİ.", 
                  electric: { meter_no: "39297103", last_reading: 0 },
                  water: { meter_no: "5185363", last_reading: 0 },
                  history: []
                },
                { id: "66", office_no: "Z-51", name: "Karem Gümrük Müşavirliği LTD.ŞTİ.", 
                  electric: { meter_no: "39297126", last_reading: 0 },
                  water: { meter_no: "5185404", last_reading: 0 },
                  history: []
                },
                { id: "67", office_no: "Z-50", name: "", 
                  electric: { meter_no: "", last_reading: 0 },
                  water: { meter_no: "5185370", last_reading: 0 },
                  history: []
                },
                { id: "68", office_no: "Z-49", name: "Küresel Gümrük Müş. Ve Loj. Hiz. A.Ş.", 
                  electric: { meter_no: "39297013", last_reading: 0 },
                  water: { meter_no: "5185383", last_reading: 0 },
                  history: []
                },
                { id: "69", office_no: "Z-48", name: "", 
                  electric: { meter_no: "39139415", last_reading: 0 },
                  water: { meter_no: "5185340", last_reading: 0 },
                  history: []
                },
                { id: "70", office_no: "Z-47", name: "Mainland Loj.Depolama Hizmt.LTD.ŞTİ.", 
                  electric: { meter_no: "39296791", last_reading: 0 },
                  water: { meter_no: "5185257", last_reading: 0 },
                  history: []
                },
                { id: "71", office_no: "Z-46", name: "Transalkım Ulus.Nak.Tic.LTD.ŞTİ.", 
                  electric: { meter_no: "3929704", last_reading: 0 },
                  water: { meter_no: "5185355", last_reading: 0 },
                  history: []
                },
                { id: "72", office_no: "Z-45", name: "", 
                  electric: { meter_no: "", last_reading: 0 },
                  water: { meter_no: "5185443", last_reading: 0 },
                  history: []
                },
                { id: "73", office_no: "Z-44", name: "Day Gümrük Müşavirliği A.Ş.", 
                  electric: { meter_no: "39297139", last_reading: 0 },
                  water: { meter_no: "5185375", last_reading: 0 },
                  history: []
                },
                { id: "74", office_no: "Z-43", name: "Data Gümrük Müşavirliği LTD.ŞTİ.", 
                  electric: { meter_no: "39297120", last_reading: 0 },
                  water: { meter_no: "5185417", last_reading: 0 },
                  history: []
                },
                { id: "75", office_no: "Z-42", name: "", 
                  electric: { meter_no: "", last_reading: 0 },
                  water: { meter_no: "", last_reading: 0 },
                  history: []
                },
                { id: "76", office_no: "Z-41", name: "Subaşı Gümrük Müşavirliği LTD.ŞTİ.", 
                  electric: { meter_no: "39296778", last_reading: 0 },
                  water: { meter_no: "5185311", last_reading: 0 },
                  history: []
                },
                { id: "77", office_no: "Z-40", name: "DMR Gümrük Müşavirliği LTD.ŞTİ.", 
                  electric: { meter_no: "39296958", last_reading: 0 },
                  water: { meter_no: "5185358", last_reading: 0 },
                  history: []
                },
                { id: "78", office_no: "Z-39", name: "Ömtur Loj.Dış Tic.", 
                  electric: { meter_no: "39297009", last_reading: 0 },
                  water: { meter_no: "5185313", last_reading: 0 },
                  history: []
                },
                { id: "79", office_no: "Z-38", name: "G.S.G. Gümrük Müşavirliği LTD.ŞTİ.", 
                  electric: { meter_no: "39297142", last_reading: 0 },
                  water: { meter_no: "5185270", last_reading: 0 },
                  history: []
                },
                { id: "80", office_no: "Z-37", name: "Haldun Karakoyun", 
                  electric: { meter_no: "39297171", last_reading: 0 },
                  water: { meter_no: "5185326", last_reading: 0 },
                  history: []
                },
                { id: "81", office_no: "Z-36", name: "Emirler Loj.Güm.Acent.Hiz.Tic.LTD.ŞTİ.", 
                  electric: { meter_no: "39296912", last_reading: 0 },
                  water: { meter_no: "", last_reading: 0 },
                  history: []
                },
                { id: "82", office_no: "Z-35", name: "Netist Dış Tic. A.Ş.", 
                  electric: { meter_no: "39296808", last_reading: 0 },
                  water: { meter_no: "5185298", last_reading: 0 },
                  history: []
                },
                { id: "83", office_no: "Z-34", name: "Solmaz Küresel Gümrük Müşavirliği A.Ş.", 
                  electric: { meter_no: "39297032", last_reading: 0 },
                  water: { meter_no: "5185427", last_reading: 0 },
                  history: []
                },
                { id: "84", office_no: "Z-33", name: "Solmaz Küresel Gümrük Müşavirliği A.Ş.", 
                  electric: { meter_no: "39297148", last_reading: 0 },
                  water: { meter_no: "5185303", last_reading: 0 },
                  history: []
                },
                { id: "85", office_no: "Z-32", name: "Trasant Ulus.Nak.Dış Tic.LTD.ŞTİ.", 
                  electric: { meter_no: "39296830", last_reading: 0 },
                  water: { meter_no: "5185275", last_reading: 0 },
                  history: []
                },
                { id: "86", office_no: "Z-31", name: "", 
                  electric: { meter_no: "39297106", last_reading: 0 },
                  water: { meter_no: "8846528", last_reading: 0 },
                  history: []
                },
                { id: "87", office_no: "Z-30", name: "", 
                  electric: { meter_no: "", last_reading: 0 },
                  water: { meter_no: "", last_reading: 0 },
                  history: []
                },
                { id: "88", office_no: "Z-29", name: "Öykü Gümrük Müşavirliği LTD.ŞTİ.", 
                  electric: { meter_no: "39297081", last_reading: 0 },
                  water: { meter_no: "5185318", last_reading: 0 },
                  history: []
                },
                { id: "89", office_no: "Z-28", name: "Link Denizcilik ve Taş.LTD.ŞTİ.", 
                  electric: { meter_no: "39297203", last_reading: 0 },
                  water: { meter_no: "5185304", last_reading: 0 },
                  history: []
                },
                { id: "90", office_no: "Z-27", name: "Güçlü Uluslararası Nak. Turz.San.Dış Tic.LTD.ŞTİ.", 
                  electric: { meter_no: "39296901", last_reading: 0 },
                  water: { meter_no: "5185304", last_reading: 0 },
                  history: []
                },
                { id: "91", office_no: "Z-26", name: "Ateşer Lojistik LTD.ŞTİ.", 
                  electric: { meter_no: "39297030", last_reading: 0 },
                  water: { meter_no: "5185441", last_reading: 0 },
                  history: []
                },
                { id: "92", office_no: "Z-25", name: "Duray Gümrükleme Ulus. Nak. Tic.LTD.ŞTİ.", 
                  electric: { meter_no: "39296940", last_reading: 0 },
                  water: { meter_no: "5185336", last_reading: 0 },
                  history: []
                },
                { id: "93", office_no: "Z-24", name: "Bultrans Ulus.Loj. Tic.LTD.ŞTİ.", 
                  electric: { meter_no: "39297053", last_reading: 0 },
                  water: { meter_no: "5185325", last_reading: 0 },
                  history: []
                },
                { id: "94", office_no: "Z-23", name: "Pozitif Gümrük Müşavirlik Hizmetleri LTD.ŞTİ.", 
                  electric: { meter_no: "39296935", last_reading: 0 },
                  water: { meter_no: "5185272", last_reading: 0 },
                  history: []
                },
                { id: "95", office_no: "Z-22", name: "Boykan Gümrük Müş.Loj. A.Ş.", 
                  electric: { meter_no: "39297119", last_reading: 0 },
                  water: { meter_no: "5185425", last_reading: 0 },
                  history: []
                },
                { id: "96", office_no: "Z-21", name: "Palamutlar Group Lojistik Dış Tic.LTD.ŞTİ.", 
                  electric: { meter_no: "39297201", last_reading: 0 },
                  water: { meter_no: "5185283", last_reading: 0 },
                  history: []
                },
                { id: "97", office_no: "Z-20", name: "Güçlü Uluslararası Nak. Turz.San.Dış Tic.LTD.ŞTİ.", 
                  electric: { meter_no: "39297187", last_reading: 0 },
                  water: { meter_no: "5155344", last_reading: 0 },
                  history: []
                },
                { id: "98", office_no: "Z-19", name: "Asy Gümrük Müşavirliği A.Ş.", 
                  electric: { meter_no: "39297015", last_reading: 0 },
                  water: { meter_no: "5185260", last_reading: 0 },
                  history: []
                },
                { id: "99", office_no: "Z-18", name: "Transmetro Gümrük Müşavirliği Tic.LTD.ŞTİ.", 
                  electric: { meter_no: "39297092", last_reading: 0 },
                  water: { meter_no: "5185323", last_reading: 0 },
                  history: []
                },
                { id: "100", office_no: "Z-17", name: "Tuaz Lojistik Gümrükleme LTD.ŞTİ.", 
                  electric: { meter_no: "39297115", last_reading: 0 },
                  water: { meter_no: "5185290", last_reading: 0 },
                  history: []
                },
                { id: "101", office_no: "Z-16", name: "Egemen Nakliyat San.Tic.LTD.ŞTİ.", 
                  electric: { meter_no: "39296824", last_reading: 0 },
                  water: { meter_no: "5185354", last_reading: 0 },
                  history: []
                },
                { id: "102", office_no: "Z-15", name: "Mentor Gümrük Müşavirliği LTD.ŞTİ.", 
                  electric: { meter_no: "39296849", last_reading: 0 },
                  water: { meter_no: "5185269", last_reading: 0 },
                  history: []
                },
                { id: "103", office_no: "Z-14", name: "İmex Taşımacılık San.Dış.Tic.LTD.ŞTİ.", 
                  electric: { meter_no: "39296959", last_reading: 0 },
                  water: { meter_no: "5185387", last_reading: 0 },
                  history: []
                },
                { id: "104", office_no: "Z-13", name: "Cem Trans/Murat AKÇA", 
                  electric: { meter_no: "39296757", last_reading: 0 },
                  water: { meter_no: "5185416", last_reading: 0 },
                  history: []
                },
                { id: "105", office_no: "Z-12", name: "E-Batı Gümrük Müşavirlik Hizmetleri LTD.ŞTİ.", 
                  electric: { meter_no: "39296867", last_reading: 0 },
                  water: { meter_no: "5185448", last_reading: 0 },
                  history: []
                },
                { id: "106", office_no: "Z-11", name: "Peyiç Transport Dış Tic.LTD.ŞTİ.", 
                  electric: { meter_no: "39296761", last_reading: 0 },
                  water: { meter_no: "5185389", last_reading: 0 },
                  history: []
                },
                { id: "107", office_no: "Z-10", name: "Bizz Trans Ulus.Nak./Aşkın Muammer Tekin", 
                  electric: { meter_no: "39297068", last_reading: 0 },
                  water: { meter_no: "5185409", last_reading: 0 },
                  history: []
                },
                { id: "108", office_no: "Z-09", name: "Turnak Gümrük Müşavirliği LTD.ŞTİ.", 
                  electric: { meter_no: "39296764", last_reading: 0 },
                  water: { meter_no: "5185337", last_reading: 0 },
                  history: []
                },
                { id: "109", office_no: "Z-08", name: "Sır Gümrük Müşavirli LTD.ŞTİ.", 
                  electric: { meter_no: "39297176", last_reading: 0 },
                  water: { meter_no: "5185321", last_reading: 0 },
                  history: []
                },
                { id: "110", office_no: "Z-07", name: "Oskar Gümrük Müşavirliği LTD.ŞTİ.", 
                  electric: { meter_no: "39296784", last_reading: 0 },
                  water: { meter_no: "5185261", last_reading: 0 },
                  history: []
                },
                { id: "111", office_no: "Z-06", name: "Boğaziçi Gümrük Müşavirliği A.Ş.", 
                  electric: { meter_no: "39297202", last_reading: 0 },
                  water: { meter_no: "5185408", last_reading: 0 },
                  history: []
                },
                { id: "112", office_no: "Z-05", name: "Tepe Gümrük Müşavirliği", 
                  electric: { meter_no: "39297150", last_reading: 0 },
                  water: { meter_no: "5185266", last_reading: 0 },
                  history: []
                },
                { id: "113", office_no: "Z-04", name: "Datalog Ulus.Taş İth.İhr.Dış Tic.LTD.ŞTİ.", 
                  electric: { meter_no: "39297122", last_reading: 0 },
                  water: { meter_no: "5185386", last_reading: 0 },
                  history: []
                },
                { id: "114", office_no: "Z-03", name: "Sienzi Loj. Antrepo Dış Tic.LTD.ŞTİ.", 
                  electric: { meter_no: "39297129", last_reading: 0 },
                  water: { meter_no: "5185365", last_reading: 0 },
                  history: []
                },
                { id: "115", office_no: "Z-02", name: "Doğruer Gümrük Müşavirliği LTD.ŞTİ.", 
                  electric: { meter_no: "39297022", last_reading: 0 },
                  water: { meter_no: "5185426", last_reading: 0 },
                  history: []
                },
                { id: "116", office_no: "Z-01", name: "Deks Tekstil İth.İhr.Turz.LTD.ŞTİ.", 
                  electric: { meter_no: "39296962", last_reading: 0 },
                  water: { meter_no: "5185446", last_reading: 0 },
                  history: []
                },
                
                // 100 NUMARALI OFİSLER (MERKEZ BİNA)
                { id: "117", office_no: "101", name: "Hüner Ulus.Taş.LTD.ŞTİ.", 
                  electric: { meter_no: "39297099", last_reading: 0 },
                  water: { meter_no: "5185267", last_reading: 0 },
                  history: []
                },
                { id: "118", office_no: "102", name: "Kızılkaya Gümrük Müşavirliği LTD.ŞTİ.", 
                  electric: { meter_no: "39297010", last_reading: 0 },
                  water: { meter_no: "5185335", last_reading: 0 },
                  history: []
                },
                { id: "119", office_no: "103", name: "Tezer Gümrük Müşavirliği", 
                  electric: { meter_no: "39297097", last_reading: 0 },
                  water: { meter_no: "5185374", last_reading: 0 },
                  history: []
                },
                { id: "120", office_no: "104", name: "Mettrans Taşımacılık ve Tic.LTD.ŞTİ.", 
                  electric: { meter_no: "39296766", last_reading: 0 },
                  water: { meter_no: "5185442", last_reading: 0 },
                  history: []
                },
                { id: "121", office_no: "105", name: "Ulustrans Ulus. Nak.Tic. A.Ş.", 
                  electric: { meter_no: "39297165", last_reading: 0 },
                  water: { meter_no: "5185392", last_reading: 0 },
                  history: []
                },
                { id: "122", office_no: "106", name: "Elt Global Loj. Ve Dış Ticaret A.Ş.", 
                  electric: { meter_no: "39297088", last_reading: 0 },
                  water: { meter_no: "5185378", last_reading: 0 },
                  history: []
                },
                { id: "123", office_no: "107", name: "Okuyan Gümrük Müşavirliği LTD.ŞTİ.", 
                  electric: { meter_no: "39297107", last_reading: 0 },
                  water: { meter_no: "5185410", last_reading: 0 },
                  history: []
                },
                { id: "124", office_no: "108", name: "Sentez Gümrük Müşavirliği LTD.ŞTİ.", 
                  electric: { meter_no: "39297057", last_reading: 0 },
                  water: { meter_no: "5185420", last_reading: 0 },
                  history: []
                },
                { id: "125", office_no: "109", name: "Bunasta Gümrük Transit Hiz.İth.İhr.Tic.A.Ş.", 
                  electric: { meter_no: "39297208", last_reading: 0 },
                  water: { meter_no: "5185364", last_reading: 0 },
                  history: []
                },
                { id: "126", office_no: "110", name: "İST Global Gümrük Müşavirliği", 
                  electric: { meter_no: "39297039", last_reading: 0 },
                  water: { meter_no: "5185276", last_reading: 0 },
                  history: []
                },
                { id: "127", office_no: "111", name: "Borusan Tedarik Zinciri. Çöz.ve Tek. A.Ş.", 
                  electric: { meter_no: "39297089", last_reading: 0 },
                  water: { meter_no: "5185339", last_reading: 0 },
                  history: []
                },
                { id: "128", office_no: "112", name: "Asset Gümrük Müşavirliği LTD.ŞTİ.", 
                  electric: { meter_no: "39296817", last_reading: 0 },
                  water: { meter_no: "5185309", last_reading: 0 },
                  history: []
                },
                { id: "129", office_no: "113", name: "BD Global Loj.Turz.San.Dış Tic.LTD.ŞTİ.", 
                  electric: { meter_no: "39297188", last_reading: 0 },
                  water: { meter_no: "5185289", last_reading: 0 },
                  history: []
                },
                { id: "130", office_no: "114", name: "Oben Gümrük Müşavirliği LTD.ŞTİ.", 
                  electric: { meter_no: "39297128", last_reading: 0 },
                  water: { meter_no: "5185429", last_reading: 0 },
                  history: []
                },
                { id: "131", office_no: "115", name: "Yıldız Gümrük Acent.Danışmanlık Hiz.LTD.ŞTİ.", 
                  electric: { meter_no: "39297193", last_reading: 0 },
                  water: { meter_no: "5185398", last_reading: 0 },
                  history: []
                },
                { id: "132", office_no: "116", name: "", 
                  electric: { meter_no: "39297074", last_reading: 0 },
                  water: { meter_no: "5185302", last_reading: 0 },
                  history: []
                },
                { id: "133", office_no: "117", name: "Boğa Ulus.Taş.Dış Tic.LTD.ŞTİ.", 
                  electric: { meter_no: "39297182", last_reading: 0 },
                  water: { meter_no: "5185405", last_reading: 0 },
                  history: []
                },
                { id: "134", office_no: "118", name: "HB Nakliyat Gümrükleme Sinan Atay", 
                  electric: { meter_no: "39297125", last_reading: 0 },
                  water: { meter_no: "5185343", last_reading: 0 },
                  history: []
                },
                { id: "135", office_no: "119", name: "Karaca Gümrük Müşavirliği A.Ş.", 
                  electric: { meter_no: "39296790", last_reading: 0 },
                  water: { meter_no: "5185379", last_reading: 0 },
                  history: []
                },
                { id: "136", office_no: "120", name: "Bor Gümrük Müşavirliği A.Ş.", 
                  electric: { meter_no: "39296991", last_reading: 0 },
                  water: { meter_no: "4975390", last_reading: 0 },
                  history: []
                },
                { id: "137", office_no: "121", name: "Güler Gümrük Müşavirliği A.Ş.", 
                  electric: { meter_no: "39296805", last_reading: 0 },
                  water: { meter_no: "5185308", last_reading: 0 },
                  history: []
                },
                { id: "138", office_no: "122", name: "Aslan Global Gümrük Müşavirliği A.Ş.", 
                  electric: { meter_no: "39297058", last_reading: 0 },
                  water: { meter_no: "5185428", last_reading: 0 },
                  history: []
                },
                { id: "139", office_no: "123", name: "Hitit Gümrük Müşavirliği LTD.ŞTİ.", 
                  electric: { meter_no: "39297095", last_reading: 0 },
                  water: { meter_no: "5185346", last_reading: 0 },
                  history: []
                },
                { id: "140", office_no: "124", name: "Duygu Gümrük Müşavirliği LTD.ŞTİ.", 
                  electric: { meter_no: "39296829", last_reading: 0 },
                  water: { meter_no: "5185332", last_reading: 0 },
                  history: []
                },
                { id: "141", office_no: "125", name: "Obdan Sistem Gümrük Müşavirliği LTD.ŞTİ.", 
                  electric: { meter_no: "39296794", last_reading: 0 },
                  water: { meter_no: "5185361", last_reading: 0 },
                  history: []
                },
                { id: "142", office_no: "126", name: "TGS Transport Ulus.Taş.Acen.LTD.ŞTİ.", 
                  electric: { meter_no: "39297178", last_reading: 0 },
                  water: { meter_no: "5185253", last_reading: 0 },
                  history: []
                },
                { id: "143", office_no: "127", name: "Erdal Büyükşahin", 
                  electric: { meter_no: "39297209", last_reading: 0 },
                  water: { meter_no: "5185411", last_reading: 0 },
                  history: []
                },
                { id: "144", office_no: "128", name: "Karınca Lojistik A.Ş.", 
                  electric: { meter_no: "39296925", last_reading: 0 },
                  water: { meter_no: "5185340", last_reading: 0 },
                  history: []
                },
                { id: "145", office_no: "129", name: "Armatrans Ulus.Taş. Acen.İth.İhr.Tic.LTD.ŞTİ.", 
                  electric: { meter_no: "39297029", last_reading: 0 },
                  water: { meter_no: "4675455", last_reading: 0 },
                  history: []
                },
                { id: "146", office_no: "130", name: "Tüm Global Lojistik Hiz.A.Ş.", 
                  electric: { meter_no: "39297045", last_reading: 0 },
                  water: { meter_no: "8846594", last_reading: 0 },
                  history: []
                },
                { id: "147", office_no: "131", name: "DMS Lojistik Taşımacılık LTD.ŞTİ.", 
                  electric: { meter_no: "39297177", last_reading: 0 },
                  water: { meter_no: "5185281", last_reading: 0 },
                  history: []
                },
                { id: "148", office_no: "132", name: "Sağlık Transport Nak. Tic. LTD.ŞTİ.", 
                  electric: { meter_no: "39297087", last_reading: 0 },
                  water: { meter_no: "5185444", last_reading: 0 },
                  history: []
                },
                { id: "149", office_no: "133", name: "", 
                  electric: { meter_no: "", last_reading: 0 },
                  water: { meter_no: "5185274", last_reading: 0 },
                  history: []
                },
                { id: "150", office_no: "134", name: "", 
                  electric: { meter_no: "", last_reading: 0 },
                  water: { meter_no: "5185274", last_reading: 0 },
                  history: []
                },
                { id: "151", office_no: "135", name: "TGL Gümrük Müşavirliği LTD.ŞTİ.", 
                  electric: { meter_no: "39297127", last_reading: 0 },
                  water: { meter_no: "5185264", last_reading: 0 },
                  history: []
                },
                { id: "152", office_no: "136", name: "", 
                  electric: { meter_no: "", last_reading: 0 },
                  water: { meter_no: "5185391", last_reading: 0 },
                  history: []
                },
                { id: "153", office_no: "137", name: "", 
                  electric: { meter_no: "", last_reading: 0 },
                  water: { meter_no: "", last_reading: 0 },
                  history: []
                },
                { id: "154", office_no: "138", name: "Orhan Yayla", 
                  electric: { meter_no: "39297164", last_reading: 0 },
                  water: { meter_no: "5185449", last_reading: 0 },
                  history: []
                },
                { id: "155", office_no: "139", name: "Asos Global Lojistik LTD.ŞTİ.", 
                  electric: { meter_no: "39297156", last_reading: 0 },
                  water: { meter_no: "5185438", last_reading: 0 },
                  history: []
                },
                { id: "156", office_no: "140", name: "MKR Gümrük Müşavirliği LTD.ŞTİ.", 
                  electric: { meter_no: "39297207", last_reading: 0 },
                  water: { meter_no: "5185312", last_reading: 0 },
                  history: []
                },
                { id: "157", office_no: "141", name: "Atabay Loj. Ve Gümrükleme Tic. LTD.ŞTİ.", 
                  electric: { meter_no: "39297017", last_reading: 0 },
                  water: { meter_no: "5185350", last_reading: 0 },
                  history: []
                },
                { id: "158", office_no: "142", name: "", 
                  electric: { meter_no: "", last_reading: 0 },
                  water: { meter_no: "", last_reading: 0 },
                  history: []
                },
                { id: "159", office_no: "143", name: "Yılmaz Uluslararası Taş. LTD.ŞTİ.", 
                  electric: { meter_no: "39296853", last_reading: 0 },
                  water: { meter_no: "5185436", last_reading: 0 },
                  history: []
                },
                { id: "160", office_no: "144", name: "BS Lojistik Dış Ticaret LTD.ŞTİ.", 
                  electric: { meter_no: "39296910", last_reading: 0 },
                  water: { meter_no: "5185431", last_reading: 0 },
                  history: []
                },
                { id: "161", office_no: "145", name: "", 
                  electric: { meter_no: "", last_reading: 0 },
                  water: { meter_no: "5185353", last_reading: 0 },
                  history: []
                },
                { id: "162", office_no: "146", name: "HG Gümrük Müşavirliği LTD.ŞTİ.", 
                  electric: { meter_no: "39297136", last_reading: 0 },
                  water: { meter_no: "5185263", last_reading: 0 },
                  history: []
                },
                { id: "163", office_no: "147", name: "KRE Kare Gümrük Müşavirliği", 
                  electric: { meter_no: "39296987", last_reading: 0 },
                  water: { meter_no: "5185388", last_reading: 0 },
                  history: []
                },
                { id: "164", office_no: "148", name: "", 
                  electric: { meter_no: "39296755", last_reading: 0 },
                  water: { meter_no: "5185416", last_reading: 0 },
                  history: []
                },
                { id: "165", office_no: "149", name: "Güneş Gümrük ve Lojistik Hiz. LTD.ŞTİ", 
                  electric: { meter_no: "39297147", last_reading: 0 },
                  water: { meter_no: "5185322", last_reading: 0 },
                  history: []
                },
                { id: "166", office_no: "150", name: "", 
                  electric: { meter_no: "", last_reading: 0 },
                  water: { meter_no: "5185282", last_reading: 0 },
                  history: []
                },
                { id: "167", office_no: "151", name: "Point Lojistik LTD.ŞTİ.", 
                  electric: { meter_no: "39296819", last_reading: 0 },
                  water: { meter_no: "5185402", last_reading: 0 },
                  history: []
                },
                { id: "168", office_no: "152", name: "Global Express Dış Tic.A.Ş.", 
                  electric: { meter_no: "39296897", last_reading: 0 },
                  water: { meter_no: "5185381", last_reading: 0 },
                  history: []
                },
                { id: "169", office_no: "153", name: "", 
                  electric: { meter_no: "", last_reading: 0 },
                  water: { meter_no: "5185264", last_reading: 0 },
                  history: []
                },
                { id: "170", office_no: "154", name: "On-El Gümrük Müşavirliği LTD.ŞTİ.", 
                  electric: { meter_no: "39297083", last_reading: 0 },
                  water: { meter_no: "5185400", last_reading: 0 },
                  history: []
                },
                { id: "171", office_no: "155", name: "Dörtel Gümrük Müşavirliği A.Ş.", 
                  electric: { meter_no: "39297074", last_reading: 0 },
                  water: { meter_no: "5185423", last_reading: 0 },
                  history: []
                },
                { id: "172", office_no: "156", name: "Teknik Gümrük Müşavirliği LTD.ŞTİ.", 
                  electric: { meter_no: "39297108", last_reading: 0 },
                  water: { meter_no: "5185255", last_reading: 0 },
                  history: []
                },
                { id: "173", office_no: "157", name: "Kuzey Gümrük Müşavirliği Hiz. LTD.ŞTİ.", 
                  electric: { meter_no: "39297286", last_reading: 0 },
                  water: { meter_no: "5185314", last_reading: 0 },
                  history: []
                },
                { id: "174", office_no: "158", name: "", 
                  electric: { meter_no: "", last_reading: 0 },
                  water: { meter_no: "5185372", last_reading: 0 },
                  history: []
                },
                { id: "175", office_no: "159", name: "Keskin Güngör Gümrük Müşavirliği LTD.ŞTİ.", 
                  electric: { meter_no: "39297211", last_reading: 0 },
                  water: { meter_no: "5185434", last_reading: 0 },
                  history: []
                },
                { id: "176", office_no: "160", name: "Teksim Gümrük Müş. LTD.ŞTİ.", 
                  electric: { meter_no: "39297138", last_reading: 0 },
                  water: { meter_no: "5185333", last_reading: 0 },
                  history: []
                },
                { id: "177", office_no: "161", name: "", 
                  electric: { meter_no: "", last_reading: 0 },
                  water: { meter_no: "5185347", last_reading: 0 },
                  history: []
                },
                { id: "178", office_no: "162", name: "Seray Ulus.Taş.İnş.Tic.LTD.ŞTİ.", 
                  electric: { meter_no: "39297180", last_reading: 0 },
                  water: { meter_no: "5185301", last_reading: 0 },
                  history: []
                },
                { id: "179", office_no: "163", name: "Derin Gümrük Müşavirliği LTD.ŞTİ.", 
                  electric: { meter_no: "39297037", last_reading: 0 },
                  water: { meter_no: "5185328", last_reading: 0 },
                  history: []
                },
                
                // ATM ve Banka
                { id: "180", office_no: "ATM01", name: "Türkiye Vakıflar Bankası T.A.O", 
                  electric: { meter_no: "72950388", last_reading: 0 },
                  water: { meter_no: "", last_reading: 0 },
                  history: []
                },
                { id: "181", office_no: "ATM02", name: "Ziraat Bankası A.Ş.", 
                  electric: { meter_no: "21181800", last_reading: 0 },
                  water: { meter_no: "", last_reading: 0 },
                  history: []
                },
                { id: "182", office_no: "ATM03", name: "Denizbank A.Ş.", 
                  electric: { meter_no: "73941721", last_reading: 0 },
                  water: { meter_no: "", last_reading: 0 },
                  history: []
                },
                { id: "183", office_no: "ATM04", name: "Garanti Bankası A.Ş.", 
                  electric: { meter_no: "260019266", last_reading: 0 },
                  water: { meter_no: "", last_reading: 0 },
                  history: []
                },
                { id: "184", office_no: "ATM05", name: "Türkiye İş Bankası A.Ş.", 
                  electric: { meter_no: "260003752", last_reading: 0 },
                  water: { meter_no: "", last_reading: 0 },
                  history: []
                },
                { id: "185", office_no: "ATM06", name: "Yapı Kredi Bankası A.Ş.", 
                  electric: { meter_no: "52301997", last_reading: 0 },
                  water: { meter_no: "", last_reading: 0 },
                  history: []
                },
                
                // Telekomünikasyon
                { id: "186", office_no: "Telekom-1", name: "Turkcell İletişim Hizmetleri A.Ş.", 
                  electric: { meter_no: "39587154", last_reading: 0 },
                  water: { meter_no: "", last_reading: 0 },
                  history: []
                },
                { id: "187", office_no: "Telekom-2", name: "Vodafone Telekomünikasyon A.Ş.", 
                  electric: { meter_no: "40839162", last_reading: 0 },
                  water: { meter_no: "", last_reading: 0 },
                  history: []
                },
                { id: "188", office_no: "Telekom-3", name: "TT MOBİL İLETİŞİM HİZMETLERİ A.Ş.", 
                  electric: { meter_no: "41038534", last_reading: 0 },
                  water: { meter_no: "", last_reading: 0 },
                  history: []
                },
                
                // Özel Bölgeler
                { id: "189", office_no: "20A", name: "Hamit CENGİZ/İthalat Giriş", 
                  electric: { meter_no: "40172802", last_reading: 0 },
                  water: { meter_no: "2365436", last_reading: 0 },
                  history: []
                },
                { id: "190", office_no: "20-2", name: "Hamit CENGİZ/Nakliye Giriş", 
                  electric: { meter_no: "40172476", last_reading: 0 },
                  water: { meter_no: "2365382", last_reading: 0 },
                  history: []
                },
                { id: "191", office_no: "2B01", name: "Hamit CENGİZ/Bina Cafe", 
                  electric: { meter_no: "73262760", last_reading: 0 },
                  water: { meter_no: "900723640", last_reading: 0 },
                  history: []
                },
                { id: "192", office_no: "20-6R", name: "ABY Gıda LTD.ŞTİ. / İhracat 2 Cafe", 
                  electric: { meter_no: "73261729", last_reading: 0 },
                  water: { meter_no: "5832341", last_reading: 0 },
                  history: []
                },
                { id: "193", office_no: "20-6S", name: "ABY Gıda LTD.ŞTİ. / İhracat 3 Cafe", 
                  electric: { meter_no: "62536647", last_reading: 0 },
                  water: { meter_no: "6231862", last_reading: 0 },
                  history: []
                },
                { id: "194", office_no: "20-6V", name: "ABY Gıda LTD.ŞTİ. / İhracat 4 Tır Shop", 
                  electric: { meter_no: "73261730", last_reading: 0 },
                  water: { meter_no: "16328438", last_reading: 0 },
                  history: []
                },
                { id: "195", office_no: "Z-61", name: "Pilav Arabası /Z62", 
                  electric: { meter_no: "39296873", last_reading: 0 },
                  water: { meter_no: "6231784", last_reading: 0 },
                  history: []
                },
                { id: "196", office_no: "20-6H", name: "ABY Gıda LTD.ŞTİ. / İthalat 2 Cafe/Ofis", 
                  electric: { meter_no: "73261779", last_reading: 0 },
                  water: { meter_no: "398530", last_reading: 0 },
                  history: []
                },
                
                // Yük Dağıtım (YD-Yeşil Depo) ve Sunucu Dağıtım (SD-Sarı Depo) Alanları
                
                // Fedex Express Türkiye - Tüm sayaçlar
                { id: "197", office_no: "YD1-1", name: "Fedex Express Türkiye Taş.TİC.LTD.ŞTİ.", 
                  electric: { meter_no: "73136044", last_reading: 0 },
                  water: { meter_no: "5173255", last_reading: 0 },
                  history: []
                },
                { id: "198", office_no: "YD2-1", name: "Güçlü Global LTD.ŞTİ.", 
                  electric: { meter_no: "80071801", last_reading: 0 },
                  water: { meter_no: "9782907", last_reading: 0 },
                  history: []
                },
                { id: "199", office_no: "SD1-1", name: "Mir Global Lojistik TİC.LTD.ŞTİ.", 
                  electric: { meter_no: "80034332", last_reading: 0 },
                  water: { meter_no: "16326241", last_reading: 0 },
                  history: []
                },
                { id: "200", office_no: "SD2-1", name: "Mir Global Lojistik TİC.LTD.ŞTİ.", 
                  electric: { meter_no: "80034408", last_reading: 0 },
                  water: { meter_no: "5173349", last_reading: 0 },
                  history: []
                },
                { id: "201", office_no: "MD1-1", name: "Asav Loj. Hizmt. A.Ş.", 
                  electric: { meter_no: "80032892", last_reading: 0 },
                  water: { meter_no: "16326243", last_reading: 0 },
                  history: []
                },
                { id: "202", office_no: "MD2-1", name: "Asav Loj. Hizmt. A.Ş.", 
                  electric: { meter_no: "80031176", last_reading: 0 },
                  water: { meter_no: "5173059", last_reading: 0 },
                  history: []
                },
                { id: "203", office_no: "ID", name: "Mir Global Lojistik TİC.LTD.ŞTİ.", 
                  electric: { meter_no: "8003384", last_reading: 0 },
                  water: { meter_no: "5173012", last_reading: 0 },
                  history: []
                },
                { id: "204", office_no: "YD1-2", name: "Fedex Express Türkiye Taş.TİC.LTD.ŞTİ.", 
                  electric: { meter_no: "73135649", last_reading: 0 },
                  water: { meter_no: "", last_reading: 0 },
                  history: []
                },
                { id: "205", office_no: "YD1-3", name: "Fedex Express Türkiye Taş.TİC.LTD.ŞTİ.", 
                  electric: { meter_no: "73135960", last_reading: 0 },
                  water: { meter_no: "", last_reading: 0 },
                  history: []
                },
                { id: "206", office_no: "YD1-4", name: "Fedex Express Türkiye Taş.TİC.LTD.ŞTİ.", 
                  electric: { meter_no: "80072113", last_reading: 0 },
                  water: { meter_no: "", last_reading: 0 },
                  history: []
                },
                { id: "207", office_no: "YD1-5", name: "Fedex Express Türkiye Taş.TİC.LTD.ŞTİ.", 
                  electric: { meter_no: "73135417", last_reading: 0 },
                  water: { meter_no: "", last_reading: 0 },
                  history: []
                },
                { id: "208", office_no: "YD1-6", name: "Fedex Express Türkiye Taş.TİC.LTD.ŞTİ.", 
                  electric: { meter_no: "73135481", last_reading: 0 },
                  water: { meter_no: "", last_reading: 0 },
                  history: []
                },
                { id: "209", office_no: "YD1-7", name: "Fedex Express Türkiye Taş.TİC.LTD.ŞTİ.", 
                  electric: { meter_no: "80071866", last_reading: 0 },
                  water: { meter_no: "", last_reading: 0 },
                  history: []
                },
                { id: "210", office_no: "YD2-2", name: "Güçlü Global LTD.ŞTİ.", 
                  electric: { meter_no: "73135966", last_reading: 0 },
                  water: { meter_no: "", last_reading: 0 },
                  history: []
                },
                { id: "211", office_no: "YD2-3", name: "Güçlü Global LTD.ŞTİ.", 
                  electric: { meter_no: "80071872", last_reading: 0 },
                  water: { meter_no: "", last_reading: 0 },
                  history: []
                },
                { id: "212", office_no: "YD2-4", name: "Güçlü Global LTD.ŞTİ.", 
                  electric: { meter_no: "73136012", last_reading: 0 },
                  water: { meter_no: "", last_reading: 0 },
                  history: []
                },
                { id: "213", office_no: "YD2-5", name: "Güçlü Global LTD.ŞTİ.", 
                  electric: { meter_no: "73136050", last_reading: 0 },
                  water: { meter_no: "", last_reading: 0 },
                  history: []
                },
                { id: "214", office_no: "SD1-2", name: "Mir Global Lojistik TİC.LTD.ŞTİ.", 
                  electric: { meter_no: "80034043", last_reading: 0 },
                  water: { meter_no: "", last_reading: 0 },
                  history: []
                },
                { id: "215", office_no: "SD1-3", name: "Mir Global Lojistik TİC.LTD.ŞTİ.", 
                  electric: { meter_no: "80036312", last_reading: 0 },
                  water: { meter_no: "", last_reading: 0 },
                  history: []
                },
                { id: "216", office_no: "SD1-4", name: "Mir Global Lojistik TİC.LTD.ŞTİ.", 
                  electric: { meter_no: "80036139", last_reading: 0 },
                  water: { meter_no: "", last_reading: 0 },
                  history: []
                },
                { id: "217", office_no: "SD1-5", name: "Mir Global Lojistik TİC.LTD.ŞTİ.", 
                  electric: { meter_no: "800353425", last_reading: 0 },
                  water: { meter_no: "", last_reading: 0 },
                  history: []
                },
                { id: "218", office_no: "SD1-6", name: "Mir Global Lojistik TİC.LTD.ŞTİ.", 
                  electric: { meter_no: "80047978", last_reading: 0 },
                  water: { meter_no: "", last_reading: 0 },
                  history: []
                },
                { id: "219", office_no: "SD1-7", name: "Mir Global Lojistik TİC.LTD.ŞTİ.", 
                  electric: { meter_no: "80036076", last_reading: 0 },
                  water: { meter_no: "", last_reading: 0 },
                  history: []
                },
                { id: "220", office_no: "SD2-3", name: "Mir Global Lojistik TİC.LTD.ŞTİ.", 
                  electric: { meter_no: "80036034", last_reading: 0 },
                  water: { meter_no: "", last_reading: 0 },
                  history: []
                },
                { id: "221", office_no: "SD2-4", name: "Mir Global Lojistik TİC.LTD.ŞTİ.", 
                  electric: { meter_no: "80036228", last_reading: 0 },
                  water: { meter_no: "", last_reading: 0 },
                  history: []
                },
                { id: "222", office_no: "SD2-5", name: "Mir Global Lojistik TİC.LTD.ŞTİ.", 
                  electric: { meter_no: "80034356", last_reading: 0 },
                  water: { meter_no: "", last_reading: 0 },
                  history: []
                },
                { id: "223", office_no: "SD2-6", name: "Mir Global Lojistik TİC.LTD.ŞTİ.", 
                  electric: { meter_no: "80034397", last_reading: 0 },
                  water: { meter_no: "", last_reading: 0 },
                  history: []
                },
                { id: "224", office_no: "SD2-7", name: "Mir Global Lojistik TİC.LTD.ŞTİ.", 
                  electric: { meter_no: "80034389", last_reading: 0 },
                  water: { meter_no: "", last_reading: 0 },
                  history: []
                },
                { id: "225", office_no: "MD1-2", name: "Asav Loj. Hizmt. A.Ş.", 
                  electric: { meter_no: "80036025", last_reading: 0 },
                  water: { meter_no: "", last_reading: 0 },
                  history: []
                },
                { id: "226", office_no: "MD1-3", name: "Asav Loj. Hizmt. A.Ş.", 
                  electric: { meter_no: "80032830", last_reading: 0 },
                  water: { meter_no: "", last_reading: 0 },
                  history: []
                },
                { id: "227", office_no: "MD1-4", name: "Asav Loj. Hizmt. A.Ş.", 
                  electric: { meter_no: "80032844", last_reading: 0 },
                  water: { meter_no: "", last_reading: 0 },
                  history: []
                },
                { id: "228", office_no: "MD1-5", name: "Asav Loj. Hizmt. A.Ş.", 
                  electric: { meter_no: "80032396", last_reading: 0 },
                  water: { meter_no: "", last_reading: 0 },
                  history: []
                },
                { id: "229", office_no: "MD1-6", name: "Asav Loj. Hizmt. A.Ş.", 
                  electric: { meter_no: "80032907", last_reading: 0 },
                  water: { meter_no: "", last_reading: 0 },
                  history: []
                },
                { id: "230", office_no: "MD2-3", name: "Asav Loj. Hizmt. A.Ş.", 
                  electric: { meter_no: "80034074", last_reading: 0 },
                  water: { meter_no: "", last_reading: 0 },
                  history: []
                },
                { id: "231", office_no: "MD2-4", name: "Asav Loj. Hizmt. A.Ş.", 
                  electric: { meter_no: "80034075", last_reading: 0 },
                  water: { meter_no: "", last_reading: 0 },
                  history: []
                },
                { id: "232", office_no: "MD2-5", name: "Asav Loj. Hizmt. A.Ş.", 
                  electric: { meter_no: "80033844", last_reading: 0 },
                  water: { meter_no: "", last_reading: 0 },
                  history: []
                },
                { id: "233", office_no: "MD2-6", name: "Asav Loj. Hizmt. A.Ş.", 
                  electric: { meter_no: "80034072", last_reading: 0 },
                  water: { meter_no: "", last_reading: 0 },
                  history: []
                }
            ];
        }

        // Envanter verileri
        function initializeInventory() {
            inventory = [
                {
                    id: 1,
                    name: "Elektrik Kablosu",
                    quantity: 150,
                    unit: "Metre",
                    depo_id: "TEKNİK DEPO",
                    description: "2x2.5mm kesitli NYM kablo",
                    lastUpdated: "2025-05-18",
                    updatedBy: "admin",
                    movements: [
                        {
                            date: "2025-05-18",
                            user: "admin",
                            action: "Ekleme",
                            oldQuantity: 0,
                            change: 150,
                            newQuantity: 150
                        }
                    ]
                },
                {
                    id: 2,
                    name: "Temizlik Malzemesi",
                    quantity: 25,
                    unit: "Litre",
                    depo_id: "İŞLETME DEPO",
                    description: "Genel temizlik solüsyonu",
                    lastUpdated: "2025-05-19",
                    updatedBy: "admin",
                    movements: [
                        {
                            date: "2025-05-15",
                            user: "admin",
                            action: "Ekleme",
                            oldQuantity: 0,
                            change: 30,
                            newQuantity: 30
                        },
                        {
                            date: "2025-05-19",
                            user: "admin",
                            action: "Çıkarma",
                            oldQuantity: 30,
                            change: -5,
                            newQuantity: 25
                        }
                    ]
                }
            ];
        }

        // Sayfa bölümleri arası geçiş
        function showHeroSection(e) {
            if (e) e.preventDefault();
            document.getElementById('heroSection').style.display = 'flex';
            document.getElementById('aboutSection').style.display = 'none';
            document.getElementById('contactSection').style.display = 'none';
        }

        function showAboutSection(e) {
            if (e) e.preventDefault();
            document.getElementById('heroSection').style.display = 'none';
            document.getElementById('aboutSection').style.display = 'flex';
            document.getElementById('contactSection').style.display = 'none';
        }

        function showContactSection(e) {
            if (e) e.preventDefault();
            document.getElementById('heroSection').style.display = 'none';
            document.getElementById('aboutSection').style.display = 'none';
            document.getElementById('contactSection').style.display = 'flex';
        }

        // Giriş işlemleri
        function openLoginModal() {
            document.getElementById('loginModal').style.display = 'flex';
            document.getElementById('username').focus();
        }

        function closeLoginModal() {
            document.getElementById('loginModal').style.display = 'none';
            document.getElementById('username').value = '';
            document.getElementById('password').value = '';
            document.getElementById('loginError').textContent = '';
        }

        function handleLogin() {
            const username = document.getElementById('username').value.trim();
            const password = document.getElementById('password').value.trim();
            const loginError = document.getElementById('loginError');

            if (!username || !password) {
                loginError.textContent = "Kullanıcı adı ve şifre gereklidir!";
                return;
            }

            const user = users.find(u => u.username === username && u.password === password);

            if (user) {
                currentUser = user;
                document.getElementById('currentUsername').textContent = user.name;
                document.getElementById('adminUsername').textContent = user.name;
                closeLoginModal();
                document.getElementById('homePage').style.display = 'none';

                // Rol bazlı yönlendirme
                if (user.role === 'admin') {
                    // Admin - tüm panellere erişim
                    document.getElementById('appScreen').style.display = 'none';
                    document.getElementById('adminPanel').style.display = 'block';
                    showAdminPanel('userPanel');
                } else if (user.role === 'depo') {
                    // Depo personeli - sadece depo paneli
                    document.getElementById('appScreen').style.display = 'none';
                    document.getElementById('adminPanel').style.display = 'block';
                    showAdminPanel('depoPanel');
                    // Diğer menüleri gizle
                    document.querySelectorAll('.office-item').forEach(item => {
                        if (item.getAttribute('data-panel') !== 'depoPanel') {
                            item.style.display = 'none';
                        }
                    });
                } else if (user.role === 'teknik') {
                    // Teknik personel - sadece sayaç girişi
                    document.getElementById('appScreen').style.display = 'block';
                    document.getElementById('adminPanel').style.display = 'none';
                    renderOfficeList();
                    updateDate();
                    setInterval(updateDate, 60000);
                }
            } else {
                loginError.textContent = "Geçersiz kullanıcı adı veya şifre!";
            }
        }

        function handleLogout() {
            currentUser = null;
            document.getElementById('homePage').style.display = 'block';
            document.getElementById('appScreen').style.display = 'none';
            document.getElementById('adminPanel').style.display = 'none';
            showHeroSection();
        }

        function updateDate() {
            const currentDate = document.getElementById('currentDate');
            if (currentDate) {
                const now = new Date();
                const options = { 
                    year: 'numeric', 
                    month: 'long', 
                    day: 'numeric',
                    hour: '2-digit',
                    minute: '2-digit'
                };
                currentDate.textContent = now.toLocaleDateString('tr-TR', options);
            }
        }

        // Admin panel işlemleri
        // Paneller arası geçiş için event listener
        document.querySelectorAll('.office-item').forEach(item => {
            item.addEventListener('click', function() {
                const panelId = this.getAttribute('data-panel');
                document.querySelectorAll('.admin-panel-content').forEach(panel => {
                    panel.style.display = 'none';
                });
                document.getElementById(panelId).style.display = 'block';
                document.querySelectorAll('.office-item').forEach(i => {
                    i.classList.remove('active');
                });
                this.classList.add('active');
                
                // Panel içeriğini güncelle
                if (panelId === 'userPanel') {
                    renderUserTable();
                } else if (panelId === 'officePanel') {
                    renderOfficeTable();
                } else if (panelId === 'meterPanel') {
                    renderMeterTable();
                } else if (panelId === 'statusPanel') {
                    renderStatusTable();
                } else if (panelId === 'depoPanel') {
                    renderInventoryTable();
                } else if (panelId === 'documentsPanel') {
                    updateDocumentsTable();
                }
            });
        });
        
        function showAdminPanel(panelId) {
            document.querySelectorAll('.admin-panel-content').forEach(panel => {
                panel.style.display = 'none';
            });

            document.querySelectorAll('.office-item').forEach(tab => {
                tab.classList.remove('active');
            });

            document.getElementById(panelId).style.display = 'block';

            const activeTab = document.querySelector(`.office-item[data-panel="${panelId}"]`);
            if (activeTab) {
                activeTab.classList.add('active');
            }

            // Panel içeriğini güncelle
            if (panelId === 'userPanel') {
                renderUserTable();
            } else if (panelId === 'officePanel') {
                renderOfficeTable();
            } else if (panelId === 'meterPanel') {
                renderMeterTable();
            } else if (panelId === 'statusPanel') {
                renderStatusTable();
            } else if (panelId === 'depoPanel') {
                renderInventoryTable();
            } else if (panelId === 'documentsPanel') {
                updateDocumentsTable();
            }
        }
        
        // Dokümanlar ve kategoriler için localStorage kullanımı
        
        // Doküman Yönetimi için gerekli değişkenler
        let documents = JSON.parse(localStorage.getItem('documents') || '[]');
        let categories = JSON.parse(localStorage.getItem('categories') || '["Talimatlar", "Faturalar", "Sözleşmeler", "Raporlar", "Diğer"]');
        
        // Kategorileri yönetme
        function updateCategoryOptions() {
            // Kategori dropdown menülerini güncelleme
            const categorySelects = [document.getElementById('documentCategory'), document.getElementById('categoryFilter')];
            
            categorySelects.forEach(select => {
                if (!select) return;
                
                // İlk seçenek dışındaki tüm seçenekleri temizle
                while (select.options.length > 1) {
                    select.remove(1);
                }
                
                // Kategorileri ekle
                categories.forEach(category => {
                    const option = document.createElement('option');
                    option.value = category;
                    option.textContent = category;
                    select.appendChild(option);
                });
            });
            
            // localStorage'e kategorileri kaydet
            localStorage.setItem('categories', JSON.stringify(categories));
        }
        
        // Yeni kategori ekleme işlemi
        function addNewCategory(categoryName) {
            if (!categoryName) return;
            
            // Kategori zaten varsa ekleme
            if (categories.includes(categoryName)) {
                alert('Bu kategori zaten mevcut!');
                return;
            }
            
            // Yeni kategoriyi ekle
            categories.push(categoryName);
            
            // Kategori listesini güncelle
            updateCategoryOptions();
            
            // Modalı kapat
            document.getElementById('newCategoryModal').style.display = 'none';
            document.getElementById('newCategoryName').value = '';
            
            alert('Yeni kategori başarıyla eklendi!');
        }
        
        // Yeni kategori modalını açma
        document.getElementById('addCategoryBtn').addEventListener('click', function() {
            document.getElementById('newCategoryModal').style.display = 'flex';
            document.getElementById('newCategoryName').focus();
        });
        
        // Yeni kategori modalını kapatma
        document.getElementById('closeCategoryModal').addEventListener('click', function() {
            document.getElementById('newCategoryModal').style.display = 'none';
            document.getElementById('newCategoryName').value = '';
        });
        
        document.getElementById('cancelCategoryBtn').addEventListener('click', function() {
            document.getElementById('newCategoryModal').style.display = 'none';
            document.getElementById('newCategoryName').value = '';
        });
        
        // Yeni kategori kaydetme
        document.getElementById('saveCategoryBtn').addEventListener('click', function() {
            const categoryName = document.getElementById('newCategoryName').value.trim();
            if (!categoryName) {
                alert('Lütfen kategori adı girin!');
                return;
            }
            
            addNewCategory(categoryName);
        });
        
        // Kategori adı giriş alanı için enter tuşu olayı
        document.getElementById('newCategoryName').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                const categoryName = this.value.trim();
                if (!categoryName) {
                    alert('Lütfen kategori adı girin!');
                    return;
                }
                
                addNewCategory(categoryName);
            }
        });
        
        // Kullanıcı ekleme fonksiyonu
        function addUser(userData) {
            // Kullanıcıyı users dizisine ekle
            users.push(userData);
            
            // localStorage'e kaydet
            localStorage.setItem('users', JSON.stringify(users));
            
            // Kullanıcı tablosunu güncelle (eğer fonksiyon mevcutsa)
            if (typeof renderUserTable === 'function') {
                renderUserTable();
            }
            
            return true;
        }
        
        // Kullanıcıyı düzenleme fonksiyonu
        function editUser(username) {
            // Kullanıcıyı bul
            const userIndex = users.findIndex(user => user.username === username);
            if (userIndex === -1) return false;
            
            // Form verilerini al ve kullanıcıyı güncelle
            // Not: Bu kısım, gerçek form alanlarınıza göre düzenlenmelidir
            const userData = {
                // Form verilerini buraya ekleyin
                username: document.getElementById('editUsername').value,
                // Diğer alanlar...
            };
            
            users[userIndex] = userData;
            
            // localStorage'e kaydet
            localStorage.setItem('users', JSON.stringify(users));
            
            // Kullanıcı tablosunu güncelle
            renderUserTable();
            
            return true;
        }
        
        // Kullanıcıyı silme fonksiyonu
        function deleteUser(username) {
            // Kullanıcı silme onayı
            if (!confirm(`${username} kullanıcısını silmek istediğinizden emin misiniz?`)) {
                return false;
            }
            
            // Kullanıcıyı bul ve sil
            users = users.filter(user => user.username !== username);
            
            // localStorage'e kaydet
            localStorage.setItem('users', JSON.stringify(users));
            
            // Kullanıcı tablosunu güncelle
            renderUserTable();
            
            return true;
        }
        
        // Kullanıcı tablosunu render etme fonksiyonu
        function renderUserTable() {
            const userTable = document.getElementById('userTable');
            if (!userTable) return;
            
            // Tablo başlığını hazırla
            let tableHTML = `
                <thead>
                    <tr>
                        <th>Kullanıcı Adı</th>
                        <th>Ad Soyad</th>
                        <th>E-posta</th>
                        <th>Rol</th>
                        <th>İşlemler</th>
                    </tr>
                </thead>
                <tbody>
            `;
            
            // Kullanıcı yoksa bilgi mesajı göster
            if (users.length === 0) {
                tableHTML += `
                    <tr>
                        <td colspan="5" class="text-center">Henüz kullanıcı eklenmemiş.</td>
                    </tr>
                `;
            } else {
                // Her kullanıcı için bir satır oluştur
                users.forEach(user => {
                    tableHTML += `
                        <tr>
                            <td>${user.username}</td>
                            <td>${user.fullName || '-'}</td>
                            <td>${user.email || '-'}</td>
                            <td>${user.role || 'Kullanıcı'}</td>
                            <td>
                                <button class="edit-btn" data-username="${user.username}">Düzenle</button>
                                <button class="delete-btn" data-username="${user.username}">Sil</button>
                            </td>
                        </tr>
                    `;
                });
            }
            
            tableHTML += '</tbody>';
            userTable.innerHTML = tableHTML;
        }
        
        // Doküman yükleme işlemi
        document.getElementById('uploadDocumentBtn').addEventListener('click', function() {
            const title = document.getElementById('documentTitle').value;
            const category = document.getElementById('documentCategory').value;
            const description = document.getElementById('documentDescription').value;
            const fileInput = document.getElementById('documentFile');
            
            if (!title || !category || !fileInput.files.length) {
                alert('Lütfen başlık, kategori ve en az bir PDF dosyası seçin.');
                return;
            }
            
            // Toplu yükleme için files array'ini işleme
            const totalFiles = fileInput.files.length;
            let processedFiles = 0;
            let successCount = 0;
            
            // Yükleme işlemi başladığında yükleme düğmesini devre dışı bırak
            const uploadButton = document.getElementById('uploadDocumentBtn');
            uploadButton.disabled = true;
            uploadButton.textContent = '0/' + totalFiles + ' Yükleniyor...';
            
            // Her dosya için
            Array.from(fileInput.files).forEach((file, index) => {
                if (!file.type.includes('pdf')) {
                    processedFiles++;
                    uploadButton.textContent = processedFiles + '/' + totalFiles + ' Yükleniyor...';
                    if (processedFiles === totalFiles) {
                        completeUpload();
                    }
                    return; // PDF değilse atla
                }
                
                // Dosyanın Base64 formatına dönüştürülmesi
                const reader = new FileReader();
                reader.onload = function(e) {
                    const base64Data = e.target.result;
                    
                    // Belge nesnesini oluştur
                const docItem = {
                    id: Date.now() + '-' + index,
                    title: title,
                    category: category,
                    description: description,
                    fileName: file.name,
                    fileSize: file.size,
                    uploadDate: new Date().toISOString(),
                    fileData: reader.result
                };
                
                // Doküman listesine ekle
                documents.push(docItem);
                
                // Belgeleri localStorage'e kaydet
                localStorage.setItem('documents', JSON.stringify(documents));
                    
                    successCount++;
                    
                    // İşlenen dosya sayısını artır
                    processedFiles++;
                    uploadButton.textContent = processedFiles + '/' + totalFiles + ' Yükleniyor...';
                    
                    // Tüm dosyalar işlendiyse temizleme yap
                    if (processedFiles === totalFiles) {
                        completeUpload();
                    }
                };
                
                reader.onerror = function() {
                    processedFiles++;
                    uploadButton.textContent = processedFiles + '/' + totalFiles + ' Yükleniyor...';
                    if (processedFiles === totalFiles) {
                        completeUpload();
                    }
                };
                
                reader.readAsDataURL(file);
            });
            
            // Yükleme tamamlandığında yapılacak işlemler
            function completeUpload() {
                // Dokümanları localStorage'e kaydetme
                localStorage.setItem('documents', JSON.stringify(documents));
                
                // Formu temizleme
                document.getElementById('documentTitle').value = '';
                document.getElementById('documentCategory').value = '';
                document.getElementById('documentDescription').value = '';
                document.getElementById('documentFile').value = '';
                
                // Tabloyu güncelleme
                updateDocumentsTable();
                
                // Yükleme düğmesini sıfırla
                uploadButton.disabled = false;
                uploadButton.textContent = 'Dokümanı Yükle';
                
                // Bilgilendirme mesajı
                alert(totalFiles + ' dosyadan ' + successCount + ' tanesi başarıyla yüklendi!');
            }
        });
        
        // Dokümanları tablodan silme
        function deleteDocument(id) {
            if(confirm('Bu dokümanı silmek istediğinize emin misiniz?')) {
                documents = documents.filter(doc => doc.id !== id);
                localStorage.setItem('documents', JSON.stringify(documents));
                updateDocumentsTable();
            }
        }
        
        // Dokümanı görüntüleme
        function viewDocument(id) {
            const document = documents.find(doc => doc.id === id);
            if (document) {
                // Base64 PDF verisi ile yeni bir sekme açma
                const newWindow = window.open();
                newWindow.document.write(`
                    <iframe width="100%" height="100%" src="${document.fileData}" frameborder="0"></iframe>
                `);
            }
        }
        
        // Doküman tablosunu güncelleme
        function updateDocumentsTable() {
            const tableBody = document.getElementById('documentsTableBody');
            if (!tableBody) return;
            
            const searchTerm = document.getElementById('documentSearch')?.value.toLowerCase() || '';
            const categoryFilter = document.getElementById('categoryFilter')?.value || '';
            
            // Tabloyu temizleme
            tableBody.innerHTML = '';
            
            // Filtreleme işlemi
            const filteredDocuments = documents.filter(doc => {
                const matchesSearch = doc.title.toLowerCase().includes(searchTerm) || 
                                    doc.description.toLowerCase().includes(searchTerm);
                const matchesCategory = categoryFilter === '' || doc.category === categoryFilter;
                
                return matchesSearch && matchesCategory;
            });
            
            // Filtrelenmiş dokümanları tabloya ekleme
            if (filteredDocuments.length === 0) {
                tableBody.innerHTML = `<tr><td colspan="5" style="text-align: center; padding: 20px;">Gösterilecek doküman bulunamadı</td></tr>`;
            } else {
                filteredDocuments.forEach(doc => {
                    const row = document.createElement('tr');
                    row.innerHTML = `
                        <td style="padding: 12px; border-bottom: 1px solid #ddd;">${doc.title}</td>
                        <td style="padding: 12px; border-bottom: 1px solid #ddd;">${doc.category}</td>
                        <td style="padding: 12px; border-bottom: 1px solid #ddd;">${doc.description}</td>
                        <td style="padding: 12px; border-bottom: 1px solid #ddd;">${doc.uploadDate}</td>
                        <td style="padding: 12px; border-bottom: 1px solid #ddd; text-align: center;">
                            <button onclick="viewDocument(${doc.id})" class="edit-btn" style="background-color: #4CAF50;">Görüntüle</button>
                            <button onclick="deleteDocument(${doc.id})" class="delete-btn">Sil</button>
                        </td>
                    `;
                    tableBody.appendChild(row);
                });
            }
        }
        
        // Arama kutusu ve kategori filtresi için event listener'lar
        document.getElementById('documentSearch')?.addEventListener('input', updateDocumentsTable);
        document.getElementById('categoryFilter')?.addEventListener('change', updateDocumentsTable);
        
        // Sayfa yüklendiğinde localStorage'den dokümanları ve kategorileri alma
        function initializeDocuments() {
            // Dokümanları yükle
            const savedDocuments = localStorage.getItem('documents');
            if (savedDocuments) {
                documents = JSON.parse(savedDocuments);
                updateDocumentsTable();
            }
            
            // Kategorileri yükle
            const savedCategories = localStorage.getItem('categories');
            if (savedCategories) {
                categories = JSON.parse(savedCategories);
            }
            
            // Kategori listelerini güncelle
            updateCategoryOptions();
        }
        
        // Sayfa yüklendiğinde initialiazation çağır
        document.addEventListener('DOMContentLoaded', function() {
            initializeDocuments();
        });
            
        // Kullanıcı yönetimi
        function renderUserTable() {
            const userTableBody = document.getElementById('userTableBody');
            if (!userTableBody) return;

            userTableBody.innerHTML = '';

            users.forEach(user => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${user.username}</td>
                    <td>${user.name}</td>
                    <td>${user.role === 'admin' ? 'Yönetici' : user.role === 'depo' ? 'Depo Personeli' : 'Teknik Personel'}</td>
                    <td>
                        <button class="edit-btn" data-username="${user.username}">Düzenle</button>
                        <button class="delete-btn" data-username="${user.username}">Sil</button>
                    </td>
                `;
                userTableBody.appendChild(row);
            });
        }

        function showUserModal() {
            document.getElementById('addUserModal').style.display = 'flex';
        }

        function hideUserModal() {
            document.getElementById('addUserModal').style.display = 'none';
            document.getElementById('newUsername').value = '';
            document.getElementById('newFullName').value = '';
            document.getElementById('newPassword').value = '';
            document.getElementById('newRole').value = 'teknik';
        }

        function saveNewUser() {
            const username = document.getElementById('newUsername').value.trim();
            const fullName = document.getElementById('newFullName').value.trim();
            const password = document.getElementById('newPassword').value.trim();
            const role = document.getElementById('newRole').value;

            if (!username || !fullName || !password) {
                alert('Tüm alanları doldurun!');
                return;
            }

            if (users.some(u => u.username === username)) {
                alert('Bu kullanıcı adı zaten kullanılıyor!');
                return;
            }

            users.push({
                username: username,
                password: password,
                name: fullName,
                role: role
            });
            
            // Kullanıcıları localStorage'a kaydet
            localStorage.setItem('users', JSON.stringify(users));

            renderUserTable();
            hideUserModal();
            alert('Kullanıcı başarıyla eklendi!');
        }

        function editUser(username) {
            const user = users.find(u => u.username === username);
            if (!user) return;
            
            document.getElementById('editUsername').value = user.username;
            document.getElementById('editFullName').value = user.name;
            document.getElementById('editPassword').value = '';
            document.getElementById('editRole').value = user.role;
            
            document.getElementById('editUserModal').style.display = 'flex';
        }
        
        function hideEditUserModal() {
            document.getElementById('editUserModal').style.display = 'none';
        }
        
        function updateUser() {
            const username = document.getElementById('editUsername').value.trim();
            const fullName = document.getElementById('editFullName').value.trim();
            const password = document.getElementById('editPassword').value.trim();
            const role = document.getElementById('editRole').value;
            
            if (!username || !fullName) {
                alert('Kullanıcı adı ve Ad Soyad alanları doldurulmalıdır!');
                return;
            }
            
            const user = users.find(u => u.username === username);
            if (!user) return;
            
            user.name = fullName;
            user.role = role;
            
            // Şifre değiştirilecekse güncelle
            if (password) {
                user.password = password;
            }
            
            renderUserTable();
            hideEditUserModal();
            alert('Kullanıcı başarıyla güncellendi!');
        }

        function deleteUser(username) {
            if (confirm(`${username} kullanıcısını silmek istediğinize emin misiniz?`)) {
                const index = users.findIndex(u => u.username === username);
                if (index !== -1) {
                    users.splice(index, 1);
                    renderUserTable();
                    alert('Kullanıcı başarıyla silindi.');
                }
            }
        }

        // Ofis yönetimi
        function renderOfficeTable() {
            const officeTableBody = document.getElementById('officeTableBody');
            if (!officeTableBody) return;

            officeTableBody.innerHTML = '';

            offices.forEach(office => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${office.office_no}</td>
                    <td>${office.name}</td>
                    <td>${office.electric ? office.electric.meter_no : ''}</td>
                    <td>${office.water ? office.water.meter_no : ''}</td>
                    <td>
                        <button class="edit-office-btn" data-id="${office.id}">Düzenle</button>
                    </td>
                `;
                officeTableBody.appendChild(row);
            });
        }

        function editOffice(officeId) {
            const office = offices.find(o => o.id === officeId);
            if (office) {
                document.getElementById('editOfficeNo').value = office.office_no;
                document.getElementById('editOfficeName').value = office.name;
                document.getElementById('editElectricMeterNo').value = office.electric ? office.electric.meter_no : '';
                document.getElementById('editWaterMeterNo').value = office.water ? office.water.meter_no : '';
                document.getElementById('officeEditForm').style.display = 'block';
                document.getElementById('saveOfficeBtn').setAttribute('data-id', officeId);
            }
        }

        function hideOfficeEditForm() {
            document.getElementById('officeEditForm').style.display = 'none';
        }

        function saveOfficeChanges(officeId) {
            const office = offices.find(o => o.id === officeId);
            if (office) {
                office.name = document.getElementById('editOfficeName').value.trim();
                
                if (office.electric) {
                    office.electric.meter_no = document.getElementById('editElectricMeterNo').value.trim();
                } else {
                    office.electric = { meter_no: document.getElementById('editElectricMeterNo').value.trim(), last_reading: 0 };
                }
                
                if (office.water) {
                    office.water.meter_no = document.getElementById('editWaterMeterNo').value.trim();
                } else {
                    office.water = { meter_no: document.getElementById('editWaterMeterNo').value.trim(), last_reading: 0 };
                }
                
                renderOfficeTable();
                renderMeterTable();
                hideOfficeEditForm();
                alert('Ofis bilgileri güncellendi!');
            }
        }

        function searchAdminOffices(searchText) {
            const searchLower = searchText.toLowerCase();
            const rows = document.querySelectorAll('#officeTableBody tr');
            
            rows.forEach(row => {
                const officeName = row.cells[1].textContent.toLowerCase();
                const officeNo = row.cells[0].textContent.toLowerCase();
                
                if (officeName.includes(searchLower) || officeNo.includes(searchLower)) {
                    row.style.display = '';
                } else {
                    row.style.display = 'none';
                }
            });
        }

        // Sayaç yönetimi
        function renderMeterTable() {
            const meterTableBody = document.getElementById('meterTableBody');
            if (!meterTableBody) return;

            meterTableBody.innerHTML = '';

            offices.forEach(office => {
                if (office.electric && office.electric.meter_no) {
                    const row = document.createElement('tr');
                    row.innerHTML = `
                        <td>${office.office_no}</td>
                        <td>Elektrik</td>
                        <td>${office.electric.meter_no}</td>
                        <td>${office.electric.last_reading}</td>
                        <td>
                            <button class="edit-meter-btn" data-id="${office.id}" data-type="electric">Düzenle</button>
                        </td>
                    `;
                    meterTableBody.appendChild(row);
                }
                
                if (office.water && office.water.meter_no) {
                    const row = document.createElement('tr');
                    row.innerHTML = `
                        <td>${office.office_no}</td>
                        <td>Su</td>
                        <td>${office.water.meter_no}</td>
                        <td>${office.water.last_reading}</td>
                        <td>
                            <button class="edit-meter-btn" data-id="${office.id}" data-type="water">Düzenle</button>
                        </td>
                    `;
                    meterTableBody.appendChild(row);
                }
            });
        }

        function showMeterEditModal(officeId, meterType) {
            const office = offices.find(o => o.id === officeId);
            if (!office) return;
            
            document.getElementById('editMeterOffice').value = `${office.office_no} - ${office.name}`;
            document.getElementById('editMeterType').value = meterType === 'electric' ? 'Elektrik' : 'Su';
            
            const meter = office[meterType];
            if (meter) {
                document.getElementById('editMeterNo').value = meter.meter_no;
                document.getElementById('editMeterReading').value = meter.last_reading;
            } else {
                document.getElementById('editMeterNo').value = '';
                document.getElementById('editMeterReading').value = '';
            }
            
            const saveBtn = document.getElementById('saveMeterBtn');
            saveBtn.setAttribute('data-id', officeId);
            saveBtn.setAttribute('data-type', meterType);
            
            document.getElementById('editMeterModal').style.display = 'flex';
        }

        function hideMeterEditModal() {
            document.getElementById('editMeterModal').style.display = 'none';
        }

        function saveMeterChanges(officeId, meterType) {
            const office = offices.find(o => o.id === officeId);
            if (!office) return;
            
            const meterNo = document.getElementById('editMeterNo').value.trim();
            const reading = parseInt(document.getElementById('editMeterReading').value.trim(), 10) || 0;
            
            if (!office[meterType]) {
                office[meterType] = {};
            }
            
            office[meterType].meter_no = meterNo;
            office[meterType].last_reading = reading;
            
            renderMeterTable();
            hideMeterEditModal();
            alert('Sayaç bilgileri güncellendi!');
        }

        function searchAdminMeters(searchText) {
            const searchLower = searchText.toLowerCase();
            const rows = document.querySelectorAll('#meterTableBody tr');
            
            rows.forEach(row => {
                const officeNo = row.cells[0].textContent.toLowerCase();
                const meterType = row.cells[1].textContent.toLowerCase();
                const meterNo = row.cells[2].textContent.toLowerCase();
                
                if (officeNo.includes(searchLower) || meterType.includes(searchLower) || meterNo.includes(searchLower)) {
                    row.style.display = '';
                } else {
                    row.style.display = 'none';
                }
            });
        }

        // Ofis veri durumu
        function renderStatusTable() {
            const statusTableBody = document.getElementById('statusTableBody');
            if (!statusTableBody) return;
            
            statusTableBody.innerHTML = '';
            
            offices.forEach(office => {
                const hasElectricData = office.electric && office.electric.last_reading !== undefined && office.electric.last_reading > 0;
                const hasWaterData = office.water && office.water.last_reading !== undefined && office.water.last_reading > 0;
                const allDataEntered = hasElectricData && hasWaterData;
                
                const user = office.lastUpdatedBy || '-';
                const date = office.lastUpdatedDate ? new Date(office.lastUpdatedDate).toLocaleString('tr-TR') : '-';
                
                const block = office.office_no.includes('-') ? office.office_no.split('-')[0] : 'Diğer';
                
                const row = document.createElement('tr');
                row.className = allDataEntered ? 'status-success' : 'status-error';
                
                row.innerHTML = `
                    <td>${block}</td>
                    <td>${office.office_no}</td>
                    <td>${office.name}</td>
                    <td>${hasElectricData ? office.electric.last_reading : '-'}</td>
                    <td>${hasWaterData ? office.water.last_reading : '-'}</td>
                    <td>${user}</td>
                    <td>${date}</td>
                    <td>
                        <span class="status-indicator ${allDataEntered ? 'success' : 'error'}"></span>
                        ${allDataEntered ? 'Girildi' : 'Girilmedi'}
                    </td>
                `;
                
                statusTableBody.appendChild(row);
            });
        }

        function searchStatusOffices(searchText) {
            const rows = document.querySelectorAll('#statusTableBody tr');
            searchText = searchText.toLowerCase();
            
            rows.forEach(row => {
                const officeNo = row.querySelector('td:nth-child(2)').textContent.toLowerCase();
                const officeName = row.querySelector('td:nth-child(3)').textContent.toLowerCase();
                const block = row.querySelector('td:nth-child(1)').textContent.toLowerCase();
                
                if (officeNo.includes(searchText) || officeName.includes(searchText) || block.includes(searchText)) {
                    row.style.display = '';
                } else {
                    row.style.display = 'none';
                }
            });
        }

        // Excel işlemleri
        function exportAllOfficesToExcel() {
            if (offices.length === 0) {
                alert('Aktarilacak kayıt bulunamadı!');
                return;
            }

            const data = [];
            data.push(['Ofis No', 'Firma Adı', 'Elektrik Sayaç No', 'Elektrik Son Değer', 'Su Sayaç No', 'Su Son Değer']);

            offices.forEach(office => {
                data.push([
                    office.office_no,
                    office.name,
                    office.electric ? office.electric.meter_no : '',
                    office.electric ? office.electric.last_reading : '',
                    office.water ? office.water.meter_no : '',
                    office.water ? office.water.last_reading : ''
                ]);
            });

            const ws = XLSX.utils.aoa_to_sheet(data);
            const wb = XLSX.utils.book_new();
            XLSX.utils.book_append_sheet(wb, ws, 'Ofis Kayıtları');
            XLSX.writeFile(wb, 'Ofis_Sayac_Kayitlari_' + new Date().toISOString().slice(0, 10) + '.xlsx');
            
            alert('Tüm ofis kayıtları Excel dosyasına aktarıldı!');
            
            const reportResult = document.getElementById('reportResult');
            reportResult.innerHTML = `
                <div style="padding: 15px; background-color: #eaf7ea; border-left: 4px solid #2e7d32; margin-bottom: 20px;">
                    <p><strong>${offices.length}</strong> adet ofis kaydı başarıyla Excel dosyasına aktarıldı.</p>
                    <p>Dosya Adı: <strong>Ofis_Sayac_Kayitlari_${new Date().toISOString().slice(0, 10)}.xlsx</strong></p>
                    <p>Aktarma Tarihi: ${new Date().toLocaleString('tr-TR')}</p>
                </div>
            `;
        }

        // Ofis listesi işlemleri (Teknik personel için)
        function renderOfficeList() {
            const officeListEl = document.getElementById('officeList');
            if (!officeListEl) return;
            
            officeListEl.innerHTML = '';
            
            const officeGroups = {};
            
            offices.forEach(office => {
                const officeNo = office.office_no.toString();
                // 100 serisi ofisleri (101, 102, 103, ...) tek bir grup altında topluyoruz
                if (/^[1][0-9][0-9]$/.test(officeNo)) {
                    // 100 serisi ofisler
                    if (!officeGroups['100']) {
                        officeGroups['100'] = [];
                    }
                    officeGroups['100'].push(office);
                } else {
                    // Diğer ofisler için normal gruplama
                    const officePrefix = officeNo.split('-')[0] || 'Diğer';
                    if (!officeGroups[officePrefix]) {
                        officeGroups[officePrefix] = [];
                    }
                    officeGroups[officePrefix].push(office);
                }
            });
            
            Object.keys(officeGroups).sort().forEach(prefix => {
                const groupHeader = document.createElement('div');
                groupHeader.style.fontWeight = 'bold';
                groupHeader.style.padding = '10px 5px';
                groupHeader.style.borderBottom = '1px solid #ddd';
                groupHeader.style.marginTop = '10px';
                
                // 100 serisi ofisler için özel başlık
                if (prefix === '100') {
                    groupHeader.textContent = '100 NUMARALI OFİSLER';
                } else {
                    groupHeader.textContent = prefix + (prefix.match(/[0-9]+[A-Z]+/) ? '' : ' Blok');
                }
                
                groupHeader.dataset.group = prefix;
                officeListEl.appendChild(groupHeader);
                
                officeGroups[prefix].sort((a, b) => {
                    const parts1 = a.office_no.toString().split('-');
                    const parts2 = b.office_no.toString().split('-');
                    
                    if (parts1.length > 1 && parts2.length > 1) {
                        const num1 = parseInt(parts1[1], 10) || 0;
                        const num2 = parseInt(parts2[1], 10) || 0;
                        return num1 - num2;
                    } else {
                        return a.office_no.localeCompare(b.office_no, undefined, {numeric: true});
                    }
                }).forEach(office => {
                    const officeItem = document.createElement('div');
                    officeItem.className = 'office-item';
                    officeItem.setAttribute('data-id', office.id);
                    officeItem.setAttribute('data-name', office.name.toLowerCase());
                    officeItem.setAttribute('data-office-no', office.office_no.toString().toLowerCase());
                    officeItem.setAttribute('data-group', prefix);
                    officeItem.textContent = office.office_no + ' - ' + office.name;
                    officeItem.onclick = function() {
                        selectOffice(office);
                    };
                    officeListEl.appendChild(officeItem);
                });
            });
        }

        function searchUserOffices(searchText) {
            const searchLower = searchText.toLowerCase();
            const officeItems = document.querySelectorAll('#officeList .office-item');
            const groupHeaders = document.querySelectorAll('#officeList [data-group]');
            
            groupHeaders.forEach(header => {
                header.style.display = 'none';
            });
            
            officeItems.forEach(item => {
                item.style.display = 'none';
            });
            
            let visibleGroups = new Set();
            
            officeItems.forEach(item => {
                const officeName = item.getAttribute('data-name');
                const officeNo = item.getAttribute('data-office-no');
                const group = item.getAttribute('data-group');
                
                if (officeName.includes(searchLower) || officeNo.includes(searchLower)) {
                    item.style.display = 'block';
                    visibleGroups.add(group);
                }
            });
            
            visibleGroups.forEach(group => {
                document.querySelector(`[data-group="${group}"]`).style.display = 'block';
            });
            
            if (!searchText) {
                groupHeaders.forEach(header => {
                    header.style.display = 'block';
                });
                
                officeItems.forEach(item => {
                    item.style.display = 'block';
                });
            }
        }

        // Ofis seçimi ve sayaç girişi
        function selectOffice(office) {
            document.querySelectorAll('.office-item').forEach(item => item.classList.remove('active'));
            document.querySelector(`.office-item[data-id="${office.id}"]`).classList.add('active');

            document.getElementById('officeName').textContent = office.office_no + ' - ' + office.name;
            document.getElementById('officeDetail').style.display = 'none';
            document.getElementById('meterForm').style.display = 'block';
            
            loadMeterValues(office.id);
            renderHistory(office.id);
        }

        function loadMeterValues(officeId) {
            const selectedOffice = offices.find(office => office.id === officeId);
            
            if (selectedOffice) {
                document.getElementById('electricMeterNo').value = selectedOffice.electric && selectedOffice.electric.meter_no || '';
                document.getElementById('waterMeterNo').value = selectedOffice.water && selectedOffice.water.meter_no || '';
                document.getElementById('electricMeter').value = selectedOffice.electric && selectedOffice.electric.last_reading || '';
                document.getElementById('waterMeter').value = selectedOffice.water && selectedOffice.water.last_reading || '';
                document.getElementById('gasMeter').value = '';
            }
        }

        function saveMeterValues(officeId) {
            const office = offices.find(o => o.id === officeId);
            
            if (!office) return;
            
            const electricValue = parseInt(document.getElementById('electricMeter').value, 10) || 0;
            const waterValue = parseInt(document.getElementById('waterMeter').value, 10) || 0;
            const gasValue = parseInt(document.getElementById('gasMeter').value, 10) || 0;
            
            const oldElectric = office.electric ? office.electric.last_reading : 0;
            const oldWater = office.water ? office.water.last_reading : 0;
            const oldGas = office.gas ? office.gas.last_reading : 0;
            
            if (!office.history) office.history = [];
            
            const history = {
                date: new Date(),
                user: currentUser.name,
                electric: oldElectric,
                water: oldWater,
                gas: oldGas,
                newElectric: electricValue,
                newWater: waterValue,
                newGas: gasValue
            };
            
            office.history.unshift(history);
            
            if (office.history.length > 10) {
                office.history = office.history.slice(0, 10);
            }
            
            if (office.electric) office.electric.last_reading = electricValue;
            if (office.water) office.water.last_reading = waterValue;
            if (!office.gas) office.gas = { meter_no: '', last_reading: 0 };
            office.gas.last_reading = gasValue;
            
            office.lastUpdatedBy = currentUser.name;
            office.lastUpdatedDate = new Date();
            
            renderHistory(officeId);
            renderStatusTable();
            
            const notification = document.getElementById('notification');
            notification.textContent = 'Sayaç değerleri başarıyla kaydedildi!';
            notification.style.display = 'block';
            notification.style.opacity = '1';
            
            setTimeout(function() {
                notification.style.opacity = '0';
                setTimeout(function() {
                    notification.style.display = 'none';
                }, 300);
            }, 5000);
            
            renderMeterTable();
        }

        function renderHistory(officeId) {
            const office = offices.find(o => o.id === officeId);
            if (!office || !office.history) {
                renderHistoryTable(null);
                return;
            }
            renderHistoryTable(office);
        }

        function renderHistoryTable(office) {
            const historyBodyEl = document.getElementById('historyBody');
            if (!historyBodyEl) return;
            
            historyBodyEl.innerHTML = '';
            
            if (!office || !office.history || office.history.length === 0) {
                const row = document.createElement('tr');
                row.innerHTML = `<td colspan="4">Henüz kayıt bulunmamaktadır.</td>`;
                historyBodyEl.appendChild(row);
                return;
            }
            
            office.history.forEach(record => {
                const row = document.createElement('tr');
                const date = new Date(record.date);
                const formattedDate = date.toLocaleDateString('tr-TR') + ' ' + date.toLocaleTimeString('tr-TR', { hour: '2-digit', minute: '2-digit' });
                
                row.innerHTML = `
                    <td>${formattedDate}</td>
                    <td>${record.newElectric || '-'}</td>
                    <td>${record.newWater || '-'}</td>
                    <td>${record.newGas || '-'}</td>
                `;
                historyBodyEl.appendChild(row);
            });
        }

        // Depo yönetimi işlemleri
        function renderInventoryTable() {
            const tableBody = document.getElementById('inventoryTableBody');
            if (!tableBody) return;
            
            tableBody.innerHTML = '';
            
            const depoFilter = document.getElementById('depoSelector').value;
            const searchText = document.getElementById('productSearch').value.toLowerCase();
            
            let filteredInventory = inventory;
            
            if (depoFilter !== 'all') {
                filteredInventory = filteredInventory.filter(item => item.depo_id === depoFilter);
            }
            
            if (searchText) {
                filteredInventory = filteredInventory.filter(item => 
                    item.name.toLowerCase().includes(searchText) || 
                    item.description.toLowerCase().includes(searchText)
                );
            }
            
            filteredInventory.forEach(item => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${item.name}</td>
                    <td>${item.quantity}</td>
                    <td>${item.unit}</td>
                    <td>${item.depo_id}</td>
                    <td>${item.description}</td>
                    <td>${item.lastUpdated} (${item.updatedBy})</td>
                    <td>
                        <button class="edit-product-btn" data-id="${item.id}">Düzenle</button>
                        <button class="view-movement-btn" data-id="${item.id}">Hareketler</button>
                    </td>
                `;
                tableBody.appendChild(row);
            });
        }

        function showAddProductModal() {
            document.getElementById('newProductName').value = '';
            document.getElementById('newProductQuantity').value = '';
            document.getElementById('newProductUnit').value = 'Adet';
            document.getElementById('newProductDepo').value = 'TEKNİK DEPO';
            document.getElementById('newProductDesc').value = '';
            document.getElementById('addProductModal').style.display = 'flex';
        }

        function saveNewProduct() {
            const name = document.getElementById('newProductName').value.trim();
            const quantity = parseInt(document.getElementById('newProductQuantity').value, 10) || 0;
            const unit = document.getElementById('newProductUnit').value;
            const depo = document.getElementById('newProductDepo').value;
            const description = document.getElementById('newProductDesc').value.trim();
            
            if (!name) {
                alert('Ürün adı gereklidir!');
                return;
            }
            
            if (quantity <= 0) {
                alert('Miktar pozitif bir sayı olmalıdır!');
                return;
            }
            
            const newId = inventory.length > 0 ? Math.max(...inventory.map(item => item.id)) + 1 : 1;
            
            const movement = {
                date: new Date().toISOString().slice(0, 10),
                user: currentUser.name,
                action: "Ekleme",
                oldQuantity: 0,
                change: quantity,
                newQuantity: quantity
            };
            
            const newProduct = {
                id: newId,
                name: name,
                quantity: quantity,
                unit: unit,
                depo_id: depo,
                description: description,
                lastUpdated: new Date().toISOString().slice(0, 10),
                updatedBy: currentUser.name,
                movements: [movement]
            };
            
            inventory.push(newProduct);
            renderInventoryTable();
            document.getElementById('addProductModal').style.display = 'none';
            
            alert('Yeni ürün başarıyla eklendi!');
        }

        function editProduct(productId) {
            const product = inventory.find(item => item.id == productId);
            if (!product) return;
            
            document.getElementById('editProductId').value = product.id;
            document.getElementById('editProductName').value = product.name;
            document.getElementById('editProductQuantity').value = product.quantity;
            document.getElementById('editProductUnit').value = product.unit;
            document.getElementById('editProductDepo').value = product.depo_id;
            document.getElementById('editProductDesc').value = product.description;
            
            document.getElementById('editProductModal').style.display = 'flex';
        }

        function updateProduct() {
            const id = document.getElementById('editProductId').value;
            const name = document.getElementById('editProductName').value.trim();
            const newQuantity = parseInt(document.getElementById('editProductQuantity').value, 10) || 0;
            const unit = document.getElementById('editProductUnit').value;
            const depo = document.getElementById('editProductDepo').value;
            const description = document.getElementById('editProductDesc').value.trim();
            
            if (!name) {
                alert('Ürün adı gereklidir!');
                return;
            }
            
            if (newQuantity < 0) {
                alert('Miktar negatif olamaz!');
                return;
            }
            
            const product = inventory.find(item => item.id == id);
            if (!product) return;
            
            const oldQuantity = product.quantity;
            
            if (oldQuantity !== newQuantity) {
                const movement = {
                    date: new Date().toISOString().slice(0, 10),
                    user: currentUser.name,
                    action: oldQuantity < newQuantity ? "Ekleme" : "Çıkarma",
                    oldQuantity: oldQuantity,
                    change: newQuantity - oldQuantity,
                    newQuantity: newQuantity
                };
                
                product.movements.unshift(movement);
            }
            
            product.name = name;
            product.quantity = newQuantity;
            product.unit = unit;
            product.depo_id = depo;
            product.description = description;
            product.lastUpdated = new Date().toISOString().slice(0, 10);
            product.updatedBy = currentUser.name;
            
            renderInventoryTable();
            document.getElementById('editProductModal').style.display = 'none';
            
            alert('Ürün başarıyla güncellendi!');
        }

        function viewStockMovements(productId) {
            const product = inventory.find(item => item.id == productId);
            if (!product) return;
            
            document.getElementById('movementProductName').textContent = ` - ${product.name}`;
            
            const tableBody = document.getElementById('movementTableBody');
            tableBody.innerHTML = '';
            
            if (product.movements.length === 0) {
                const row = document.createElement('tr');
                row.innerHTML = `<td colspan="6">Bu ürün için hareket kaydı bulunmamaktadır.</td>`;
                tableBody.appendChild(row);
            } else {
                product.movements.forEach(movement => {
                    const row = document.createElement('tr');
                    row.innerHTML = `
                        <td>${movement.date}</td>
                        <td>${movement.user}</td>
                        <td>${movement.action}</td>
                        <td>${movement.oldQuantity} ${product.unit}</td>
                        <td style="color: ${movement.change > 0 ? 'green' : 'red'}">${movement.change > 0 ? '+' : ''}${movement.change} ${product.unit}</td>
                        <td>${movement.newQuantity} ${product.unit}</td>
                    `;
                    tableBody.appendChild(row);
                });
            }
            
            document.getElementById('stockMovementModal').style.display = 'flex';
        }

        function showBulkUploadModal() {
            document.getElementById('bulkUploadFile').value = '';
            document.getElementById('uploadPreview').style.display = 'none';
            document.getElementById('previewTableBody').innerHTML = '';
            document.getElementById('previewCount').textContent = '0';
            document.getElementById('bulkUploadModal').style.display = 'flex';
        }

        function downloadTemplateFile() {
            const templateData = [
                ['Ürün Adı', 'Miktar', 'Birim', 'Depo', 'Açıklama'],
                ['Kablo', '100', 'Metre', 'TEKNİK DEPO', 'NYM 3x2.5'],
                ['Ampul', '50', 'Adet', 'TEKNİK DEPO', 'LED 10W'],
                ['Temizlik Malzemesi', '20', 'Litre', 'İŞLETME DEPO', 'Genel Temizlik']
            ];
            
            const ws = XLSX.utils.aoa_to_sheet(templateData);
            const wb = XLSX.utils.book_new();
            XLSX.utils.book_append_sheet(wb, ws, 'Ürünler');
            XLSX.writeFile(wb, 'Toplu_Urun_Yukleme_Sablonu.xlsx');
        }

        function previewBulkUpload() {
            const fileInput = document.getElementById('bulkUploadFile');
            const previewTable = document.getElementById('previewTableBody');
            const previewCount = document.getElementById('previewCount');
            const uploadPreview = document.getElementById('uploadPreview');
            
            if (!fileInput.files || !fileInput.files[0]) {
                uploadPreview.style.display = 'none';
                return;
            }
            
            const file = fileInput.files[0];
            const reader = new FileReader();
            
            reader.onload = function(e) {
                try {
                    const data = new Uint8Array(e.target.result);
                    const workbook = XLSX.read(data, { type: 'array' });
                    const firstSheet = workbook.Sheets[workbook.SheetNames[0]];
                    const jsonData = XLSX.utils.sheet_to_json(firstSheet, { header: 1 });
                    
                    if (jsonData.length < 2) {
                        alert('Dosya boş veya geçersiz format!');
                        return;
                    }
                    
                    const headers = jsonData[0].map(h => String(h).trim().toLowerCase());
                    const nameIndex = headers.findIndex(h => h.includes('ad') || h.includes('ürün'));
                    const quantityIndex = headers.findIndex(h => h.includes('miktar'));
                    const unitIndex = headers.findIndex(h => h.includes('birim'));
                    const depoIndex = headers.findIndex(h => h.includes('depo'));
                    
                    if (nameIndex === -1 || quantityIndex === -1) {
                        alert('Ürün Adı veya Miktar sütunları bulunamadı!');
                        return;
                    }
                    
                    previewTable.innerHTML = '';
                    let validProducts = 0;
                    
                    for (let i = 1; i < jsonData.length; i++) {
                        const row = jsonData[i];
                        
                        if (!row[nameIndex] || !row[quantityIndex]) continue;
                        
                        const name = String(row[nameIndex]).trim();
                        const quantity = parseInt(row[quantityIndex], 10);
                        
                        if (!name || isNaN(quantity) || quantity <= 0) continue;
                        
                        const unit = unitIndex !== -1 && row[unitIndex] ? String(row[unitIndex]).trim() : 'Adet';
                        const depo = depoIndex !== -1 && row[depoIndex] ? String(row[depoIndex]).trim() : 'TEKNİK DEPO';
                        
                        const previewRow = document.createElement('tr');
                        previewRow.innerHTML = `
                            <td>${name}</td>
                            <td>${quantity}</td>
                            <td>${unit}</td>
                            <td>${depo}</td>
                        `;
                        previewTable.appendChild(previewRow);
                        
                        validProducts++;
                    }
                    
                    previewCount.textContent = validProducts.toString();
                    
                    if (validProducts > 0) {
                        uploadPreview.style.display = 'block';
                    } else {
                        uploadPreview.style.display = 'none';
                        alert('Dosyada yüklenebilecek geçerli ürün bulunamadı!');
                    }
                    
                } catch (error) {
                    console.error('Dosya okuma hatası:', error);
                    alert('Dosya okunamadı veya geçersiz format!');
                    uploadPreview.style.display = 'none';
                }
            };
            
            reader.onerror = function() {
                alert('Dosya okunamadı!');
                uploadPreview.style.display = 'none';
            };
            
            reader.readAsArrayBuffer(file);
        }

        function processBulkUpload() {
            const fileInput = document.getElementById('bulkUploadFile');
            
            if (!fileInput.files || !fileInput.files[0]) {
                alert('Lütfen bir dosya seçin!');
                return;
            }
            
            const file = fileInput.files[0];
            const reader = new FileReader();
            
            reader.onload = function(e) {
                try {
                    const data = new Uint8Array(e.target.result);
                    const workbook = XLSX.read(data, { type: 'array' });
                    const firstSheet = workbook.Sheets[workbook.SheetNames[0]];
                    const jsonData = XLSX.utils.sheet_to_json(firstSheet, { header: 1 });
                    
                    if (jsonData.length < 2) {
                        alert('Dosya boş veya geçersiz format!');
                        return;
                    }
                    
                    const headers = jsonData[0].map(h => String(h).trim().toLowerCase());
                    const nameIndex = headers.findIndex(h => h.includes('ad') || h.includes('ürün'));
                    const quantityIndex = headers.findIndex(h => h.includes('miktar'));
                    const unitIndex = headers.findIndex(h => h.includes('birim'));
                    const depoIndex = headers.findIndex(h => h.includes('depo'));
                    const descIndex = headers.findIndex(h => h.includes('açıklama') || h.includes('aciklama'));
                    
                    if (nameIndex === -1 || quantityIndex === -1) {
                        alert('Ürün Adı veya Miktar sütunları bulunamadı!');
                        return;
                    }
                    
                    let addedCount = 0;
                    
                    for (let i = 1; i < jsonData.length; i++) {
                        const row = jsonData[i];
                        
                        if (!row[nameIndex] || !row[quantityIndex]) continue;
                        
                        const name = String(row[nameIndex]).trim();
                        const quantity = parseInt(row[quantityIndex], 10);
                        
                        if (!name || isNaN(quantity) || quantity <= 0) continue;
                        
                        const unit = unitIndex !== -1 && row[unitIndex] ? String(row[unitIndex]).trim() : 'Adet';
                        const depo = depoIndex !== -1 && row[depoIndex] ? String(row[depoIndex]).trim() : 'TEKNİK DEPO';
                        const description = descIndex !== -1 && row[descIndex] ? String(row[descIndex]).trim() : '';
                        
                        const newId = inventory.length > 0 ? Math.max(...inventory.map(item => item.id)) + 1 : 1;
                        
                        const movement = {
                            date: new Date().toISOString().slice(0, 10),
                            user: currentUser.name,
                            action: "Ekleme",
                            oldQuantity: 0,
                            change: quantity,
                            newQuantity: quantity
                        };
                        
                        const newProduct = {
                            id: newId + addedCount,
                            name: name,
                            quantity: quantity,
                            unit: unit,
                            depo_id: depo,
                            description: description,
                            lastUpdated: new Date().toISOString().slice(0, 10),
                            updatedBy: currentUser.name,
                            movements: [movement]
                        };
                        
                        inventory.push(newProduct);
                        addedCount++;
                    }
                    
                    renderInventoryTable();
                    alert(`Toplam ${addedCount} ürün başarıyla yüklendi!`);
                    document.getElementById('bulkUploadModal').style.display = 'none';
                    
                } catch (error) {
                    console.error('Dosya işleme hatası:', error);
                    alert('Dosya işlenemedi: ' + error.message);
                }
            };
            
            reader.onerror = function() {
                alert('Dosya okunamadı!');
            };
            
            reader.readAsArrayBuffer(file);
        }

        function exportInventoryToExcel() {
            const depoFilter = document.getElementById('depoSelector').value;
            const searchText = document.getElementById('productSearch').value.toLowerCase();
            
            let filteredInventory = inventory;
            
            if (depoFilter !== 'all') {
                filteredInventory = filteredInventory.filter(item => item.depo_id === depoFilter);
            }
            
            if (searchText) {
                filteredInventory = filteredInventory.filter(item => 
                    item.name.toLowerCase().includes(searchText) || 
                    item.description.toLowerCase().includes(searchText)
                );
            }
            
            if (filteredInventory.length === 0) {
                alert('Aktarilacak kayıt bulunamadı!');
                return;
            }
            
            const data = [];
            data.push(['Ürün Adı', 'Miktar', 'Birim', 'Depo', 'Açıklama', 'Son Güncelleme']);
            
            filteredInventory.forEach(item => {
                data.push([
                    item.name,
                    item.quantity,
                    item.unit,
                    item.depo_id,
                    item.description,
                    `${item.lastUpdated} (${item.updatedBy})`
                ]);
            });
            
            const ws = XLSX.utils.aoa_to_sheet(data);
            const wb = XLSX.utils.book_new();
            XLSX.utils.book_append_sheet(wb, ws, 'Envanter');
            XLSX.writeFile(wb, 'Envanter_' + new Date().toISOString().slice(0, 10) + '.xlsx');
            
            alert('Envanter verileri Excel dosyasına aktarıldı!');
        }

        // Event Listeners
        document.addEventListener('DOMContentLoaded', function() {
            // Veri başlatma
            initializeUsers();
            initializeOffices();
            initializeInventory();

            // Ana sayfa navigasyon
            document.getElementById('homeLink').addEventListener('click', showHeroSection);
            document.getElementById('aboutLink').addEventListener('click', showAboutSection);
            document.getElementById('contactLink').addEventListener('click', showContactSection);
            document.getElementById('backToHomeBtn').addEventListener('click', showHeroSection);
            document.getElementById('backFromContactBtn').addEventListener('click', showHeroSection);

            // Giriş işlemleri
            document.getElementById('heroLoginBtn').addEventListener('click', openLoginModal);
            document.getElementById('submitLoginBtn').addEventListener('click', handleLogin);
            document.getElementById('closeLoginBtn').addEventListener('click', closeLoginModal);
            document.getElementById('password').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    handleLogin();
                }
            });

            // Çıkış işlemleri
            document.getElementById('logoutButton').addEventListener('click', handleLogout);
            document.getElementById('adminLogoutButton').addEventListener('click', handleLogout);

            // Admin panel navigasyon
            document.querySelectorAll('[data-panel]').forEach(tab => {
                tab.addEventListener('click', function() {
                    const panelId = this.getAttribute('data-panel');
                    showAdminPanel(panelId);
                });
            });

            document.getElementById('dashboardLink').addEventListener('click', function() {
                if (currentUser.role === 'teknik') {
                    document.getElementById('appScreen').style.display = 'block';
                    document.getElementById('adminPanel').style.display = 'none';
                    renderOfficeList();
                }
            });

            document.getElementById('adminLink').addEventListener('click', function() {
                if (currentUser.role === 'admin') {
                    document.getElementById('appScreen').style.display = 'none';
                    document.getElementById('adminPanel').style.display = 'block';
                    showAdminPanel('userPanel');
                } else if (currentUser.role === 'depo') {
                    document.getElementById('appScreen').style.display = 'none';
                    document.getElementById('adminPanel').style.display = 'block';
                    showAdminPanel('depoPanel');
                }
            });

            // Kullanıcı yönetimi
            document.getElementById('addUserBtn').addEventListener('click', showUserModal);
            document.getElementById('saveUserBtn').addEventListener('click', saveNewUser);
            document.getElementById('cancelUserBtn').addEventListener('click', hideUserModal);
            
            // Kullanıcı düzenleme modalları için
            document.getElementById('updateUserBtn').addEventListener('click', updateUser);
            document.getElementById('cancelEditUserBtn').addEventListener('click', hideEditUserModal);
            
            // Kullanıcı tablosu event listener'ları
            document.getElementById('userTableBody').addEventListener('click', function(e) {
                if (e.target.classList.contains('edit-btn')) {
                    const username = e.target.getAttribute('data-username');
                    editUser(username);
                } else if (e.target.classList.contains('delete-btn')) {
                    const username = e.target.getAttribute('data-username');
                    deleteUser(username);
                }
            });

            // Ofis yönetimi
            document.getElementById('adminOfficeSearch').addEventListener('input', function() {
                searchAdminOffices(this.value.trim());
            });
            document.getElementById('cancelOfficeEditBtn').addEventListener('click', hideOfficeEditForm);
            document.getElementById('saveOfficeBtn').addEventListener('click', function() {
                const officeId = this.getAttribute('data-id');
                saveOfficeChanges(officeId);
            });

            // Sayaç yönetimi
            document.getElementById('adminMeterSearch').addEventListener('input', function() {
                searchAdminMeters(this.value.trim());
            });
            document.getElementById('saveMeterBtn').addEventListener('click', function() {
                const officeId = this.getAttribute('data-id');
                const meterType = this.getAttribute('data-type');
                saveMeterChanges(officeId, meterType);
            });
            document.getElementById('cancelMeterBtn').addEventListener('click', hideMeterEditModal);

            // Ofis veri durumu
            document.getElementById('statusOfficeSearch').addEventListener('input', function() {
                searchStatusOffices(this.value.trim());
            });

            // Raporlar
            document.getElementById('exportAllToExcel').addEventListener('click', function() {
                exportAllOfficesToExcel();
            });

            // Teknik personel - ofis arama ve sayaç kaydetme
            document.getElementById('userOfficeSearch').addEventListener('input', function() {
                searchUserOffices(this.value.trim());
            });
            document.getElementById('saveButton').addEventListener('click', function() {
                const activeOfficeItem = document.querySelector('.office-item.active');
                if (activeOfficeItem) {
                    const officeId = activeOfficeItem.getAttribute('data-id');
                    saveMeterValues(officeId);
                }
            });

            // Depo yönetimi
            document.getElementById('addProductBtn').addEventListener('click', showAddProductModal);
            document.getElementById('saveProductBtn').addEventListener('click', saveNewProduct);
            document.getElementById('cancelProductBtn').addEventListener('click', function() {
                document.getElementById('addProductModal').style.display = 'none';
            });

            document.getElementById('updateProductBtn').addEventListener('click', updateProduct);
            document.getElementById('cancelEditBtn').addEventListener('click', function() {
                document.getElementById('editProductModal').style.display = 'none';
            });

            document.getElementById('closeMovementBtn').addEventListener('click', function() {
                document.getElementById('stockMovementModal').style.display = 'none';
            });

            document.getElementById('bulkUploadBtn').addEventListener('click', showBulkUploadModal);
            document.getElementById('downloadTemplateBtn').addEventListener('click', function(e) {
                e.preventDefault();
                downloadTemplateFile();
            });
            document.getElementById('bulkUploadFile').addEventListener('change', previewBulkUpload);
            document.getElementById('processBulkUploadBtn').addEventListener('click', processBulkUpload);
            document.getElementById('cancelBulkUploadBtn').addEventListener('click', function() {
                document.getElementById('bulkUploadModal').style.display = 'none';
            });

            document.getElementById('depoSelector').addEventListener('change', renderInventoryTable);
            document.getElementById('productSearch').addEventListener('input', renderInventoryTable);
            document.getElementById('exportInventoryBtn').addEventListener('click', exportInventoryToExcel);

            // Dinamik buton event listeners
            document.addEventListener('click', function(e) {
                if (e.target.classList.contains('edit-btn')) {
                    const username = e.target.getAttribute('data-username');
                    editUser(username);
                } else if (e.target.classList.contains('delete-btn')) {
                    const username = e.target.getAttribute('data-username');
                    deleteUser(username);
                } else if (e.target.classList.contains('edit-office-btn')) {
                    const officeId = e.target.getAttribute('data-id');
                    editOffice(officeId);
                } else if (e.target.classList.contains('edit-meter-btn')) {
                    const officeId = e.target.getAttribute('data-id');
                    const meterType = e.target.getAttribute('data-type');
                    showMeterEditModal(officeId, meterType);
                } else if (e.target.classList.contains('edit-product-btn')) {
                    const productId = e.target.getAttribute('data-id');
                    editProduct(productId);
                } else if (e.target.classList.contains('view-movement-btn')) {
                    const productId = e.target.getAttribute('data-id');
                    viewStockMovements(productId);
                }
            });

            // Modal dışına tıklama kontrolü
            window.addEventListener('click', function(e) {
                if (e.target.classList.contains('login-modal')) {
                    if (e.target.id === 'loginModal') {
                        closeLoginModal();
                    } else if (e.target.id === 'addUserModal') {
                        hideUserModal();
                    } else if (e.target.id === 'editMeterModal') {
                        hideMeterEditModal();
                    } else if (e.target.id === 'addProductModal') {
                        document.getElementById('addProductModal').style.display = 'none';
                    } else if (e.target.id === 'editProductModal') {
                        document.getElementById('editProductModal').style.display = 'none';
                    } else if (e.target.id === 'stockMovementModal') {
                        document.getElementById('stockMovementModal').style.display = 'none';
                    } else if (e.target.id === 'bulkUploadModal') {
                        document.getElementById('bulkUploadModal').style.display = 'none';
                    }
                }
            });
        });
    </script>
</body>
</html>
